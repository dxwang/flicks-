!function(){var e={};e.cadmium=e.cadmium||{},e.cadmium.ui=e.cadmium.ui||{},e.cadmium.ui.mdx=e.cadmium.ui.mdx||{},window.netflix=window.netflix||{},window.netflix.cadmium=window.netflix.cadmium||{},window.netflix.cadmium.ui={},e.clientNotifications=window.netflix.clientNotifications,e.session=window.netflix.session,e.constants=window.netflix.constants,e.mdx=e.mdx||{},e.mdx.ui=e.mdx.ui||{},e.mdx.EVENTS=Object.freeze({mdx_init:"init",mdx_initerror:"initerror",mdx_state:"mdxstate",READY:"READY",NOT_READY:"NOT_READY",sessionstartresponse:"startSessionResponse",sessionended:"sessionended",messagedelivered:"messagedelivered",messagingerror:"messagingerror",pairingdeleted:"pairingdeleted",pairingresponse:"pairingresponse",regpairresponse:"regpairresponse",devicefound:"devicefound",devicelost:"devicelost",remoteDeviceReady:"remoteDeviceReady",pairingtimeout:"pairingtimeout",sessiontimeout:"sessiontimeout",heartbeat:"heartbeat"}),e.mdx.bootstrap=function(){function t(){u=!0;var e=document.documentElement,t=document.createElement("script");t.src=window.netflix.constants.page.merchMdxJs;var i=a.fromEvent(t,"load");i.take(1).doAction(l,l,n).subscribe(l,l),e.appendChild(t)}function n(){c=!0,i()}function i(){function t(){d||r.init(function(t){t.success?(e.player=window.netflix.player,e.player.nccp=t.nccp,e.player.mdx=t.mdx,window.netflix.initMdx(e),e.mdx.Manager.INSTANCE.start(),d=!0):s.log("init error",t.error)})}var n=e.cadmium,o=n.objects.videoPlayer(),r=n.objects.videoSession(),s=n.logging,a=n.UiEvents,l=n.objects;if(null!=o)l.videoPlayerLoaded()?t():o.addEventListener("loaded",function(){t()});else{var u=function(){i()};a.addEventListener(a.knownEvents.NEW_PLAYER_CREATED,u)}}function o(){if(chrome.cast&&chrome.cast.isAvailable)u||t();else{window.__onGCastApiAvailable=function(e,n){u||(e?t():console.log(n))};var e=document.getElementsByTagName("script")[0],n=document.createElement("script");n.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js",e.parentNode.insertBefore(n,e)}}function r(e){"complete"===document.readyState&&(clearTimeout(m),document.removeEventListener("readystatechange",r),o())}function s(){d=!1}var a=Rx.Observable,l=function(){},u=!1,c=!1,d=!1;if(navigator.userAgent.toLowerCase().indexOf("chrome")>=0&&navigator.userAgent.indexOf("Edge/")<0){var m=setTimeout(function(){document.removeEventListener("readystatechange",r),o()},1e3);document.addEventListener("readystatechange",r)}return{readyToInit:function(){return c&&u},tryInitMdx:i,deinitMdx:s}}(),e.cadmium.util=function(){function e(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function t(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function i(e,t,n){e=e||{},t=t||{},n=n||{};for(var i in e)!n.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function o(e,t,n){try{return e.apply(t,n)}catch(i){return i}}return{isEmptyObject:e,isArray:t,isObject:n,mix:i,NOOP:function(){},tryCatch:o}}(),function(){"use strict";var t=e.cadmium.util.NOOP;Rx.Observable.fromEvent||(Rx.Observable.fromEvent=function(e,t){return Rx.Observable.create(function(n){function i(){n.onNext.apply(n,arguments)}return e.addEventListener(t,i),function(){e.removeEventListener(t,i)}})}),Rx.Observable.prototype.filter||(Rx.Observable.prototype.filter=Rx.Observable.prototype.where),Rx.Observable.prototype.map||(Rx.Observable.prototype.map=function(e,t){return Rx.Observable.prototype.select.call(t||this,e)}),Rx.Observable["throw"]||(Rx.Observable["throw"]=Rx.Observable.throwException),Rx.Observable.flatMap||(Rx.Observable.prototype.flatMap=Rx.Observable.prototype.selectMany),Rx.Observable["return"]||(Rx.Observable["return"]=Rx.Observable.returnValue),Rx.Observable.wrap||(Rx.Observable.wrap=function(e){return 0===arguments.length?Rx.Observable.empty():e instanceof Rx.Observable?e:e instanceof Error?Rx.Observable["throw"](e):Rx.Observable.create(function(n){return n.onNext(e),n.onCompleted(),t})}),Rx.Observable["catch"]||(Rx.Observable["catch"]=Rx.Observable.catchException),Rx.Observable.prototype["catch"]||(Rx.Observable.prototype["catch"]=Rx.Observable.prototype.catchException),Rx.Observable.prototype.share||(Rx.Observable.prototype.share=function(){return this.publish().refCount()}),Rx.Observable.prototype.shareValue||(Rx.Observable.prototype.shareValue=function(e){return this.publishValue(e).refCount()}),Rx.Observable.prototype.shareReplay||(Rx.Observable.prototype.shareReplay=function(e,t,n){return this.replay(null,e,t,n).refCount()}),Rx.Observable.prototype.retryWithBackoff=function(e,t){e=e||5,t=t||1e3;var n=this,i=t,o=1,r=Rx.Observable.defer(function(){return Rx.Observable.timer(i).flatMap(function(){return i=Math.pow(2,o++)*t,n})});return this["catch"](r.retry(e))}}(),e.cadmium.animate=function(){"use strict";function e(e){"opacity"==e.propertyName&&window.getComputedStyle(e.target).opacity<.1&&e.currentTarget.classList.add(i)}function t(t){t.removeEventListener(r,e,!1),t.addEventListener(r,e,!1),t.classList.add(o)}function n(t){t.removeEventListener(r,e,!1),t.classList.remove(i),requestAnimationFrame(function(){t.classList.remove(o)})}var i="display-none",o="opacity-transparent",r="transitionend";return{fadeIn:n,fadeOut:t}}(),function(){var t=!1,n=/\b_super\b/,i=function(e,t){return function(){var n,i=this._super;return this._super=t,n=e.apply(this,arguments),this._super=i,n}};e.cadmium.Class=function(){},e.cadmium.Class.extend=function(e){var o,r,s,a,l,u,c,d=this.prototype,m=n,p=i;t=!0,o=new this,t=!1;for(r in e)if(e.hasOwnProperty(r)){if(s=e.__lookupGetter__(r),a=e.__lookupSetter__(r),s||a){s&&o.__defineGetter__(r,s),a&&o.__defineSetter__(r,a);continue}l=e[r],o[r]="function"==typeof l&&"function"==typeof(u=d[r])&&m.test(l)?p(l,u):l}return c=function(){!t&&this.init&&this.init.apply(this,arguments)},c.prototype=o,c.constructor=c,c.extend=arguments.callee,c}}(),e.cadmium.browser=function(){function e(){var e=n.lowercase;if("ms"===e){var t=window.innerHeight===screen.height,i=!1,o="#metroForce"===window.location.hash;try{i=!!new ActiveXObject("htmlfile")}catch(r){}return t&&!i||o}return!1}var t=!1,n=function(){var e=window.getComputedStyle(document.documentElement,""),t=Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)[1],n="WebKit|Moz|MS|O".match(new RegExp("("+t+")","i"))[1];return{dom:n,lowercase:t,css:"-"+t+"-",js:t[0].toUpperCase()+t.substr(1)}}(),i=Object.freeze({pen:"pen",mouse:"mouse",touch:"touch"});return function(){var e="data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==",n=new Image;n.onload=function(e){t="load"===e.type&&1===n.width},n.onerror=function(e){t=!1},n.src=e}(),{prefix:function(){return n},pointerTypes:i,isMetroMode:e,supportsWebP:function(){return t}}}(),e.cadmium.customerEvents=function(){var t="/LogCustomerEvent",n=function(e,t){if(!e)return"";var n=0,i=[];for(var o in e)e.hasOwnProperty(o)&&(0!==n&&i.append(t),i.append(encodeURIComponent(o)),i.append("="),i.append(encodeURIComponent(e[o])),n++);return i.join("")},i=function(i,o,r,s){var a={legacy:!1,authURL:e.cadmium.objects.initParams().xsrfToken};"number"==typeof i?a.eventId=i:"string"==typeof i&&(a.custEventDef=i),o&&(a.eventData=n(o,",")),r&&(a.trackId=r);var l=new XMLHttpRequest;l.onreadystatechange=function(){4===l.readyState&&"200"===l.status&&s&&s(l.response)},l.open("GET",t+"?"+n(a,"&"),!0),l.send()};return{send:i}}(),Function.prototype.debounce=function(e,t){var n,i=this;return function(){function o(){t||i.apply(r,s),n=null}var r=this,s=arguments;n?clearTimeout(n):t&&i.apply(r,s),n=setTimeout(o,e||100)}},e.cadmium.dom=function(){"use strict";for(var e=["DIV","P","LI","UL","SPAN","IMG","H1","H2","H3","SECTION","A","BUTTON","INPUT"],t={},n=function(e,t){if(void 0!==t&&null!==t)if(t.nodeType)e.appendChild(t);else if("string"==typeof t||"number"==typeof t){var i=document.createTextNode(t);e.appendChild(i)}else if(t.constructor===Array)for(var o=0;o<t.length;o++)n(e,t[o]);else for(var r in t)t.hasOwnProperty(r)&&e.setAttribute(r,t[r])},i=function(e){return function(){for(var t=arguments.length,i=document.createElement(e),o=0;t>o;o++){var r=arguments[o];n(i,r)}return i}},o=0;o<e.length;o++)t[e[o]]=i(e[o]);return t.get=i,t}(),e.cadmium.element=function(){"use strict";function e(){return null!==d?d:(d=t("img"),d.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d)}function t(e,t,n){var i=document.createElement(e);return t&&(t.id&&(i.id=t.id),t["class"]&&(i.className=t["class"])),n&&n.appendChild(i),i}function n(e){var t=function(e){var t=window.getComputedStyle(e);return"visible"===t.visibility&&parseInt(t.opacity)>=1},n=t(e);if(!n)return!1;for(;e=e.offsetParent;)if(!t(e)){n=!1;break}return n}function i(e){var t=e.getBoundingClientRect();return{x:t.left,y:t.top,w:t.width,h:t.height}}function o(e){function t(e){e&&e.parentNode&&e.parentNode.removeChild(e)}if(e&&e.length>0)for(var n=e.length,i=0;n>i;++i)t(e[i]);else e&&t(e)}function r(e,t){return[t.x-e.x,t.y-e.y]}function s(e,t,n,i){return l(n,i,r(t,e))}function a(e,t,n,i){return l(r(t,i),r(t,n),r(t,e))}function l(e,t,n){function i(e,t){return e[0]*t[0]+e[1]*t[1]}var o=i(e,e),r=i(e,t),s=i(e,n),a=i(t,t),l=i(t,n),u=1/(o*a-r*r),c=(a*s-r*l)*u,d=(o*l-r*s)*u;return c>=0&&d>=0&&1>c+d}function u(e,t){var n;if(!(e.w/e.h>4/3))return"0";var i=e.w-4*e.h/3,o=e.h/t;return n="-"+i/2/o+"em"}function c(e,t){function n(t){return parseInt(getComputedStyle(e).getPropertyValue(t),10)}if(t=t||{},e instanceof Element){var i=n("line-height")||n("font-size"),o=t.maxLines,r=i*o,s=e.getBoundingClientRect().height;if(!(isNaN(s)||isNaN(r)||r>=s)){var a=e.textContent.replace(/\s{2,}/g," ").split(" "),l=a.length;t.isClamped?a.splice(l-2,1):(a.pop(),a.push("&hellip;"),t.isClamped=!0),e.innerHTML=a.join(" "),c(e,t)}}}var d=null;return{getTransparentImage:e,create:t,getDimensions:i,intendsToBeVisible:n,remove:o,vector:r,isPointInCachedTriangle:s,isPointInTriangle:a,calcScaledScreenOffset:u,limitLinesOfText:c,classNames:Object.freeze({visible:"player-visible",active:"player-active",hidden:"player-hidden",animate:"player-animate"})}}(),function(){var t=e.cadmium;t.Eventable=t.Class.extend({init:function(){this.events={}},addEventListener:function(e,t,n){var i={handler:t,scope:n};this.events.hasOwnProperty(e)?this.events[e].push(i):this.events[e]=[i]},removeEventListener:function(e,t,n){if(this.events.hasOwnProperty(e))for(var i=0;i<this.events[e].length;i++){var o=this.events[e][i];if(o.handler==t&&o.scope==n)return void this.events[e].splice(i,1)}},fireEvent:function(e,t){if(this.events.hasOwnProperty(e)){t&&t.length||(t=[]);for(var n=this.events[e].slice(0),i=n.length,o=0;i>o;o++)n[o].handler&&n[o].handler.apply(n[o].scope,t)}}})}(),e.cadmium.logging=function(){"use strict";function t(t,n){n=Array.prototype.slice.call(n);var i=window.netflix.player&&window.netflix.player.log,o=e.cadmium.objects;i&&o&&o.videoSession()&&i[t].apply(i,n)}var n=/logging=true/.test(window.location.search),i="trace",o="info",r="error";return{log:function(){n&&window.console&&console.log.apply(console,arguments),t(i,arguments)},info:function(){n&&window.console&&console.info.apply(console,arguments),t(o,arguments)},error:function(){n&&window.console&&console.error.apply(console,arguments),t(r,arguments)},uilog:function(){n&&window.console&&console.log.apply(console,arguments),t(i,arguments)},onErrorLogger:function(){var e,i;arguments.length>1?(i=arguments[0],e=arguments[1],i=i+"\n"+(e&&e.stack||e)):(e=arguments[0],i=e&&e.stack||e),n&&console.error(e),t(r,i)}}}(),e.cadmium.time=function(){function t(t,n,o,r){var s=i(t),a=function(e){return n&&10>e?"0"+e:e},l=function(t){return e.I18n.getWithParams(t,["H","M","S"],[s.h,a(s.m),a(s.s)])};return l(s.h>0?s.m>0?s.s>0&&!o?r+"-hours-minutes-seconds":r+"-hours-minutes":s.s&&!o>0?r+"-hours-seconds":r+"-hours":s.m>0?s.s>0&&!o?r+"-minutes-seconds":r+"-minutes":r+"-seconds")}function n(e){var t="",n=i(e);return n.h>0&&(t=n.h+":",n.m<10&&(t+="0")),t+=n.m+":",t+(n.s>=10?n.s:"0"+n.s)}function i(e){var t=parseInt(e),n=0,i=0;return t>3600&&(n=parseInt(t/3600),t%=3600),t>60&&(i=parseInt(t/60),t%=60),{h:n,m:i,s:t}}function o(e,t){return t=t||10,Math.max(0,(e/t>>0)*t)}return{convert:n,convertUsingKey:t,getFloored:o}}(),e.cadmium.url=function(){function t(){var e,i;e=location.search.substr(1),i=e.indexOf("#"),i>=0&&(e=e.substr(0,i));var o=n(e);return t=function(){return o},o}function n(e){for(var t,n=/[+]/g,i=(e||"").split("&"),o={},r=0;r<i.length;r++)e=w(i[r]),t=e.indexOf("="),t>=0?o[decodeURIComponent(e.substr(0,t).replace(n,"%20")).toLowerCase()]=decodeURIComponent(e.substr(t+1).replace(n,"%20")):o[e.toLowerCase()]=null;return o}function i(e){return e instanceof RegExp?e.test(window.location.search):!1}function o(t,n,i){if(n=parseInt(n,10),e.cadmium.ui.master.isAkira()){var o=n+(i?"?trackId="+i:""),r={};r[t]=n,r.trackId=r.trackingId=i,history.replaceState(r,"",o)}else{var s=t===u.EPISODE_ID?g:f;s(n),i&&m(u.TRACK_ID,i)}}function r(){var e=window.history.state||{};if(e.videoId||e.episodeId)return e;var t=+h(u.EPISODE_ID),n=+h(u.VIDEO_ID),i=+h(u.TRACK_ID)||0;return(t||n)&&(e={},e[t?"episodeId":"videoId"]=t||n,e.trackId=e.trackingId=i),e}function s(){if(!l){var t;t=e&&e.cadmium&&e.cadmium.objects&&e.cadmium.objects.initParams()&&e.cadmium.objects.initParams().apiUrl?e.cadmium.objects.initParams().apiUrl.replace("http://","https://"):"https://"+location.hostname+"/api",l=t}return l}var a,l,u=Object.freeze({EPISODE_ID:"episodeId",VIDEO_ID:"videoId",COMMENTARY_PREFERRED:"commentaryPreferred",TRACK_ID:"trackId",BOOKMARK:"t"}),c={},d=function(){var e=window.location.hash;return e.length>0&&"#"===e[0]&&(e=e.substring(1)),e},m=function(e,t){var n=d();n!==a&&v(),c[e]=t,E()},p=function(e){delete c[e],E()},h=function(e){var t=d();return t!==a&&(a=t,v()),c[e]},v=function(){c={};var e=d();if(e.length>0)for(var t=e.split("&"),n=0;n<t.length;n++){var i=t[n].split("=");c[i[0]]=i[1]}},E=function(){var e="";for(var t in c)c.hasOwnProperty(t)&&(e=e+t+"="+c[t]+"&");e.length>0&&(e=e.substring(0,e.length-1)),(a||e)&&(a=e,window.location.hash=e)},f=function(e){_(),m(u.VIDEO_ID,e)},g=function(e){_(),m(u.EPISODE_ID,e)},_=function(){p(u.EPISODE_ID),p(u.VIDEO_ID),p(u.BOOKMARK)},b=function(e,t){e+="?";for(var n in t)t.hasOwnProperty(n)&&(e+=n+"="+t[n]+"&");return e.substr(0,e.length-1)},y=function(e){var t=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,n=t.exec(e);return n[1]+":"+n[2]+n[3]},w=function(){var e=/^\s+|\s+$/gm;return function(t){return t.replace(e,"")}}();return{setNextVideo:o,getNextVideo:r,addHash:m,getHash:h,addVideoIDHash:f,addEpisodeIDHash:g,removeHash:p,constructUrl:b,getOriginFromUrl:y,getQueryString:t,urlContains:i,CONSTANTS:u,getSecureApiPath:s}}(),e.cadmium.xhr=function(){"use strict";function t(e){return e=e||{},Rx.Observable.create(function(t){function i(){t.onNext(s),t.onCompleted()}function o(){t.onError(s)}var s=new XMLHttpRequest,a=e.url,l=e.method,u=e.headers,c=e.data||null;s.onload=function(){var e=s.status;e&&e>=200&&300>e?i():o()},s.onerror=o,s.open(l,a,!0),r(e,s),n(s,u);try{s.send(c)}catch(d){t.onError(d)}return function(){s&&4!==s.readyState&&s.abort()}})}function n(e,t){if(!e||!t)return e;for(var n in t)e.setRequestHeader(n,t[n]);return e}function i(e){function t(e,t){r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}var n,i,r=[];if(l.isObject(e))for(n in e)e.hasOwnProperty(n)&&o(n,e[n],t);else for(n in e)e.hasOwnProperty(n)&&t(n,e[n]);return i=0===r.length?"":r.join("&").replace(/%20/g,"+")}function o(e,t,n){var i=/\[\]$/;if(l.isArray(t))t.forEach(function(t,r){i.test(e)?n(e,r):o(e+"["+(l.isObject(r)||l.isArray(r)?t:"")+"]",r,n)});else if(l.isObject(t))for(var r in t)t.hasOwnProperty(r)&&o(e+"["+r+"]",t[r],n);else n(e,t)}function r(e,t){e=e||{},t=t||{};var n,i=function(e){return"requestType"===e||"withCredentials"===e};for(n in e)e.hasOwnProperty(n)&&i(n)&&(t[n]=e[n]);return t}function s(n,o){o=o||{},e.constants&&e.constants.page&&e.constants.page.xsrf&&o.data&&(o.data.authURL=e.constants.page.xsrf);var r=i(o.data),s={method:"GET",responseType:"json"};return r?s.url=n+"?"+r:s.url=n,l.mix(o,s,{data:!0}),t(s).map(function(e){var t=e.response;return"string"==typeof t&&(t=JSON.parse(t)),t})}function a(e,n){n=n||{};var o={url:e,method:"POST",requestType:"json"};return l.mix(n,o,{data:!0}),n.data&&(o.headers=o.headers||{},window.netflix.contextData&&window.netflix.contextData.userInfo&&window.netflix.contextData.userInfo.data&&window.netflix.contextData.userInfo.data.authURL&&(n.data.authURL=window.netflix.contextData.userInfo.data.authURL),n.urlEncoded?(o.headers["Content-Type"]="application/x-www-form-urlencoded",o.data=i(n.data)):(o.headers["Content-Type"]="application/json",o.data=JSON.stringify(n.data))),t(o).map(function(e){var t=e.response;return"string"==typeof t&&t&&(t=JSON.parse(t)),t})}var l=e.cadmium.util;return{get:s,post:a}}(),e.cadmium.popup=function(){function t(e){return e=e||{},!l||l.closed||e.url!==u?i(e):l.focus(),h}function n(){p&&p.onNext(),l&&l.close(),l=null,u=null,c=null,d=null,m=null,p=null,h=null}function i(e){n(),u=e.url,c=e.name,d=o(e.features),p=new Rx.Subject;var t=r(d);l=window.open(u,c,t),m=E.getOriginFromUrl(u),s()}function o(e){var t=e.width||300,n=e.height||200,i={width:t,height:n},o={};if(e.centered){var r=document.body.getBoundingClientRect(),s=r.width,a=r.height;i.top=a/2-n/2+screenTop,i.left=s/2-t/2+screenLeft}return v.mix(e,o,{centered:!0}),v.mix(i,o)}function r(e){var t,n="";for(var i in e)e.hasOwnProperty(i)&&(t=e[i],t===!0?t="yes":t===!1?t="no":t+="",n+=(n.length?",":"")+i+"="+t);return n}function s(){l&&!l.closed&&(h=Rx.Observable.fromEvent(window,"message").takeUntil(p).filter(a))}function a(e){return e&&e.origin===m}var l,u,c,d,m,p,h,v=e.cadmium.util,E=e.cadmium.url;return{open:t,close:n}}(),function(){"use strict";function t(){for(var e,t="",n=[],i=0;i<arguments.length;i++){e=arguments[i];{if("string"!=typeof e){n=[t,e];break}t&&(t+=": "),t+=e}}return n.length?n:[t]}var n=e.cadmium,i=n.logging,o=n.Class,r=o.extend({init:function(e){this._namespace=e},log:function(){this._logit("log",arguments)},error:function(){this._logit("error",arguments)},info:function(){this._logit("info",arguments)},getErrorHandler:function(e){var n=this;return function(i){n.error.apply(n,t(n._namespace,e,i&&i.stack||i))}},_logit:function(e,n){Array.prototype.unshift.call(n,this._namespace),i[e].apply(i,t.apply(null,n)),"error"===e&&console.error.apply(console,n)}});r.create=function(e){return new r(e)},n.Logger=r}(),function(){"use strict";function t(){return l().getActiveVideo&&l().getActiveVideo()||{}}function n(){var e=a().initParams&&a().initParams();return!(!e||!e.enableTrickPlay)}function i(e){return n()?o(e):r(e)}function o(e){var t=a().videoPlayer&&a().videoPlayer(),n=t&&t.getTrickPlayFrame(e),i=n&&n.image;if(i)try{return URL.createObjectURL(new Blob([i],{type:"image/jpeg"}))}catch(o){return u.log(o&&o.stack||o),null}return null}function r(e){var n,i=e/1e3,o=t().progressImageRoot,r=null;return o&&(n=i/10,r=o+c.substring((n+"").length)+n+".jpg"),r}function s(e,t,o){var r=i(t);r&&e?(e.src=r,n()?e.onload=function(){window.URL.revokeObjectURL(this.src),o&&o(!0)}:o&&o(!0)):o&&o(!1)}function a(){return e.cadmium&&e.cadmium.objects||{}}function l(){return e.cadmium&&e.cadmium.metadata||{}}var u=e.cadmium.Logger.create("trickplay"),c="00000";e.cadmium.trickplay={getImageUrlAtTime:i,setImageTagSourceAtTime:s}}(),function(){"use strict";var t=e.cadmium;t.mixins={mixin:function(e,t,n){(n||Object.keys(t)).forEach(function(n){e[n]=t[n]})},ui:{}}}(),e.cadmium.MutationUtils=function(){"use strict";function e(e,t){return window.MutationObserver?Rx.Observable.create(function(n){var i;return i=new window.MutationObserver(function(e){n.onNext(e)}),i.observe(e,t),function(){i.disconnect()}}):Rx.Observable.empty()}function t(t,n){return t&&n?e(t,{childList:!0,subtree:!1}).flatMap(function(e){return Rx.Observable.fromArray(e)}).filter(function(e){return e.addedNodes&&e.addedNodes.length}).flatMap(function(e){return Rx.Observable.fromArray([].slice.call(e.addedNodes))}).filter(function(e){return n.some(function(t){return e!==t})}).doAction(function(e){e&&e.remove()}):Rx.Observable["throw"]("Must provide a target element and whitelist.")}return{createMutationObserver:e,observeAndRemoveUnsafeNodes:t}}(),function(){"use strict";var t=e.cadmium,n=t.Eventable.extend({knownEvents:Object.freeze({SHOW_MENU:"showmenu",HIDE_MENU:"hidemenu",METADATA_LOADED:"metadata-loaded",SHOWN_TRICKPLAY_PREVIEW:"trickplay-shown",HIDDEN_TRICKPLAY_PREVIEW:"trickplay-hidden",CINEMA_MODE_ENTER:"cinema-enter",CINEMA_MODE_EXIT:"cinema-exit",KEYBOARD_SEEK_ENTER:"keyboard-seek-enter",DRAG_MODE_ENTER:"drag-enter",FORCE_SHOW_MENU:"force-show-menu",REMOVE_FORCE_SHOW_MENU:"remove-force-show-menu",DRAG_START_SCRUBBER:"drag-start-scrubber",DRAG_FINISH_SCRUBBER:"drag-finish-scrubber",AUTOPLAY_NEXT_EPISODE:"autoplay-next-episode",SHOW_AUTOPLAY_INTERRUPTER:"show-autoplay-interrupter",HIDE_AUTOPLAY_INTERRUPTER:"hide-autoplay-interrupter",STOP_AUTOPLAY_TIMER:"stop-autoplay-timer",START_AUTOPLAY_TIMER:"start-autoplay-timer",FULLSCREEN_CHANGE:"fullscreenchange",PAUSE_TOGGLED:"pause-toggled",INCOGNITO_CHANGED:"incognito-changed",VIDEO_FIRST_PLAY:"videoFirstPlay",VIDEO_ENDED:"VideoEnded",VIDEO_POSTPLAY_ENTER:"videoPostplayEnter",NEW_PLAYER_CREATED:"playerCreated",NEW_PLAYER_DOM_CREATED:"playerDomCreated",MDX_LOADED:"mdxLoaded",WINDOW_RESIZE:"resize",ERROR:"ui-error",SHUTDOWN:"ui-shutdown"}),init:function(){this._super()},destroy:function(){this.events={}}});e.cadmium.UiEvents=new n,window.netflix.cadmium=window.netflix.cadmium||{},window.netflix.cadmium.UiEvents={addEventListener:e.cadmium.UiEvents.addEventListener,events:e.cadmium.UiEvents.events,removeEventListener:e.cadmium.UiEvents.removeEventListener,knownEvents:e.cadmium.UiEvents.knownEvents}}(),function(){"use strict";function t(e,t){return"function"!=typeof e?void a.error("Handler is not a function."):void(t?d.unshift(e):d.push(e))}function n(e){d.forEach(function(t,n){t===e&&d.splice(n,1)})}function i(){Rx.Observable.merge(e.cadmium.playbackShutdown,Rx.Observable.fromEvent(window,"beforeunload"),Rx.Observable.fromEvent(window,"popstate").filter(function(){var e=location.pathname.toLowerCase();return e.indexOf("watch")<0&&e.indexOf("wiplayer")<0})).takeUntil(u).take(1).doAction(function(e){var t,n={isPopStateEvent:e instanceof window.PopStateEvent,event:e};for(t=0;t<d.length;t++)d[t](n)},r,r).subscribe(l,a.getErrorHandler("beforeUnload"),l)}function o(){c&&r(),c=!0,s=e.cadmium,a=s.Logger.create("UnloadActions"),l=s.util.noop,u=new Rx.Subject,i()}function r(){u&&u.onNext(),a=null,l=null,u=null,m=d.length,c=!1}var s,a,l,u,c=!1,d=[],m=0;e.cadmium.playbackShutdown=e.cadmium.playbackShutdown||new Rx.Subject,e.cadmium.addBeforeUnloadHandler=t,e.cadmium.removeBeforeUnloadHandler=n,e.cadmium.unloadActions={init:o}}(),e.cadmium.playbackEvents=function(){"use strict";function t(){a()&&!s()&&i(!0),m.fireEvent(m.knownEvents.VIDEO_ENDED)}function n(){r()||i()}function i(e){k[x]=!0,m.fireEvent(m.knownEvents.VIDEO_POSTPLAY_ENTER,{hidePlayer:!!e})}function o(){if(!P){P=!0;var e,i=c.videoIsKnown(x);i&&(e=c.getActiveVideo(),E=e.creditsOffset||f,E&&a()&&w.fromEvent(v,"currenttimechanged").takeUntil(_).sample(T).filter(function(){return v?(g=v.getCurrentTime()/1e3,!v.getPaused()&&g>=E):!1}).doAction(n).subscribe(b,h.getErrorHandler("event|currenttimechanged"),b)),L?w.fromEvent(v,"currenttimechanged").takeUntil(_).sample(T).filter(function(){return v?(g=v.getCurrentTime(),g>=f-1500):!1}).doAction(t).subscribe(b,h.getErrorHandler("event|webkit-currenttimechanged"),b):w.fromEvent(v,"endedchanged").takeUntil(_).filter(function(){return v&&v.getEnded()}).doAction(t).subscribe(b,h.getErrorHandler("event|endedchanged"),b)}}function r(){return!!k[x]}function s(){var e=d.playerWrapper();return e&&e.classList.contains("player-postplay")||!1}function a(){var e=c.getActiveVideo()||{},t=y.ui.preplay.preplayNeeded();return!t&&!p.getClipValues(e)}function l(){A&&u(),A=!0,c=y.metadata,d=y.objects,m=y.UiEvents,p=y.clips,h=y.Logger.create("playback.events"),w=Rx.Observable,h.log("init"),_=new Rx.Subject,k={},b=y.util.NOOP;var e=w.fromEvent(m,m.knownEvents.VIDEO_FIRST_PLAY).delay(3e3),t=w.fromEvent(m,m.knownEvents.METADATA_LOADED);w.concat(e,t).take(1).takeUntil(_).doAction(function(){x=d.videoId(),v=d.videoPlayer(),f=v.getDuration(),o()}).subscribe(b,h.getErrorHandler("events|firstplay+metadataloaded"),b)}function u(){_&&_.onNext(),h.log("deinit"),c=null,d=null,m=null,w=null,p=null,h=null,k={},x=null,v=null,E=null,f=null,g=null,P=!1,_=null,b=null,A=!1}var c,d,m,p,h,v,E,f,g,_,b,y=e.cadmium,w=Rx.Observable,k={},T=500,x=null,L="webkit"===y.browser.prefix().lowercase,A=!1,P=!1;return{init:l,deinit:u}}(),e.cadmium.ui.errors=function(){"use strict";function t(e,t){o.fireEvent(o.knownEvents.ERROR,[n(e,t)])}function n(e,t){t=t&&"-"+t||"";var n,o=r+e+t,l=null,u=[];switch(e){case s.UI_NO_METADATA:u.push("ui_no_metadata");break;case s.UI_PLAYER_CREATION_EXCEPTION:u.push("ui_player_creation_exception");break;case s.UI_TITLE_UNAVAILABLE:n=i&&i.objects&&i.objects.getCountry(),a[n]?u.push("title-unavailable-"+n):u.push("title-unavailable");break;case s.UI_UNKNOWN:default:u.push("default")}return u.push(o),{messageIdList:u,display:{code:o,text:l}}}var i=e.cadmium,o=i.UiEvents,r="UI",s=Object.freeze({UI_UNKNOWN:3e3,UI_NO_METADATA:3001,UI_PLAYER_CREATION_EXCEPTION:3002,UI_TITLE_UNAVAILABLE:3003}),a={us:"us",ca:"ca",mx:"mx",br:"br",uk:"uk",ie:"ie",dk:"dk",fi:"fi",no:"no",se:"se",nl:"nl",fr:"fr",de:"de",ch:"ch",at:"at",be:"be",lu:"lu"};return{type:s,throwUIError:t}}(),e.cadmium.cinemamode=function(){"use strict";function t(){P=!1}function n(){P=!0,a()}function i(){R=!0}function o(){R=!1}function r(){var e=!1;return x&&P&&!R?S&&(e=A&&A.some(function(e){return e&&e.contains(S)&&g.intendsToBeVisible(S)}))?void k.log("Not entering cinema mode",{lastMouseTarget:S&&S.toString()}):(k.log("Entering cinema mode",{lastMouseTarget:S&&S.toString()}),I&&clearTimeout(I),void b.fireEvent(b.knownEvents.CINEMA_MODE_ENTER)):void k.log("Can't enter cinema mode",{initialized:x,cinemaModeEnabled:P,modal:R})}function s(){x&&(clearTimeout(I),b.fireEvent(b.knownEvents.CINEMA_MODE_EXIT),T.getBusy()||a())}function a(){clearTimeout(I),I=setTimeout(r,D)}function l(){clearTimeout(I),t(),L.removeEventListener("mousemove",U,!1),L.removeEventListener("mousemove",M,!1),b.removeEventListener(b.knownEvents.KEYBOARD_SEEK_ENTER,l),b.removeEventListener(b.knownEvents.DRAG_START_SCRUBBER,l),b.addEventListener(b.knownEvents.DRAG_MODE_ENTER,u),b.addEventListener(b.knownEvents.DRAG_FINISH_SCRUBBER,u)}function u(){n(),a(),L.addEventListener("mousemove",U,!1),L.addEventListener("mousemove",M,!1),b.removeEventListener(b.knownEvents.DRAG_MODE_ENTER,u),b.removeEventListener(b.knownEvents.DRAG_FINISH_SCRUBBER,u),b.addEventListener(b.knownEvents.KEYBOARD_SEEK_ENTER,l),b.addEventListener(b.knownEvents.DRAG_START_SCRUBBER,l)}function c(e){s()}function d(){s()}function m(){x&&(T.getBusy()||s())}function p(e){e&&Array.isArray(e)&&(A=A.concat(e))}function h(){x&&(k.log("cinemamode.manager.deinit"),x=!1,clearTimeout(I),L.removeEventListener("mousemove",U),L.removeEventListener("mousemove",M),document.body.removeEventListener("keydown",c),T.removeEventListener("busychanged",m),T.removeEventListener("pausedchanged",d),b.removeEventListener(y.FORCE_SHOW_MENU,t),b.removeEventListener(y.REMOVE_FORCE_SHOW_MENU,n),b.removeEventListener(y.SHOW_AUTOPLAY_INTERRUPTER,i),b.removeEventListener(y.HIDE_AUTOPLAY_INTERRUPTER,o),b.removeEventListener(y.KEYBOARD_SEEK_ENTER,l),b.removeEventListener(y.DRAG_START_SCRUBBER,l),S=null,E=null,_=null,g=null,w=null,f=null,A=null,L=null,T=null,y=null,b=null,k.log("cinemamode.manager.deinit complete"))}function v(){x&&h(),x=!0,E=e.cadmium,_=E.metadata,b=E.UiEvents,g=E.element,w=E.objects,f=E.ui,k=E.logging,y=b.knownEvents,T=w.videoPlayer(),L=w.playerWrapper();var r=E.url.getQueryString().trackpointerpos;r&&(N="true"===r),A=[],k.log("cinemamode.manager.init",{playerWrapperEl:L&&L.toString()}),L.addEventListener("mousemove",U,!1),L.addEventListener("mousemove",M,!1),document.body.addEventListener("keydown",c,!1),T.addEventListener("busychanged",m),T.addEventListener("pausedchanged",d),b.addEventListener(y.FORCE_SHOW_MENU,t),b.addEventListener(y.REMOVE_FORCE_SHOW_MENU,n),b.addEventListener(y.SHOW_AUTOPLAY_INTERRUPTER,i),b.addEventListener(y.HIDE_AUTOPLAY_INTERRUPTER,o),b.addEventListener(y.KEYBOARD_SEEK_ENTER,l),b.addEventListener(y.DRAG_START_SCRUBBER,l),s()}var E,f,g,_,b,y,w,k,T,x=!1,L=null,A=[],P=!0,I=null,O=null,C=null,S=null,N=!0,R=!1,D=2200,M=function(e){O=e.clientX,C=e.clientY,S=e.target},U=function(e){R||(N?(e.clientX!=O||e.clientY!=C)&&s():s())}.debounce(20,!0);return{init:v,deinit:h,addExclusionEls:p,disableCinemaMode:t,enableCinemaMode:n}}(),e.cadmium.metadata=function(){"use strict";function t(){A=null,P=!1,I=null,y=null,w=null,k=null,T=null,x=[]}function n(e){return e&&e.video&&e.video.type}function i(e){return P&&e.video.type===O.show}function o(e){function t(e){return e.episodes.length}var n,i=A.video.seasons;return i.forEach(function(i){return i.id===e?t(i):(n=i.episodes,void n.forEach(function(n){return n.id===e?t(i):void 0}))}),0}function r(e){return d(e)&&i(A)?x.length:0}function s(t){function o(e,t){A.video.seasons[e].episodes[t].active=!0,y=s[e],w=y.episodes[t],y.episodes[t+1]?(T=y,k=y.episodes[t+1]):s[e+1]&&(T=s[e+1],k=T.episodes[0])}if(w=null,y=null,k=null,T=null,x=[],!n(A))return void(P=!1);if(P=!0,i(A)){var r,s=A.video.seasons;s.forEach(function(e,n){e.id===t&&o(n,0),r=e.episodes,r.forEach(function(e,i){x.push(e.id),e.id===t?o(n,i):A.video.seasons[n].episodes[i].active=!1})})}else A.video.active=!0,w=A.video,x.push(w.id);var a=A.trackIds;if(a){var l=e.cadmium.objects;l.addInitParam("trackIdEpisodeSelector",a.episodeSelector),l.addInitParam("trackIdNextEpisode",a.nextEpisode)}}function a(t,n,i){var o=+t,r=e.cadmium,a=r.UiEvents;n&&(A=n,s(o),I=o),a.fireEvent(a.knownEvents.METADATA_LOADED),r.logging.log("success loading metadata"),i&&"function"==typeof i&&i(A)}function l(e,t){for(var n=e.split("."),i=A,o=0;o<n.length;o++)o==n.length-1?i[n[o]]=t:i&&(i=i[n[o]])}function u(t,n,i){function o(e){e&&null!=e.version?a(s,e,n):r({status:C.INVALID_METADATA})}function r(e){P=!1,i&&"function"==typeof i&&i(e.status)}var s=+t,l=e&&e.cadmium&&e.cadmium.objects&&"function"==typeof e.cadmium.objects.initParams&&e.cadmium.objects.initParams()||{};if(I!==s)if(d(s))a(s,A);else if(e.cadmium.ui.master.isAkira())L||(L=Requireify.require("js/utils/player/playerMetadata.js")),L.getMetadataCall(s,window.pathEvaluator).timeout(15e3).retryWithBackoff(3,1e3).doAction(o).subscribe(S,r,S);else{var u=l.metadataBaseServer||"",c=u+"/WiPlayerMetadata?id="+s+"&type=cadmium",m=new XMLHttpRequest;m.onload=function(){var e;try{e=JSON.parse(m.responseText)}catch(t){}e?o(e):r(m)},m.onerror=function(){r(m)},m.open("GET",c,!0),m.withCredentials=!0,m.send()}else a(s)}function c(e,t,n){t&&(A=t,s(e)),t&&d(e)?a(e,t):u(e,null,n)}function d(e){return x&&x.indexOf(e)>=0}function m(){return A}function p(){return w}function h(){return i(A)?y:null}function v(){return i(A)?k:null}function E(){return i(A)?T:null}function f(e,t){var n,i=0,o=null;return e&&e.length>0&&e.forEach(function(e,r){n=e.h*e.w,t(n,i)&&(i=n,o=r)}),null!==o?e[o]:null}function g(e){return f(e,function(e,t){return e>t})}function _(e){return f(e,function(e,t){return 0>=t||t>e})}function b(){return!(!A||!A.video||A.video.type!==O.supplemental)}var y,w,k,T,x,L,A=null,P=!1,I=null,O=Object.freeze({show:"show",movie:"movie",supplemental:"supplemental"}),C=Object.freeze({INVALID_METADATA:1e3}),S=e.cadmium.util.NOOP;return{prepare:c,setMetadata:a,setMetadataField:l,retrieveData:u,getMetadata:m,getActiveVideo:p,getActiveSeason:h,getTotalEpisodeCount:r,getSeasonEpisodeCount:o,
getNextEpisode:v,getNextEpisodeSeason:E,getLargestImage:g,getSmallestImage:_,isShowData:i,videoTypes:O,videoIsKnown:d,isSupplementalVideo:b,clear:t}}(),e.cadmium.clips=function(){function t(t,n){return n||(n=e.cadmium.objects.initParams()),n&&n.clipsMode&&n.clipsMode[t]}return{getClipValues:t}}(),e.cadmium.objects=function(){"use strict";function t(e){_=e||_}function n(e){e>=0&&(b=e)}function i(){b=0}function o(e){k=e}function r(e){L=e}function s(e,t){L=L||{},L[e]=t}function a(e){T=e}function l(){y=null}function u(){if(null!==y)return P.log("reusing video session"),!1;var e=L;return e.renderTimedText=!0,y=new window.netflix.player.VideoSession(e),!0}function c(e){y&&y.applyConfig(e)}function d(e,t){if(L){if(e=parseInt(e,10),t=parseInt(t,10),isNaN(e)||isNaN(t))return void P.error("Invalid params videoId="+e+", position="+t);L.bookmarkByMovieId=L.bookmarkByMovieId||{},L.bookmarkByMovieId[e]=t,c(L)}}function m(){w.removeEventListener(C,m),x=!1}function p(i,o,r){t(i),n(o);var s,a,l,u,c,d=A.UiEvents,h=A.ui.errors;x?w.close(function(){x=!1,p(i,o,r)}):(l={},u={},s={trackingId:b},a=e.cadmium.clips.getClipValues(_),a&&(s.clipStart=a.start,s.clipDuration=a.duration),l.uiplaycontext=v(),P.info("Setting play context:",I,",trackId: "+b),s.sessionParams=l,L.assistiveAudioPreferred&&(u.assistiveAudioPreferred=!0),u.pinCapableClient=!(!L.pinConfig||!L.pinConfig.isEnabled),s.authParams=u,c=e.cadmium.util.tryCatch(y.createPlayer,y,[_,s]),c instanceof Error?(P.error(c),h.throwUIError(h.type.UI_PLAYER_CREATION_EXCEPTION),r&&r(new Error(h.type.UI_PLAYER_CREATION_EXCEPTION))):(w=c,A.timedtext.create(w,L),d.fireEvent(d.knownEvents.NEW_PLAYER_CREATED),w.addEventListener("loaded",function f(e){E(!0),w.removeEventListener("loaded",f)}),w.load(),w.addEventListener(C,m),x=!0,r&&r(null,w)))}function h(e){I=e}function v(){if(L&&L.playcontext&&!I&&(I=L.playcontext,delete L.playcontext),!I)return null;var e=-99,t="unknown";return{row:void 0!=I.row?I.row:e,rank:void 0!=I.rank?I.rank:e,location:I.location||t,request_id:I.request_id||t}}function E(e){O=e,L&&L.bookmarkByMovieId&&delete L.bookmarkByMovieId[_]}function f(e,t){function n(){e||(y=null,L=null,_=null,k=null,I=null,b=0,T=null,P.log("full drain")),w=null,x=!1,O=!1,P.log("drained")}if(t)n();else try{y?y.closeAllPlayers(n):n()}catch(i){n()}}function g(){var t,n=A&&A.ui&&A.ui.master&&A.ui.master.isAkira&&A.ui.master.isAkira();return t=n?e&&e.contextData&&e.contextData.userContext&&e.contextData.userContext.data&&e.contextData.userContext.data.geo&&e.contextData.userContext.data.geo.preferredLocale&&"string"==typeof e.contextData.userContext.data.geo.preferredLocale.country&&e.contextData.userContext.data.geo.preferredLocale.country.toLowerCase()||"":e&&e.constants&&e.constants.page&&e.constants.page.COUNTRY&&"string"==typeof e.constants.page.COUNTRY&&e.constants.page.COUNTRY.toLowerCase()||""}var _,b=0,y=null,w=null,k=null,T=null,x=!1,L=null,A=e.cadmium,P=A.Logger.create("object.pool"),I=null,O=!1,C="closed";return window.netflix.cadmium.objects={},window.netflix.cadmium.objects.setPlayContext=h,{videoSession:function(){return y},createVideoSession:u,destroyVideoSession:l,videoPlayer:function(){return w},createVideoPlayer:p,videoPlayerCreated:function(){return x},trackId:function(){return b},setTrackId:n,clearTrackId:i,videoId:function(){return _},setVideoId:t,initParams:function(){return L},setInitParams:r,addInitParam:s,playerWrapper:function(){return k},setPlayerWrapper:o,videoPlayerLoaded:function(){return O},mdxManager:function(){return T},setMdxManager:a,playContext:v,setPlayContext:h,overrideBookmark:d,getCountry:g,drain:f}}(),e.cadmium.sizing=function(){function t(){p&&(p=!1,window.removeEventListener("resize",b,!1)),h=1,d.removeEventListener(d.knownEvents.FULLSCREEN_CHANGE,_)}function n(){m&&!p&&(c.initParams().windowScaling&&(p=!0,window.addEventListener("resize",b,!1)),d.addEventListener(d.knownEvents.FULLSCREEN_CHANGE,_),""===s.style.fontSize||a&&""===a.style.fontSize?setTimeout(_,f):h=parseFloat(s.style.fontSize)||1)}function i(t){l=e.cadmium,u=l.element,c=l.objects,d=l.UiEvents,s=t,m||(m=!0,r=u.create("div",{"class":"player-sizing"},s)),n()}function o(){t(),u.remove(r),m=!1,r=null,s=null,a=null,p=!1,h=1,l=null,u=null,c=null,d=null}var r,s,a,l,u,c,d,m=!1,p=!1,h=1,v=10,E=40,f=17,g="MS"===e.cadmium.browser.prefix()?v:E,_=function(){var e,t=u.getDimensions(s).h,n=u.getDimensions(r).h,i=t/100;n>i?(e=n/i,h/=e):i>n&&(e=i/n,h*=e),s.style.fontSize=h+"em",a&&(a.style.fontSize=h+"em")},b=function(){_(),d.fireEvent(d.knownEvents.WINDOW_RESIZE)}.debounce(g,!1);return{init:i,deinit:o,start:n,stop:t,setMdxControlWrapperEl:function(e){a=e,a.style.fontSize=h+"em"},clearMdxControlWrapperEl:function(){a=null}}}(),e.cadmium.fullscreen=function(){"use strict";function t(){var t=e.cadmium.objects.playerWrapper();return t?t.msRequestFullscreen?document.msFullscreenElement:void 0!==document.webkitIsFullScreen?document.webkitIsFullScreen:void 0!==document.mozFullScreen?document.mozFullScreen:(l.error("Could not determine fullscreen status."),!1):!1}function n(){var t=e.cadmium.objects.playerWrapper();t&&(t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen())}function i(){var t=e.cadmium.objects.playerWrapper();if(t)if(t.exitFullscreen)document.exitFullscreen();else if(t.msRequestFullscreen)document.msExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.webkitCancelFullScreen)return l.error("Could not exit fullscreen"),!1;document.webkitCancelFullScreen()}}function o(){t()?i():n()}function r(){e.cadmium.UiEvents.fireEvent(e.cadmium.UiEvents.knownEvents.FULLSCREEN_CHANGE,[t()])}function s(){document.removeEventListener("webkitfullscreenchange",r),document.removeEventListener("MSFullscreenChange",r),document.removeEventListener("mozfullscreenchange",r),u=!1}function a(){u&&s(),document.addEventListener("webkitfullscreenchange",r,!1),document.addEventListener("MSFullscreenChange",r,!1),document.addEventListener("mozfullscreenchange",r,!1),u=!0}var l=e.cadmium.Logger.create("fullscreen"),u=!1;return e.cadmium.playbackShutdown.take(1).doAction(s).subscribe(e.cadmium.util.NOOP,function(e){console.error(e)}),{init:a,deinit:s,isFullscreen:t,enter:n,exit:i,toggle:o}}(),function(){"use strict";function t(){d=!0}function n(){d=!1}function i(){var e;e=u.tryCatch(l&&l.toggle),e instanceof Error&&a.error(e)}function o(e){var t=e.keyCode;return l.isFullscreen()&&e.preventDefault(),t==p?void i():void(w[t]&&this.fireEvent(w[t],[e]))}function r(){this._super(),c=new Rx.Subject,Rx.Observable.fromEvent(document,"keydown").takeUntil(c).filter(function(){return d}).doAction(o.bind(this)).subscribe(m,a.getErrorHandler("keydown"),m)}var s=e.cadmium,a=s.Logger.create("keyboard.events"),l=s.fullscreen,u=s.util,c=null,d=!0,m=function(){},p="70",h="77",v="40",E="38",f="37",g="39",_="32",b="13",y={TOGGLE_MUTE:"togglemute",DECREASE_VOLUME:"decreasevolume",INCREASE_VOLUME:"increasevolume",SEEK_BACKWARD:"seekbackward",SEEK_FORWARD:"seekforward",TOGGLE_PLAY:"toggleplay"},w={};w[h]=y.TOGGLE_MUTE,w[v]=y.DECREASE_VOLUME,w[E]=y.INCREASE_VOLUME,w[f]=y.SEEK_BACKWARD,w[g]=y.SEEK_FORWARD,w[_]=y.TOGGLE_PLAY,w[b]=y.TOGGLE_PLAY;var k=s.Eventable.extend({init:r,enableShortcut:t,disableShortcut:n,knownEvents:y});s.keyboard=new k}(),e.cadmium.session=function(){"use strict";function t(){y.keepAlive()}function n(e){f.log("session.manager",e&&e.stack||e)}function i(e){var t=l(e);return y.newSession()||!t}function o(){g&&g.onNext()}function r(e,t){b.notify(e,t)}function s(){if(!w){if(h=e.cadmium,v=h.UiEvents,E=h.objects,f=h.Logger.create("session.manager"),f.log("init"),!y||!b)return void f.log("consolidated logging library failed to load.");w=!0,g=g||new Rx.Subject,_=_||new Rx.Subject;var i=v.knownEvents,o=Rx.Observable.fromEvent(v,i.VIDEO_FIRST_PLAY),r=Rx.Observable.fromEvent(v,i.VIDEO_ENDED),s=h.util.NOOP;o.takeUntil(_).take(1).map(function(){return E.videoPlayer()}).flatMap(function(e){return Rx.Observable.interval(k).map(function(){return e})}).takeUntil(_).takeUntil(g).takeUntil(r).filter(function(e){return e&&!e.getPaused()}).doAction(t).subscribe(s,n,s)}}function a(){var e=localStorage.getItem(T);if(e)try{e=JSON.parse(e)}catch(t){e=null}return e}function l(e){return w?c(e).currentSessionData:null}function u(e,t){if(w){var n=c(e),i=n.id,o=n.localStorageData,r=n.sessionData;d(o),r.timestamp=Date.now(),r.data=r.data||{},r.data[e]=t,o[i]=r,localStorage.setItem(T,JSON.stringify(o))}}function c(e){var t=m(),n=a()||{},i=n[t]||{},o=i.data&&i.data[e];return{id:t,localStorageData:n,sessionData:i,currentSessionData:o}}function d(e){var t=m();for(var n in e)e.hasOwnProperty(n)&&n!==t&&delete e[n];return e}function m(){var e=b.getCurrentSession("userSession");return e&&e.sessionId}function p(){w&&(o(),_&&_.onNext(),f.log("deinit"),h=null,v=null,E=null,f=null,g=null,_=null,w=!1)}var h,v,E,f,g,_,b=e.clientNotifications,y=e.session,w=!1,k=6e5,T="NFPlaybackSession",x=Object.freeze({PIN:"pin",AUDIO:"audio",SUBTITLE:"subtitle",VOLUME:"volume"});return{init:s,deinit:p,heartBeat:t,isExpired:i,setSessionData:u,getSessionData:l,endSession:o,log:r,SESSION_TYPES:x}}(),function(){"use strict";function t(){u=e.cadmium,m=u.metadata,c=u.xhr,d=u.objects,p=u.UiEvents,h=u.url,v=Rx.Observable,E=u.util,f=E.NOOP,g=u.Logger.create("postplay.data"),g.log("init"),L&&y&&y.length>0&&(g.info("Getting post play data in queue."),y.shift()),L=!0,_=_||new Rx.Subject;var t=d.initParams()||{};x=x||[],k=t.postPlayBaseUrl,T=t.postPlayApiRevision,y&&y.length||(_.onNext(),r(k,d.videoId()))}function n(e){L&&(g.log("deinit"),_&&_.onNext(),u=null,c=null,d=null,m=null,p=null,h=null,v=null,E=null,f=null,g=null,_=null,b=null,y=null,w=null,k=null,T=null,e||(x=null),L=!1)}function i(){if(L||t(),y&&y.length>0){var e=y[0];return delete e.replay,o(e),v["return"](y[0])}return b?b.map(function(e){return o(e&&e.length&&e[0]),e&&e.length&&e[0]}).takeUntil(_):Rx.Observable["return"](null)}function o(e){e=e||{};var t,n=e.experience&&e.experience.impression,i=!1,o=x&&x.length||0,r=0;if(n){for(r;o>r;r++)if(t=x[r],t&&t.impressionType===n.impressionType&&t.impression===n.impression){i=!0;break}i&&(e.experience.impression=null)}}function r(e,t){if(!e)return void(b=v["throw"](new Error("No post play url available.")).takeUntil(_));if(isNaN(t))return void(b=v["throw"](new Error("Invalid movie id.")).takeUntil(_));var n=v.fromEvent(p,p.knownEvents.VIDEO_FIRST_PLAY),i=v["return"](d.videoPlayer()).filter(function(e){return!!e}),o=v.fromEvent(p,p.knownEvents.VIDEO_ENDED),r=v.fromEvent(p,p.knownEvents.VIDEO_POSTPLAY_ENTER);b=v.merge(n,i,o,r).take(1).takeUntil(_).flatMap(function(){var n={withCredentials:!0,urlEncoded:!0,data:{movieid:t}},i=d.initParams()||{};return T&&(n.data.revision=T),"prod"!==i.environment&&h.urlContains(/forcepromo=true/)&&(n.data.debugPromoPhase=!0),u.browser.supportsWebP()&&(n.headers={Accept:"image/webp, */*;"}),c.get(e,n).takeUntil(_).timeout(A).retryWithBackoff(P,I).doAction(function(e){g.log("data received",e)},g.getErrorHandler("request error"))}).map(function(e){return w=e.requestId,e=e.postplay,e instanceof Array||(e=[e]),e}).doAction(function(e){y=e}).shareReplay(),b.subscribe(f,g.getErrorHandler("dataAsObservable.subscribe"),f)}function s(e){e=e||{},g.info("Recording impression",e);var t={withCredentials:!0,urlEncoded:!0,data:{}};return T&&(t.data.revision=T),E.mix(e,t.data,null),_=_||new Rx.Subject,c.get(k,t).takeUntil(_).timeout(A).retryWithBackoff(P,I).doAction(function(t){x.push(e),g.log("Impression logged:",t)}).subscribe(f,g.getErrorHandler("xhr|impression"),f)}function a(e){return e?void y.unshift(e):void g.error("Cannot enqueue a null object.")}function l(){var e=y[0];e&&!e.replay&&(e.replay=!0,o(e),a(e))}var u,c,d,m,p,h,v,E,f,g,_,b,y,w,k,T,x,L=!1,A=1e4,P=5,I=1e3;e.cadmium.PostPlayData={init:t,deinit:n,getData:i,repeatCurrentPostPlayData:l,getRequestId:function(){return w},recordImpression:s}}(),function(){"use strict";function t(t){P||(P=!0,S=t||{},x.log("init"),k=S.localStorageKey||"uitracking.impressions",_=T.objects,b=T.UiEvents,w=T.UITrackingBuffer,V=S.maxRecords||250,I=!!S.enabled,O=S.requestId,C=S.location,N=S.debug,N&&(y=e.UITrackingOverlay),j=new Rx.Subject,i())}function n(){if(P){if(j&&j.onNext(),I=!1,O=null,C=null,R=null,D=[],M=[],U=[],H=-1,B=null,j=null,P=!1,N)for(var e,t=document.querySelectorAll(".uitracking-debug-overlay")||[],n=0;n<t.length;n++)e=t[n],e&&e.remove&&e.remove();N=!1}}function i(){x.log("Initiating event listeners."),A.fromEvent(window,"resize").merge(A.fromEvent(b,b.knownEvents.FULLSCREEN_CHANGE)).takeUntil(j).throttle(1e3).doAction(r).subscribe(L,x.getErrorHandler("window|resize"),L),w.initPolling(S)}function o(){return document.querySelectorAll("["+F+"]")}function r(){if(P){x.log("scanning...");try{var e,t=o(),n=Date.now(),i=[[],[],[],[]];x.log("Trackable items",t.length);for(var r,a=0;r=t[a];a++)e=s(r,n),i[e].push(r);if(g(),N){var l=[i[K].length+" new elements",t.length+" trackable",Date.now()-n+" ms"].join(", ");console.log("ui scan: "+l),y&&y.updateOverlays(i)}}catch(u){x.error(u)}}}function s(e,t){t=t||Date.now();var n=d(),i=e.getBoundingClientRect(),o=G,r=e.classList.contains(W);if(N){var s=e.getAttribute(F);x.log("el rect: ",s,i),x.log("window rect",n)}return h(i,n)&&(o=Y,m(e,i)&&(o=q,r||(o=K))),o===K&&(f(e,t),e.classList.add(W)),r&&q>o&&e.classList.remove(W),o}function a(e){var t=e.getAttribute(F);if(!t)return null;var n=t.split(",");return n.length<4?null:{video_id:l(n[0]),track_id:l(n[1]),row:l(n[2]),rank:l(n[3]),request_id:n[4]||O||Q,location:n[5]||C||Q}}function l(e){return e=parseInt(e,10),isNaN(e)&&(e=X),e}function u(e,t){for(var n=["video_id","track_id","row","rank"],i=[],o=0;o<n.length;o++){var r=n[o];t.hasOwnProperty(r)||x.log("trackElement - trackingContext field not found: "+r),i.push(t[r])}i.push(t.request_id||""),i.push(t.location||""),e.setAttribute(F,i.join(","))}function c(e,t){u(e,t),s(e),y&&y.updateOverlays()}function d(){if(B)return B;if(0>H){var e=document.getElementById(z);H=e&&"fixed"==E(e,"position")?e.getBoundingClientRect().bottom:0}var t=window,n=document,i=n.documentElement,o=n.getElementsByTagName("body")[0],r=t.innerWidth||i.clientWidth||o.clientWidth,s=t.innerHeight||i.clientHeight||o.clientHeight;return B={left:0,top:H,right:r,bottom:s}}function m(e,t){var n,i,o=v(e,"parentNode"),r=[];for(n=0;i=o[n];n++){if(p(i))return!1;var s=E(i,"overflow");s&&s.match(/hidden|scroll|auto/)&&r.push(i)}for(n=0;i=r[n];n++)if(!h(t,i.getBoundingClientRect()))return!1;return!p(e)}function p(e){return"hidden"==E(e,"visibility")}function h(e,t){var n=e.left+(e.right-e.left)/2,i=e.top+(e.bottom-e.top)/2;return e.left==e.right||t.left==t.right?!1:n>=t.left&&n<=t.right&&i>=t.top&&i<=t.bottom}function v(e,t,n){for(var i=[],o=e[t];o&&9!==o.nodeType&&(void 0===n||1!==o.nodeType);)1===o.nodeType&&i.push(o),o=o[t];return i}function E(e,t){var n=document.defaultView;return n&&n.getComputedStyle?n.getComputedStyle(e,null).getPropertyValue(t):e.currentStyle?e.currentStyle[t]:""}function f(e,t){var n=a(e);y&&y.markAsVisible(e),x.info("Registering impression.",n),n?(n.time=t,D.push(n)):x.log("Impression: No trackingContext for element",e)}function g(){var e=D;if(D=[],N){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n].row+","+e[n].rank+" "+e[n].video_id);x.log(t.join("\n"))}var o=JSON.parse(localStorage.getItem(k)||"[]");N&&x.log("saved impressions: "+o.length+"\nnew impressions: "+e.length+"\nmax impressions: "+V);var r=o.length+e.length;r>V&&(x.log("Buffer is full."),o.splice(0,r-V),N&&console.log("removing "+(r-V)+" items from storage to keep length <= "+V)),o=o.concat(e);try{localStorage.setItem(k,JSON.stringify(o)),N&&localStorage.setItem(J,"true")}catch(s){U=U.concat(o)}}var _,b,y,w,k,T=e.cadmium,x=T.Logger.create("presentation.tracking"),L=T.util.NOOP,A=Rx.Observable,P=!1,I=!1,O=null,C=null,S=null,N=!1,R=null,D=[],M=[],U=[],H=-1,B=null,V=250,j=null,F="data-uitrack",W="uitracking-state-visible",z="hd",G=0,Y=1,q=2,K=3,X=-99,Q="unknown",J="uitracking.debug";e.cadmium.UITracking={init:t,deinit:n,scan:r,trackElement:c,getTrackingContext:a,getFallbackSendBuffer:function(){return I&&U&&U.length?U:[]},TRACKING_ATTRIBUTE:F}}(),e.UITrackingOverlay=function(){function t(e,t){return e.className.indexOf(t)>-1}function n(e,n){t(e,n)||(e.className+=" "+n)}function i(e,t){e.className=e.className.replace(t,"")}function o(e,t){for(var n,i=Array.prototype.slice.call(document.getElementsByClassName(e));n=i.shift();)t(n)}function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])}var s="uitracking-debug-state-inwindow",a="uitracking-debug-state-visible",l="uitracking-debug-state-sent",u="uitracking-debug-overlay",c="uitracking-debug-state",d="#000",m="#c11",p="#de6400",h="#480c44",v=1,E=2,f=3,g={updateDebugStates:function(e){o(s,function(e){i(e,s)});for(var t=0;t<e.length;t++)for(var r=e[t],a=0,u=r.length;u>a;a++){var d=r[a];d.setAttribute(c,t),t>=v&&n(d,s),t>=f&&i(d,l)}},markAsVisible:function(e){n(e,a)},markOverlaysAsSent:function(){var e=this;o(a,function(e){n(e,l),i(e,a)}),o(u,function(t){e.setOverlayColor(t,h)})},updateOverlays:function(e){e&&this.updateDebugStates(e),o(u,function(e){e.parentNode.removeChild(e)});var t=this;o(s,function(e){t.addDebugOverlay(e)})},addDebugOverlay:function(i){var o=i.getAttribute(c,o)||0,s=o>=E?"solid":"dotted",a=o>=f?m:p;E>o&&(a=d),t(i,l)&&(a=h);var v=e.cadmium.UITracking.getTrackingContext(i),g=i.getBoundingClientRect(),_=document.createElement("div");r(_,{position:"fixed",zIndex:1e3,"pointer-events":"none",left:g.left+"px",top:g.top+"px",width:g.width-4+"px",height:g.height-4+"px",border:s+" 2px"}),n(_,u);var b=document.createElement("span");b.className="has-color",r(b,{font:"10pt arial",padding:"5px",margin:0,color:"#fff","float":"left"}),b.innerHTML=v.row+","+v.rank+" &nbsp; "+v.video_id,_.appendChild(b);var y=document.createElement("div");y.className="has-color",r(y,{margin:"0 auto",position:"relative",top:Math.floor(g.height/2)-4-16+"px",width:"16px",height:"16px",borderRadius:"8px"}),_.appendChild(y),document.getElementsByTagName("body")[0].appendChild(_),this.setOverlayColor(_,a)},setOverlayColor:function(e,t){r(e,{borderColor:t});for(var n=e.getElementsByClassName("has-color"),i=0;i<n.length;i++)r(n[i],{backgroundColor:t})}};return g}(),function(){"use strict";var t,n,i,o,r,s,a,l,u,c,d,m,p,h,v={initPolling:function(E){E=E||{},a=!0,t=e.constants,n=e.cadmium,i=n.Logger.create("presentation.tracking.sender"),o=n.UITracking,r=n.xhr,s=n.util.NOOP,u="uitracking.debug",c=t.page.UITRACKING_SEND_RATE_MS||8e3,m=t.page.UITRACKING_SEND_RATE_MAX_DECAY_MULTIPLIER||5,p=1,h=0,l=E.localStorageKey||"uitracking.impressions",d=E.endpoint||"https://presentationtracking.netflix.com/users/presentationtracking",v.flush(),i.log("Init polling at "+c);var f=this;setInterval(function(){i.log("Attempting to flush buffer...");try{++h>=p&&f.flush()}catch(e){i.log("Error flushing.",e)}},c)},flush:function(){if(a){i.log("Flush.");var t=[];try{t=o.getFallbackSendBuffer(),t.length||(t=JSON.parse(localStorage.getItem(l)||"[]"),o.retrySend||localStorage.setItem(l,"[]"))}catch(n){i.log("Error flushing.",n)}if(t&&t.length){h=0,p=Math.max(p++,m),this.send(t);var r=localStorage.getItem(u)||!1;r&&(this._logSentTitles(t),e.UITrackingOverlay&&e.UITrackingOverlay.markOverlaysAsSent(),localStorage.removeItem(u))}}},send:function(e){i.log("Sending.");var n=t.page,o={esn:n.ESN||null,esnPrefix:n.ESNPrefix||null,country:n.COUNTRY,application_name:n.APP_NAME,application_v:n.APP_VERSION,sw_version:n.UITRACKING_USER_AGENT||"",data:JSON.stringify(e)};i.log("sending",o);var a={withCredentials:!0,urlEncoded:!1,data:o},l=r.post(d,a).retryWithBackoff(5,1e3).doAction(function(e){i.log("Response:",e)});return l.subscribe(s,i.getErrorHandler("xhr|post"),s),l},_logSentTitles:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].video_id);t=t.sort(),console.log("SENT TITLES: "+t.length,t),console.log("----------------------------------------------------")}};e.cadmium.UITrackingBuffer=v}(),function(){"use strict";function t(e,t){var n,i;for(n in t)i=t[n],i.ns?e.setAttributeNS(i.ns,n,i.value):e.setAttribute(n,i)}function n(e,t){e.ui=e.ui||{},t=t||e.ui.timedText&&e.ui.timedText._config||{};var n=e.getTimedTextTrack();e.ui.timedText&&"function"==typeof e.ui.timedText.destroy&&e.ui.timedText.destroy(),n&&n.isImageBased?e.ui.timedText=new r(e,t):e.ui.timedText=new o(e,t)}function i(e){return e.id}var o=e.cadmium.Class.extend({_player:null,_config:null,init:function(e,t){this._player=e,this._config=t||{}},destroy:function(){this._player=null},setBounds:function(e){this._player&&this._player.setTimedTextBounds(e)}}),r=o.extend({_elementsInView:null,_containerEl:null,_boundingReferenceEl:null,_timedTextContainerEl:null,_debugEl:null,_disposed:null,_recycledImageTags:null,_bounds:null,_viewBox:null,_config:null,_configure:function(e){e=e||{},this._config={},this._config.forceCCPaint=!!e.forceCCPaint,this._config.ccQNREnabled="undefined"==typeof e.ccQNREnabled?!0:!!e.ccQNREnabled,this._config.ccQNRsla=e.ccQNRsla||100},init:function(e,t){this._super(e),this._removalQueue=[],this._elementsInView={},this._disposed=new Rx.Subject,this._recycledImageTags=[],this._timeoutHandle=null,this._configure(t),this._createElements(),this._createEventSubscriptions()},destroy:function(){this._disposed&&!this._disposed.isStopped&&(this._disposed.onNext(),this._disposed.onCompleted(),this._containerEl&&this._containerEl.parentNode&&this._containerEl.parentNode.removeChild(this._containerEl),this._removalQueue=null,this._player=null,this._elementsInView=null,this._containerEl=null,this._timedTextContainerEl=null,this._disposed=null,this._recycledImageTags=null,this._boundingReferenceEl=null,this._bounds=null,this._viewBox=null,this._config=null)},show:function(e){this._addTimedText(e)},hide:function(e){this._removeTimedText(i(e))},setBounds:function(e){if(this._disposed&&!this._disposed.isStopped&&(e=e||{},void 0!==e.bottom&&e.bottom!==(this._bounds&&this._bounds.bottom))){this._player.ui._timedTextBounds=this._bounds=e;var t=this;requestAnimationFrame(function(){t._disposed&&!t._disposed.isStopped&&(t._containerEl.style.bottom=t._getBottomOffset(t._bounds.bottom)+"px",t._forceRedraw())})}},_getBottomOffset:function(e){var t=this._boundingReferenceEl.getBoundingClientRect(),n=t.top,i=Math.floor(n-e),o=0;return 0>i&&(o=-1*i),o},_createElements:function(){this._elementsInView={},this._recycledImageTags=[],this._containerEl=document.createElement("div"),this._containerEl.style.cssText="display: block;position: absolute;top: 0;right: 0;bottom: 0;left: 0;transform: translateZ(0);-webkit-transform: translateZ(0);",this._timedTextContainerEl=document.createElementNS("http://www.w3.org/2000/svg","svg"),t(this._timedTextContainerEl,{width:"100%",height:"100%",style:"position: absolute; top: 0; bottom: 0; left: 0; right: 0;"}),this._boundingReferenceEl=document.createElementNS("http://www.w3.org/2000/svg","rect"),t(this._boundingReferenceEl,{fill:"none",stroke:"none",x:"0",y:"0"}),this._timedTextContainerEl.appendChild(this._boundingReferenceEl),this._containerEl.appendChild(this._timedTextContainerEl),this._player.getElement().appendChild(this._containerEl)},_createEventSubscriptions:function(){var t=Rx.Observable,n=e.cadmium.util.NOOP,i=t.fromEvent(this._player,"closed");t.fromEvent(this._player,"showsubtitle").takeUntil(this._disposed).takeUntil(i).doAction(this.show.bind(this)).subscribe(n,function(e){console.error(e)},n),t.fromEvent(this._player,"removesubtitle").takeUntil(this._disposed).takeUntil(i).doAction(this.hide.bind(this)).subscribe(n,function(e){console.error(e)},n)},_createTimedTextElement:function(e,n){var i=URL.createObjectURL(new Blob([e.imageData],{type:"image/png"})),o=this._createImageTag();return t(o,{href:{ns:"http://www.w3.org/1999/xlink",value:i},width:e.sizeX,height:e.sizeY,x:e.originX,y:e.originY}),requestAnimationFrame(function(){URL.revokeObjectURL(i),n&&n(o)}),o},_createImageTag:function(){return this._recycledImageTags.pop()||document.createElementNS("http://www.w3.org/2000/svg","image")},_addTimedText:function(e){var n=i(e),o=this._removalQueue.indexOf(n);if(o>-1)return void(this._removalQueue[o]=null);var r=this._createTimedTextElement(e);if(this.setBounds(this._player.ui._timedTextBounds),this._viewBox||(this._viewBox="0 0 "+e.rootContainerExtentX+" "+e.rootContainerExtentY,t(this._timedTextContainerEl,{viewBox:this._viewBox}),t(this._boundingReferenceEl,{width:e.rootContainerExtentX,height:e.rootContainerExtentY,fill:"none"})),this._timedTextContainerEl.appendChild(r),this._elementsInView[n]=r,this._config.forceCCPaint&&this._forceRedraw(),window.DEBUG){this._debugEl||(this._debugEl=this._boundingReferenceEl,t(this._debugEl,{stroke:"yellow","stroke-width":"4",fill:"none"}),this._timedTextContainerEl.appendChild(this._debugEl));var s='<g xmlns="http://www.w3.org/2000/svg"><rect x="'+e.originX+'" y="'+e.originY+'" width="'+e.sizeX+'" height="'+e.sizeY+'" fill="rgba(0,0,0,0)" stroke="yellow"></rect><text x="'+e.originX+'" y="'+(e.originY-6)+'" font-size="18" fill="yellow">( '+[e.originX,e.originY,e.sizeX,e.sizeY].join(", ")+" )</text></g>",a=(new DOMParser).parseFromString(s,"text/xml").firstChild;this._timedTextContainerEl.appendChild(a),this._elementsInView[n+"_debug"]=a}else this._debugEl&&(t(this._debugEl,{stroke:"none"}),this._debugEl=null)},_removeNodeForId:function(e){var t=this._elementsInView[e],n=e+"_debug",i=this._elementsInView[n];t&&this._timedTextContainerEl.removeChild(t),i&&this._timedTextContainerEl.removeChild(i),this._recycleImageTag(t),t&&delete this._elementsInView[e],i&&delete this._elementsInView[n]},_removeTimedText:function(e){var t;this._config.ccQNREnabled?(t=this,-1===this._removalQueue.indexOf(e)&&(this._removalQueue.push(e),setTimeout(function(){var e=t._removalQueue.shift();e&&(t._removeNodeForId(e),t._forceRedraw())},this._config.ccQNRsla))):(this._removeNodeForId(e),this._forceRedraw())},_forceRedraw:function(){if(this._config.forceCCPaint){var e=this;this._containerEl.style.display="none",requestAnimationFrame(function(){e._containerEl.style.display=""})}},_recycleImageTag:function(e){if(e&&e.attributes){var t,n;for(t=0;t<e.attributes.length;t++)n=e.attributes.item(t),n&&e.removeAttribute(n.name);this._recycledImageTags.push(e)}}});e.cadmium.timedtext={create:function(t,i){var o=e.cadmium.util.NOOP,r=Rx.Observable.fromEvent(t,"closed");n(t,i),Rx.Observable.fromEvent(t,"timedtexttrackchanged").takeUntil(r).map(function(e){return e.target}).doAction(n).subscribe(o,function(e){console.error(e)},o)}}}(),e.cadmium.views=function(){function e(e,t){r[t].push(e)}function t(e,t){s||(r[o.standard].forEach(function(e){e.deinit()}),r[o.fatal].indexOf(e)>=0&&(s=!0),e.init.apply(this,t))}function n(){s=!1}var i,o=Object.freeze({standard:1,fatal:2}),r={},s=!1;for(i in o)o.hasOwnProperty(i)&&(i=o[i],r[i]=[]);return{types:o,register:e,show:t,deinit:n}}(),function(){var t=e.cadmium;t.ui.Component=t.Eventable.extend({parentNode:null,initialized:!1,config:{id:"player-component"},destroy:function(){if(this.initialized){this.initialized=!1,this.events={};for(var e in this)this.hasOwnProperty(e)&&(this[e]=null)}},init:function(e,t){this._super(),this.initialized&&this.destroy(),this.initialized=!0,this.parentNode=e,this.config=t||this.config}})}(),function(){"use strict";var t=e.cadmium,n=t.element,i=n.classNames.hidden,o=n.classNames.active,r=t.dom.DIV;t.ui.RadialProgressComponent=t.ui.Component.extend({progressEl:null,percent:0,destroy:function(){this.initialized&&(this.initialized=!1,n.remove(this.progressEl),this._super())},init:function(e,t){this._super(e,t);var n,s=["player-progress-round",this.config.hideWhenEmpty?i:o].join(" ");this.progressEl=r({"class":s,id:this.config.id},r({"class":"player-progress-loading"}),n=r({"class":"player-progress-val"},"0%")),this.progressVal=n,this.parentNode.appendChild(this.progressEl)},update:function(e){var t=Math.floor(e);if(this.initialized&&this.percent!==t){this.percent=t;var n=0===this.percent&&this.config.hideWhenEmpty||100===this.percent&&this.config.hideWhenFull,r=this;n?(r.progressEl.classList.remove(o),requestAnimationFrame(function(){r.progressEl.classList.add(i)})):(this.progressEl.classList.add(o),requestAnimationFrame(function(){r.initialized&&r.progressEl.classList.remove(i)})),this.progressVal.textContent=this.percent+"%"}}})}(),function(){var t=e.cadmium,n=t.element,i=t.objects,o=t.UiEvents,r=t.browser.pointerTypes,s=n.classNames,a=s.active,l=s.hidden,u=s.animate;t.ui.ScrubberComponent=t.ui.Component.extend({config:{id:"scrubber-component"},value:0,max:0,buffer:0,dragging:!1,pointerEventData:null,dragIncorrectDirectionPercentAllowed:.3,knownEvents:Object.freeze({DRAG_START:"dragstart",DRAG_END:"dragend",NEW_VALUE:"newvalue",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_MOVE:"mousemove",CLICK:"click"}),orientation:null,wrapperEl:null,progressEl:null,completedEl:null,handleEl:null,snapbackDragEl:null,type:null,playerWrapperEl:null,setupPointerData:function(e){this.setupPointerDataDimensions(),this.pointerEventData.drag={start:{value:this.value,max:this.max},pointer:{x:e.pageX,y:e.pageY}}},setupPointerDataDimensions:function(){var e=this.progressEl;if(e&&this.max){var t=this.value/this.max,i=t*e.offsetWidth,o=t*e.offsetHeight;this.pointerEventData.dimensions={handleEl:{left:i,top:o,dimensions:n.getDimensions(this.handleEl)},wrapperEl:n.getDimensions(this.wrapperEl),playerWrapperEl:n.getDimensions(this.playerWrapperEl)}}},pointerDownHandler:function(e){this.wrapperEl.contains(e.target)&&(e.component=this,this.dragging||(this.setupPointerData(e),this.dragging=!0,this.pointerEventData.drag.current=this.determineEventValues(e,!1),this._updateSnapBackEl(this.pointerEventData.drag.current),this.fireEvent(this.knownEvents.MOUSE_ENTER,[e,this]),this.fireEvent(this.knownEvents.DRAG_START,[e,this])))},pointerMoveHandler:function(e){var t=!1;if(e.component=this,this.dragging){var n=this.pointerEventData.dimensions.wrapperEl,i=this.pointerEventData.dimensions.playerWrapperEl;this.isValidEventLocation(e)&&(Math.abs(e.pageY-this.pointerEventData.drag.pointer.y)>i.h*this.dragIncorrectDirectionPercentAllowed&&(t=!0),e.wrapperDimensions=n,this.pointerEventData.drag.current=this.determineEventValues(e,t),this._updateDOM(this.pointerEventData.drag.current))}else this.isValidPointerType(e)&&this.wrapperEl.contains(e.target)&&(this.pointerEventData&&this.pointerEventData.dimensions||this.setupPointerData(e),this.isValidEventLocation(e)&&(this.handleEl.contains(e.target)||this.handleEl.classList.remove(a),this.pointerEventData.drag.current=this.determineEventValues(e,t),this.fireEvent(this.knownEvents.MOUSE_MOVE,[e,this])))},pointerUpHandler:function(e){var t=e.pointerType;e.component=this,this.dragging?(this.dragging=!1,this.pointerEventData&&this.pointerEventData.dimensions||this.setupPointerData(e),e.wrapperDimensions=this.pointerEventData.dimensions.wrapperEl,e.haveHandleTargetted=this.handleEl.contains(e.target)&&t===r.mouse,this.fireEvent(this.knownEvents.DRAG_END,[e,this])):this.isValidPointerType(e)&&this.wrapperEl.contains(e.target)&&(this.pointerEventData&&this.pointerEventData.dimensions||this.setupPointerData(e),this.pointerEventData.drag.current=this.determineEventValues(e,!1),this.fireEvent(this.knownEvents.CLICK,[e,this]))},pointerEnterHandler:function(e){this.isValidPointerType(e)&&this.isValidEventLocation(e)&&(e.component=this,this.pointerEventData&&this.pointerEventData.dimensions||this.setupPointerData(e),this.pointerEventData.drag.current=this.determineEventValues(e,!1),this.fireEvent(this.knownEvents.MOUSE_ENTER,[e,this]))},pointerLeaveHandler:function(e){!this.dragging&&this.isValidPointerType(e)&&(e.component=this,this.handleEl.classList.remove(a),this.fireEvent(this.knownEvents.MOUSE_LEAVE,[e,this]))},mouseDownHandler:function(e){e.pointerType=r.mouse,this.pointerDownHandler(e)},mouseMoveHandler:function(e){
e.pointerType=r.mouse,this.pointerMoveHandler(e)},mouseUpHandler:function(e){e.pointerType=r.mouse,this.pointerUpHandler(e)},mouseOverHandler:function(e){this.wrapperEl.contains(e.relatedTarget)||(e.component=this,e.pointerType=r.mouse,this.pointerEventData&&this.pointerEventData.dimensions||this.setupPointerData(e),this.isValidEventLocation(e)&&(this.pointerEventData.drag.current=this.determineEventValues(e,!1),this.fireEvent(this.knownEvents.MOUSE_ENTER,[e,this])))},mouseOutHandler:function(e){this.dragging||this.wrapperEl.contains(e.relatedTarget)||(e.component=this,e.pointerType=r.mouse,this.handleEl.classList.remove(a),this.fireEvent(this.knownEvents.MOUSE_LEAVE,[e,this]))},isValidEventLocation:function(e){var t=this.pointerEventData&&this.pointerEventData.dimensions&&this.pointerEventData.dimensions.wrapperEl;return t?this.orientation==this.type.orientations.horizontal?e.pageX>=t.x&&e.pageX<=t.x+t.w:e.pageY>=t.y&&e.pageY<=t.y+t.h:!1},isValidPointerType:function(e){var t=e.pointerType;return t===r.touch||t===r.mouse||t===r.pen},determineEventValues:function(e,t){var i,o,r,s,a=e.wrapperDimensions||n.getDimensions(this.wrapperEl),l=!1;return this.orientation===this.type.orientations.horizontal?(t?(o=this.pointerEventData.dimensions.handleEl.left,i=this.pointerEventData.drag.start.value,l=!0):(o=e.pageX-a.x,s=Math.min(100,Math.max(0,o/a.w)),i=s*this.max),r=e.pageX):(t?(o=this.pointerEventData.dimensions.handleEl.bottom,i=this.max-this.pointerEventData.drag.start.value,l=!0):(o=this.max-(e.pageY-a.y),s=Math.min(100,Math.max(0,o/a.h)),i=s*this.max),r=e.pageY),{value:i,animate:l,relativePosition:o,absolutePosition:r,wrapperDimensions:a}},_updateSnapBackEl:function(e){e=e||{},this.value="undefined"!=typeof e.value?e.value:this.value,this.max=e.max||this.max;var t=this.value/this.max,n=100*t+"%",i=this.orientation===this.type.orientations.horizontal?"left":"bottom";this.snapbackDragEl.style[i]=n},_updateDOM:function(e){e=e||{},this.value="undefined"!=typeof e.value?e.value:this.value,this.max=e.max||this.max,this.buffer=e.buffer||this.buffer;var t=this.value/this.max,n=this.buffer/this.max,i=e.animate?"add":"remove",o=100*t+"%",r=100*(n-t)+"%",s=this;this.fireEvent(this.knownEvents.NEW_VALUE,[this]),this.handleEl.classList[i](u),this.completedEl.classList[i](u),window.setTimeout(function(){s.orientation===s.type.orientations.horizontal?(s.handleEl.style.left=o,s.completedEl.style.width=o,s.bufferedTimeEl.style.width=r):(s.handleEl.style.bottom=o,s.completedEl.style.height=o)},1)},update:function(e,t,n){this.dragging||this._updateDOM({value:e,max:t,buffer:n,animate:!1})},incrementScrubberPosition:function(e){var t,i,o=Math.min(this.max,Math.max(0,this.value+e)),r=o/this.max,s=n.getDimensions(this.wrapperEl);this.orientation===this.type.orientations.horizontal?(t=s.w*r,i=s.x+t):(t=s.h*r,i=s.y-(100-t)),this.pointerEventData||(this.pointerEventData={}),this.pointerEventData.drag||(this.pointerEventData.drag={}),this.pointerEventData.drag.current={value:o,animate:!1,relativePosition:t,absolutePosition:i,wrapperDimensions:s},this.update(o,this.max)},updatePercent:function(e){var t=e*this.max;window.requestAnimationFrame(function(){this._updateDOM({value:t})}.bind(this))},show:function(){this.wrapperEl.classList.add(l)},hide:function(){this.dragging||this.wrapperEl.classList.remove(l)},destroy:function(){this.initialized&&(this.initialized=!1,window.navigator.msPointerEnabled?(this.playerWrapperEl.removeEventListener("MSPointerDown",this.boundPointerDownHandler,!1),this.playerWrapperEl.removeEventListener("MSPointerMove",this.boundPointerMoveHandler,!1),this.playerWrapperEl.removeEventListener("MSPointerUp",this.boundPointerUpHandler,!1),this.wrapperEl.removeEventListener("MSPointerEnter",this.boundPointerEnterHandler,!1),this.wrapperEl.removeEventListener("MSPointerLeave",this.boundPointerLeaveHandler,!1)):(this.playerWrapperEl.removeEventListener("mousedown",this.boundMouseDownHandler,!1),this.playerWrapperEl.removeEventListener("mousemove",this.boundMouseMoveHandler,!1),this.playerWrapperEl.removeEventListener("mouseup",this.boundMouseUpHandler,!1),this.wrapperEl.removeEventListener("mouseover",this.boundMouseOverHandler,!1),this.wrapperEl.removeEventListener("mouseout",this.boundMouseOutHandler,!1)),o.removeEventListener(o.knownEvents.WINDOW_RESIZE,this.setupPointerDataDimensions),n.remove([this.handleEl,this.completedEl,this.progressEl,this.wrapperEl])),this._super()},init:function(e,r){this._super(e,r),this.type=t.ui.ScrubberComponent,this.pointerEventData=r&&r.pointerEventData||{},this.orientation=r&&r.orientation||this.type.orientations.horizontal,this.wrapperEl=n.create("div",{"class":"player-scrubber "+this.orientation.clazz,id:this.config.id||null}),this.progressEl=n.create("div",{"class":"player-scrubber-progress"}),this.completedEl=n.create("div",{"class":"player-scrubber-progress-completed"},this.progressEl),this.bufferedTimeEl=n.create("div",{"class":"player-scrubber-progress-buffered"},this.progressEl),this.wrapperEl.appendChild(this.progressEl),this.handleEl=n.create("button",{"class":"player-scrubber-target"},this.wrapperEl),this.indicatorEl=n.create("div",{"class":"player-scrubber-handle"},this.handleEl),this.snapbackDragEl=n.create("div",{"class":"trickplay-position trickplay-snapback"},this.progressEl),this.parentNode.appendChild(this.wrapperEl),this.playerWrapperEl=i.playerWrapper(),this.boundPointerDownHandler=this.pointerDownHandler.bind(this),this.boundPointerMoveHandler=this.pointerMoveHandler.bind(this),this.boundPointerUpHandler=this.pointerUpHandler.bind(this),this.boundPointerEnterHandler=this.pointerEnterHandler.bind(this),this.boundPointerLeaveHandler=this.pointerLeaveHandler.bind(this),this.boundMouseDownHandler=this.mouseDownHandler.bind(this),this.boundMouseMoveHandler=this.mouseMoveHandler.bind(this),this.boundMouseUpHandler=this.mouseUpHandler.bind(this),this.boundMouseOverHandler=this.mouseOverHandler.bind(this),this.boundMouseOutHandler=this.mouseOutHandler.bind(this),window.navigator.msPointerEnabled?(this.playerWrapperEl.addEventListener("MSPointerDown",this.boundPointerDownHandler,!1),this.playerWrapperEl.addEventListener("MSPointerMove",this.boundPointerMoveHandler,!1),this.playerWrapperEl.addEventListener("MSPointerUp",this.boundPointerUpHandler,!1),this.wrapperEl.addEventListener("MSPointerEnter",this.boundPointerEnterHandler,!1),this.wrapperEl.addEventListener("MSPointerLeave",this.boundPointerLeaveHandler,!1)):(this.playerWrapperEl.addEventListener("mousedown",this.boundMouseDownHandler,!1),this.playerWrapperEl.addEventListener("mousemove",this.boundMouseMoveHandler,!1),this.playerWrapperEl.addEventListener("mouseup",this.boundMouseUpHandler,!1),this.wrapperEl.addEventListener("mouseover",this.boundMouseOverHandler,!1),this.wrapperEl.addEventListener("mouseout",this.boundMouseOutHandler,!1)),o.addEventListener(o.knownEvents.WINDOW_RESIZE,this.setupPointerDataDimensions,this)}}),t.ui.ScrubberComponent.orientations=Object.freeze({horizontal:{id:1,clazz:"horizontal"},vertical:{id:2,clazz:"vertical"}})}(),function(){"use strict";var t=e.cadmium,n=t.UiEvents,i=t.element,o=i.classNames,r=o.visible,s=o.active,a=t.browser.pointerTypes,l=Rx.Observable,u=function(){},c=3e3;t.ui.MenuComponent=t.ui.Component.extend({openerEl:null,config:{id:"menu-component"},useMouseTriangleDetection:!1,menuMouseTriangle:null,hideMenuTimeout:null,hideMenuDelay:300,showEvent:"mouseover",mouseOverEvent:"menu-mouseover",menuEl:null,destroy:function(){this.initialized&&(this.initialized=!1,window.navigator.msPointerEnabled&&(document.removeEventListener("MSPointerMove",this.boundPointermoveHandler),this.menuEl.removeEventListener("MSPointerOut",this.boundPointeroutMenuHandler),this.menuEl.removeEventListener("MSPointerOver",this.boundPointeroverMenuHandler)),this.openerEl.removeEventListener(this.showEvent,this.boundMouseoverOpenerHandler),this.openerEl.removeEventListener("mouseout",this.boundMouseoutOpenerHandler),n.removeEventListener(n.knownEvents.SHOW_MENU,this.boundMenuShownHandler),document.removeEventListener("mousemove",this.boundMousemoveHandler),this.menuEl.removeEventListener("mouseout",this.boundMouseoutMenuHandler),this.menuEl.removeEventListener("mouseover",this.boundMouseoverMenuHandler),this.menuEl.removeEventListener("transitionend",this.boundFadeoutEndedHandler),i.remove(this.menuEl),this.menuMouseTriangle=null,this.menuEl=null),this._super()},init:function(e,t,o){this._super(e,o),this.openerEl=t,this.hideMenuDelay=o.hideMenuDelay||this.hideMenuDelay,this.showEvent=o.showEvent||this.showEvent,this.menuEl=i.create("div",{"class":"player-menu",id:this.config.id||null},this.parentNode),this.boundMouseoverOpenerHandler||(window.navigator.msPointerEnabled?(this.boundPointermoveHandler=this.pointermoveHandler.bind(this),this.boundPointeroutMenuHandler=this.pointeroutMenuHandler.bind(this),this.boundPointeroverMenuHandler=this.pointeroverMenuHandler.bind(this)):(this.boundMousemoveHandler=this.mousemoveHandler.bind(this),this.boundMouseoutMenuHandler=this.mouseoutMenuHandler.bind(this),this.boundMouseoverMenuHandler=this.mouseoverMenuHandler.bind(this)),this.boundMouseoverOpenerHandler=this.mouseoverOpenerHandler.bind(this),this.boundMouseoutOpenerHandler=this.mouseoutOpenerHandler.bind(this),this.boundMenuShownHandler=this.menuShownHandler.bind(this),this.boundFadeoutEndedHandler=this.fadeoutEndedHandler.bind(this),this.boundHide=this.hide.bind(this)),this.openerEl.addEventListener(this.showEvent,this.boundMouseoverOpenerHandler),this.openerEl.addEventListener("mouseout",this.boundMouseoutOpenerHandler),n.addEventListener(n.knownEvents.SHOW_MENU,this.boundMenuShownHandler)},update:function(e){this.initialized&&(e?this.show():this.hide())},show:function(){if(!this.isShowing()&&this.initialized){window.navigator.msPointerEnabled?document.addEventListener("MSPointerMove",this.boundPointermoveHandler):document.addEventListener("mousemove",this.boundMousemoveHandler),this.useMouseTriangleDetection=!1,window.clearTimeout(this.hideMenuTimeout),this.menuEl.classList.add(r),this.openerEl.classList.add(s);var e=this;window.setTimeout(function(){if(this.initialized){var t=i.getDimensions(e.menuEl),o=i.getDimensions(e.openerEl);n.fireEvent(n.knownEvents.SHOW_MENU,[e.config.id]),e.menuMouseTriangle={a:{x:o.x+o.w/2,y:o.y+o.h},b:{x:t.x,y:t.y+.95*t.h},c:{x:t.x+t.w,y:t.y+.95*t.h}},e.menuEl.classList.add(s),window.navigator.msPointerEnabled?(e.menuEl.addEventListener("MSPointerOut",e.boundPointeroutMenuHandler),e.menuEl.addEventListener("MSPointerOver",e.boundPointeroverMenuHandler)):(e.menuEl.addEventListener("mouseout",e.boundMouseoutMenuHandler),e.menuEl.addEventListener("mouseover",e.boundMouseoverMenuHandler))}}.bind(this),1)}},showTickler:function(){this.show(),n.fireEvent(n.knownEvents.FORCE_SHOW_MENU),l.timer(c).takeUntil(l.fromEvent(this,this.mouseOverEvent)).doAction(this.hide.bind(this),u,function(){n.fireEvent(n.knownEvents.REMOVE_FORCE_SHOW_MENU)}).subscribe()},hide:function(){this.isShowing()&&this.initialized&&(window.navigator.msPointerEnabled?(document.removeEventListener("MSPointerMove",this.boundPointermoveHandler),this.menuEl.removeEventListener("MSPointerOut",this.boundPointeroutMenuHandler),this.menuEl.removeEventListener("MSPointerOver",this.boundPointeroverMenuHandler)):(document.removeEventListener("mousemove",this.boundMousemoveHandler),this.menuEl.removeEventListener("mouseout",this.boundMouseoutMenuHandler),this.menuEl.removeEventListener("mouseover",this.boundMouseoverMenuHandler)),n.fireEvent(n.knownEvents.HIDE_MENU,[this.config.id]),this.menuEl.addEventListener("transitionend",this.boundFadeoutEndedHandler),this.menuEl.classList.remove(s),this.openerEl.classList.remove(s))},fadeoutEndedHandler:function(e){e.target===this.menuEl&&(e.stopPropagation(),this.menuEl.classList.contains(s)||this.menuEl.classList.remove(r),this.menuEl.removeEventListener("transitionend",this.boundFadeoutEndedHandler))},menuShownHandler:function(e){e!==this.config.id&&this.update(!1)},mousemoveHandler:function(e){this.useMouseTriangleDetection&&null!==this.menuMouseTriangle&&(i.isPointInTriangle({x:e.pageX,y:e.pageY},this.menuMouseTriangle.a,this.menuMouseTriangle.b,this.menuMouseTriangle.c)||this.hide())},pointermoveHandler:function(e){var t=e.pointerType;t!==a.mouse?(e.preventDefault(),this.menuEl.contains(e.target)||this.openerEl.contains(e.target)||this.update(!1)):this.mousemoveHandler(e)},mouseoverMenuHandler:function(){this.useMouseTriangleDetection=!1,this.fireEvent(this.mouseOverEvent),window.clearTimeout(this.hideMenuTimeout)},pointeroverMenuHandler:function(e){var t=e.pointerType;t!==a.mouse?e.preventDefault():(this.fireEvent(this.mouseOverEvent),this.mouseoverMenuHandler())},mouseoutMenuHandler:function(e){var t=e.relatedTarget;this.menuEl.contains(t)||this.openerEl.contains(t)||(this.hideMenuTimeout=window.setTimeout(this.boundHide,this.hideMenuDelay))},pointeroutMenuHandler:function(e){var t=e.pointerType;t!==a.mouse?e.preventDefault():this.mouseoutMenuHandler(e)},mouseoverOpenerHandler:function(){this.update(!0)},mouseoutOpenerHandler:function(e){this.openerEl.contains(e.relatedTarget)||(this.useMouseTriangleDetection=!0)},isShowing:function(){return this.menuEl.classList.contains(s)}})}(),function(){var t=e.cadmium,n=t.element,i=t.objects,o=t.UiEvents,r=t.keyboard,s=t.session,a=.1,l="icon-player-volume-";t.ui.VolumeMenuComponent=t.ui.MenuComponent.extend({id:null,wrapper:null,scrubber:null,volumeControlHeight:0,volumeTextNode:null,muted:!1,savedVolume:0,videoPlayer:null,disposed:null,normalize:function(e){var t=e/(this.volumeControlHeight||1);return.05>t?t=0:t>.97&&(t=1),t},updateVolumeDisplay:function(e){for(var t=parseInt(e),n=Math.min(Math.ceil(t/33),3),i=0;4>i;i++)this.parentNode.classList.remove(l+i);this.parentNode.classList.add(l+n)},volumeLevelChanged:function(e){var t=e.value,n=this.normalize(t);n!==this.getVolume()&&(this.setVolume(n),this.updateVolumeDisplay(100*n))},clickScrubberHandler:function(e,t){t.value=t.pointerEventData.drag.current.value,this.volumeLevelChanged(t),this.scrubber.updatePercent(this.getVolume())},setVolume:function(e){e!==this.getVolume()&&(this.videoPlayer.setVolume(e),this.muted=0===e,this.videoPlayer.setMuted(this.muted),s.setSessionData(s.SESSION_TYPES.VOLUME,{percentage:e,mute:this.muted}))},getVolume:function(){return this.videoPlayer.getVolume()},muteOn:function(){this.savedVolume=this.getVolume(),this.updateVolumeDisplay(0),this.scrubber.updatePercent(0),this.muted=!0,this.videoPlayer.setMuted(this.muted)},muteOff:function(){this.updateVolumeDisplay(100*this.savedVolume),this.scrubber.updatePercent(this.savedVolume),this.muted=!1,this.videoPlayer.setMuted(this.muted)},toggleMute:function(){this.scrubber.max?this.muted?this.muteOff():this.muteOn():(this.muted=!this.muted,this.videoPlayer.setMuted(this.muted),this.updateVolumeDisplay(this.muted?0:100*this.getVolume()))},adjustVolume:function(e){var t=.1>e?0:e>1?1:e;this.scrubber.max?this.scrubber.updatePercent(t):(this.setVolume(t),this.updateVolumeDisplay(100*t))},showHandler:function(e){e===this.id&&(this.volumeControlHeight=this.scrubber.wrapperEl.offsetHeight,this.scrubber.update(this.getVolume()*this.volumeControlHeight,this.volumeControlHeight))},keyHandler:function(e){var t=this.getVolume();this.adjustVolume(t+e)},addBehaviors:function(){function e(e,t,n){return Rx.Observable.fromEvent(e,t).takeUntil(l).doAction(n).subscribe(s,u,s)}var n=this.scrubber,i=n.knownEvents,s=t.util.NOOP,l=this.disposed,u=function(e){t.logging.log(e&&e.stack||e)};n.addEventListener(i.DRAG_END,this.clickScrubberHandler),l.onNext(function(){n.removeEventListener(i.DRAG_END,this.clickScrubberHandler)}.bind(this)),e(n,i.NEW_VALUE,this.volumeLevelChanged),e(o,o.knownEvents.SHOW_MENU,this.showHandler);var c=this;Rx.Observable.fromEvent(r,r.knownEvents.TOGGLE_MUTE).takeUntil(l).doAction(function(){c.toggleMute()}).subscribe(s,u,s),Rx.Observable.fromEvent(r,r.knownEvents.INCREASE_VOLUME).takeUntil(l).doAction(function(){c.keyHandler(a)}).subscribe(s,u,s),Rx.Observable.fromEvent(r,r.knownEvents.DECREASE_VOLUME).takeUntil(l).doAction(function(){c.keyHandler(-1*a)}).subscribe(s,u,s)},createContents:function(){this.wrapper=n.create("div",{"class":"volume-menu-content"}),this.scrubber=new t.ui.ScrubberComponent(this.wrapper,{orientation:t.ui.ScrubberComponent.orientations.vertical}),this.addBehaviors(),this.menuEl.appendChild(this.wrapper),setTimeout(function(){this.updateVolumeDisplay(100*this.getVolume())}.bind(this),1)},init:function(e,t,n){this._super(e,t,n),this.videoPlayer=i.videoPlayer(),this.muted=this.videoPlayer.getMuted(),this.id=n.id,this.disposed=new Rx.Subject,this.volumeLevelChanged=this.volumeLevelChanged.bind(this),this.clickScrubberHandler=this.clickScrubberHandler.bind(this),this.showHandler=this.showHandler.bind(this),this.keyHandler=this.keyHandler.bind(this);var o=s.getSessionData(s.SESSION_TYPES.VOLUME);if(o&&void 0!=o.percentage){var r=o.percentage;this.savedVolume=r,this.setVolume(r)}this.createContents()},destroy:function(){this.disposed&&this.disposed.onNext(),this.id=null,this.wrapper=null,this.scrubber=null,this.volumeTextNode=null,this.muted=null,this.videoPlayer=null,this.disposed=null,this.volumeLevelChanged=null,this.clickScrubberHandler=null,this.showHandler=null,this.keyHandler=null,this._super()}})}(),function(){"use strict";var t=e.cadmium,n=t.metadata,i=t.element;t.ui.NextEpisodeMenuComponent=t.ui.MenuComponent.extend({createContents:function(){var t,o=n.getNextEpisode(),r=e.I18n;o&&(this.menuHeaderEl=i.create("h1"),this.menuHeaderEl.textContent=r.get("ce-next-episode-header"),this.menuDataWrapperEl=i.create("div",{"class":"player-next-episode-info"}),t=n.getSmallestImage(o.stills),t&&t.w&&t.h&&t.url&&(this.menuNextEpisodeImageContainer=i.create("div",{"class":"image-container"}),this.menuNextEpisodeImage=i.create("img",{"class":"next-episode-image"},this.menuNextEpisodeImageContainer),this.menuNextEpisodeImage.setAttribute("data-img-src",t.url),this.menuNextEpisodeImage.style["margin-left"]=i.calcScaledScreenOffset(t,6),i.create("div",{"class":"play-icon"},this.menuNextEpisodeImageContainer),this.menuDataWrapperEl.appendChild(this.menuNextEpisodeImageContainer)),this.menuTextWrapperEl=i.create("div",{"class":"player-next-episode-description"}),this.menuTextHeaderEl=i.create("h2"),this.menuTextHeaderEl.textContent=r.getWithParams("ce-next-episode-title",["NUMBER","TITLE"],[o.seq,o.title]),this.menuTextEl=i.create("p"),this.menuTextEl.textContent=o.synopsis,this.menuTextWrapperEl.appendChild(this.menuTextHeaderEl),this.menuTextWrapperEl.appendChild(this.menuTextEl),this.menuDataWrapperEl.appendChild(this.menuTextWrapperEl),this.menuEl.appendChild(this.menuHeaderEl),this.menuEl.appendChild(this.menuDataWrapperEl))},show:function(){this.menuNextEpisodeImage.src||(this.menuNextEpisodeImage.src=this.menuNextEpisodeImage.getAttribute("data-img-src")),this._super()},init:function(e,t,n){this._super(e,t,n),this.createContents()}})}(),function(){var t,n,i,o=e.cadmium,r=o.metadata,s=o.element,a=null,l="change-video",u=function(e){e.target.classList.contains("episode-list-item--expanded")&&e.target.classList.add("episode-list-item--transition-ready"),e.target.removeEventListener("transitionend",u)},c=function(e){var o=e.target;if(n.contains(o))for(;n.contains(o);o=o.parentNode){if(o.classList.contains("episode-list-item--expanded")){var s=o.getAttribute("data-episode-id");return void(s!=r.getActiveVideo().id&&this.fireEvent(l,[{videoId:s}]))}if(o.classList.contains("episode-list-item")){var a=document.getElementsByClassName("episode-list-item--expanded")[0];return a&&d(a),void m(o,!0)}if(o.classList.contains("back-to-seasons"))return void t.classList.remove("show-episode-list")}else if(i.contains(o))for(;i.contains(o);o=o.parentNode)if(o.classList.contains("season"))return this.createEpisodeListPanel(o.getAttribute("data-season-id")),void t.classList.add("show-episode-list")},d=function(e){e.classList.remove("episode-list-item--expanded"),e.classList.remove("episode-list-item--transition-ready"),e.style.height=""},m=function(e,t){t?(e.addEventListener("transitionend",u),e.classList.add("episode-list-item--expanded"),e.style.height=e.getAttribute("data-expanded-height")):(e.classList.add("episode-list-item--no-transition"),e.classList.add("episode-list-item--expanded"),e.style.height=e.getAttribute("data-expanded-height"),setTimeout(function(){e.classList.remove("episode-list-item--no-transition")},1));var n=e.getElementsByClassName("episode-list-image")[0];n.src||(n.src=n.getAttribute("data-img-src"))};o.ui.EpisodeSelectorMenuComponent=o.ui.MenuComponent.extend({createSeasonPanel:function(){var e=r.getMetadata();i=s.create("div",{"class":"season-list-container"},t);var n=s.create("h2",{"class":"seasons-title"},i);n.textContent=e.video.title;for(var o=s.create("ul",{"class":"season-list"},i),a=0;a<e.video.seasons.length;a++){var l=s.create("li",{"class":"season icon-player-forward-arrow"},o),u=e.video.seasons[a],c=s.create("span",null,l);c.textContent=u.title,l.setAttribute("data-season-id",u.id)}},createEpisodeListPanel:function(e){for(var i,o,l,u,c=0;c<a.video.seasons.length;c++)a.video.seasons[c].id==e&&(o=a.video.seasons[c]);l=r.getActiveSeason().id==e?r.getActiveVideo().id:o.episodes[0].id,o||(o=r.getActiveSeason()),n&&n.parentNode.removeChild(n),n=s.create("div",{"class":"episode-list-container"});var d=s.create("div",{"class":"episode-list-header"},n);if(a.video.seasons.length>1){var p=s.create("div",{"class":"back-to-seasons-container"},d);s.create("button",{"class":"back-to-seasons icon-player-back-arrow"},p)}i=s.create("h2",{"class":"seasons-title"},d),i.textContent=o.title;for(var h=s.create("ul",{"class":"episode-list"},n),c=0;c<o.episodes.length;c++){var v=o.episodes[c],E=s.create("li",{"class":"episode-list-item"},h);E.setAttribute("data-episode-id",v.id);var f=s.create("div",{"class":"episode-list-item-header"},E),g=s.create("span",{"class":"episode-list-index"},f);g.innerHTML=c+1;var _=s.create("h3",{"class":"episode-list-title"},f);_.innerHTML=v.title;var b=s.create("progress",{"class":"episode-list-progress"},f);b.max="100",v.bookmark&&v.bookmark.offset>=0&&v.runtime>0?b.value=v.bookmark.offset/v.runtime*100:b.value=0,s.create("span",{"class":"episode-list-down-arrow icon-player-down-arrow"},f);var y=s.create("div",{"class":"episode-list-description-container"},E),w=s.create("div",{"class":"episode-list-image-container"},y),k=s.create("img",{"class":"episode-list-image"},w),T=r.getSmallestImage(v.stills);T&&(k.setAttribute("data-img-src",T.url),k.style["margin-left"]=s.calcScaledScreenOffset(T,6)),v.id!==r.getActiveVideo().id&&s.create("div",{"class":"play-icon"},w);var x=s.create("p",{"class":"episode-list-synopsis"},y);x.innerHTML=v.synopsis}t.appendChild(n);var L=this.menuEl.classList.contains(s.classNames.visible);L||this.menuEl.classList.add(s.classNames.visible);for(var A=n.getElementsByClassName("episode-list-item"),c=0;c<A.length;c++){var P=A[c],I=P.cloneNode(!0);if(I.classList.add("episode-list-item--copied"),P.parentNode.appendChild(I),!u){var O=s.create("div",{"class":"measuring-stick"},I);u=O.clientWidth/1e3}var C=s.getDimensions(I).h/u-1;P.setAttribute("data-expanded-height",C+"em"),P.parentNode.removeChild(I),P.getAttribute("data-episode-id")==l&&(m(P,!1),P.parentElement.scrollTop=P.offsetTop-P.parentElement.offsetTop)}L||this.menuEl.classList.remove(s.classNames.visible)},createContents:function(e){var n=s.create("div",{"class":"episode-selector-container"},this.menuEl);t=s.create("div",{"class":"episode-selector-slider show-episode-list"},n),this.scopedClickHandler=c.bind(this),t.addEventListener("click",this.scopedClickHandler),this.createSeasonPanel(),this.createEpisodeListPanel(e)},init:function(e,t,n){this._super(e,t,n),a||(a=r.getMetadata()),this.createContents(r.getActiveSeason().id)},destroy:function(){a=null,t.removeEventListener("click",this.scopedClickHandler),this._super()},CHANGE_VIDEO_EVENT:l})}(),function(){"use strict";var t=e.cadmium,n=t.objects,i=t.element,o=t.logging,r=t.util.NOOP,s="none",a="data-id",l="data-commentary",u=i.classNames.visible,c="5.1";t.ui.AudioSubtitleMenuComponent=t.ui.MenuComponent.extend({audioListEl:null,audioHeaderEl:null,audioItemsEls:{},textListEl:null,textHeaderEl:null,textItemsEls:{},videoPlayer:null,allowAudioTrackModification:!1,allowTextTrackModifications:!1,clickHandler:function(e){var t,n,i=e.target,o=i.getAttribute(a);this.useMouseTriangleDetection=!0,this.audioListEl.contains(i)?(t=this.audioItemsEls[o],n=t&&t.track,t&&this.videoPlayer.setAudioTrack(n)):this.textListEl.contains(i)&&(o===s?(this.videoPlayer.setTimedTextTrack(null),n=null):(t=this.textItemsEls[o],t&&(n=t.track,this.videoPlayer.setTimedTextTrack(n))))},_updateAudioListDOM:function(){var t,n,o,r,s,d,m,p=this.videoPlayer.getAudioTrackList(),h=this.videoPlayer.getAudioTrack(),v=this;if(p){for(t in this.audioItemsEls)this.audioItemsEls.hasOwnProperty(t)&&(t=this.audioItemsEls[t],i.remove(t.el));v.audioItemsEls={},p.forEach(function(t){t&&(o=t.trackId,n=i.create("li",{"class":h&&h.trackId===o?"player-track-selected":null},v.audioListEl),n.setAttribute(a,o),d=t.channels||"",m=d.indexOf(c)>=0?"dolby-digital":"","COMMENTARY"==t.trackType?(s=t.displayName.split(" - "),r="",2==s.length?(r=e.I18n.get("ce-audio-tracks-commentator-title"),r=r.replace("{LANGUAGE}",s[0]),r=r.replace("{COMMENTATOR}",s[1])):r=t.displayName,n.setAttribute(l,"true"),n.appendChild(document.createTextNode(r))):(r=m?e.I18n.getWithParams(m,["LANG"],[t.displayName]):t.displayName,n.appendChild(document.createTextNode(r))),v.audioItemsEls[o]={el:n,track:t})}),this.audioListEl.classList.add(u),this.allowAudioTrackModification=p.length>1}else this.audioListEl.classList.remove(u),this.allowAudioTrackModification=!1},_updateTextListDOM:function(){var t,n,o,r,l=this.videoPlayer.getTimedTextTrackList(),c=this.videoPlayer.getTimedTextTrack(),d=!1,m=e.I18n,p=this;if(l&&l.length>0){for(t in this.textItemsEls)this.textItemsEls.hasOwnProperty(t)&&(t=this.textItemsEls[t],i.remove(t.el));p.textItemsEls={},l.forEach(function(e){e?(d=c&&c.trackId===e.trackId,o=e.trackId,r=e.displayName+("ASSISTIVE"===e.trackType?" [CC]":"")):(e=s,d=!c,o=e,r=m.get("ce-none-track")),n=i.create("li",{"class":d?"player-track-selected":null},p.textListEl),n.setAttribute(a,o),n.appendChild(document.createTextNode(r)),p.textItemsEls[o]={el:n,track:e}}),this.textListEl.classList.add(u),this.allowTextTrackModifications=l.length>1}else this.textListEl.classList.remove(u),this.allowTextTrackModifications=!1},createContents:function(){this.videoPlayer=n.videoPlayer();var t=e.I18n;this.audioListEl=i.create("ol",{"class":"player-audio-tracks"}),this.audioHeaderEl=i.create("lh",{},this.audioListEl),this.audioHeaderEl.appendChild(document.createTextNode(t.get("ce-audio-tracks-title"))),this._updateAudioListDOM(),this.menuEl.appendChild(this.audioListEl),this.textListEl=i.create("ol",{"class":"player-timed-text-tracks"}),this.textHeaderEl=i.create("lh",{},this.textListEl),this.textHeaderEl.appendChild(document.createTextNode(t.get("ce-text-tracks-title"))),this._updateTextListDOM(),this.menuEl.appendChild(this.textListEl)},audioTrackListChangedHandler:function(){this._updateAudioListDOM()},audioTrackChangedHandler:function(){this._updateAudioListDOM()},textTrackListChangedHandler:function(){this._updateTextListDOM()},textTrackChangedHandler:function(){this._updateTextListDOM()},attachListeners:function(){function e(e,i,o){Rx.Observable.fromEvent(e,i).takeUntil(t).doAction(o).subscribe(r,n,r)}o.log("initializing component.audio.subtitle.menu");var t=this._disposed,n=function(e){o.error(e&&e.stack||e)};e(this.menuEl,"click",this.clickHandler),e(this.videoPlayer,"audiotracklistchanged",this.audioTrackListChangedHandler),e(this.videoPlayer,"audiotrackchanged",this.audioTrackChangedHandler),e(this.videoPlayer,"timedtexttracklistchanged",this.textTrackListChangedHandler),e(this.videoPlayer,"timedtexttrackchanged",this.textTrackChangedHandler)},init:function(e,t,n){this._super(e,t,n),this.clickHandler=this.clickHandler.bind(this),this.audioTrackListChangedHandler=this.audioTrackListChangedHandler.bind(this),this.audioTrackChangedHandler=this.audioTrackChangedHandler.bind(this),this.textTrackListChangedHandler=this.textTrackListChangedHandler.bind(this),this.textTrackChangedHandler=this.textTrackChangedHandler.bind(this),this._disposed=new Rx.Subject,this.createContents(),this.attachListeners()},destroy:function(){this._disposed&&this._disposed.onNext(),this.audioListEl=null,this.audioHeaderEl=null,this.audioItemsEls={},this.textListEl=null,this.textHeaderEl=null,this.textItemsEls={},this.videoPlayer=null,this._super()}})}(),function(){var t,n,i=e.cadmium,o=i.objects,r=Rx.Observable,s=i.element,a=i.UiEvents,l="data-ip",u=!1,c="mdxTicklerShowCount",d=3e3,m=i.util.NOOP;i.ui.MdxMenuComponent=i.ui.MenuComponent.extend({mdxListEl:null,mdxHeaderEl:null,mdxItemsEls:{},videoPlayer:null,allowMdxTrackModification:!1,allowTextTrackModifications:!1,clickHandler:function(e){var t=e.target.getAttribute(l);i.ui.master.toggleMdxMode(!0,t)},_mdxLoadedHandler:function(){t=o.mdxManager();var e=Number(window.localStorage.getItem(c));3>e?(window.localStorage.setItem(c,e+1),u=!0,this._updateMdxListDOM()):r.timer(d).take(1).subscribe(function(){u=!0},m,m);var i=this;r.fromEvent(t,t.EVENTS.devicefound).takeUntil(n).doAction(this._updateMdxListDOM.bind(i),m,m).subscribe(),a.removeEventListener(a.knownEvents.MDX_LOADED,this._mdxLoadedHandler,this)},_updateMdxListDOM:function(){if(t){for(var n,i=t.getTargetList(),o=this;this.mdxListEl.firstChild;)this.mdxListEl.removeChild(this.mdxListEl.firstChild);if(this.mdxListEl.appendChild(this.mdxHeaderEl),e.cadmium.util.isEmptyObject(i))this.hide();else{var r,a=null;for(r in i)a=i[r],a&&a._config&&(n=s.create("li",null,o.mdxListEl),n.setAttribute(l,r),n.appendChild(document.createTextNode(a._config.friendlyName)));u&&this.showTickler()}}},createContents:function(){this.videoPlayer=o.videoPlayer(),this.mdxListEl=s.create("ol",{"class":"player-mdx-list"}),this.mdxHeaderEl=s.create("lh",{},this.mdxListEl),this.mdxHeaderEl.appendChild(document.createTextNode(e.I18n.get("mdx-play-on"))),t=o.mdxManager(),this._updateMdxListDOM(),this.menuEl.appendChild(this.mdxListEl)},attachListeners:function(){this.boundClickHandler||(this.boundClickHandler=this.clickHandler.bind(this)),this.menuEl.addEventListener("click",this.boundClickHandler,!1)},init:function(e,t,i){this._super(e,t,i),this.createContents(),this.attachListeners(),n=new Rx.Subject,o.mdxManager()?this._mdxLoadedHandler():a.addEventListener(a.knownEvents.MDX_LOADED,this._mdxLoadedHandler,this)},destroy:function(){this.menuEl.removeEventListener("click",this.boundClickHandler,!1),a.removeEventListener(a.knownEvents.MDX_LOADED,this._mdxLoadedHandler,this),t&&t.removeEventListener(t.EVENTS.devicefound,this._updateMdxListDOM,this),n.onNext(),this._super()}})}(),function(){var t=e.cadmium,n=t.element;t.ui.Button=t.ui.Component.extend({knownEvents:Object.freeze({CLICK:"click"}),buttonEl:null,focus:function(){this.buttonEl.focus()},blur:function(){this.buttonEl.blur()},clickHandler:function(e){this.fireEvent(this.knownEvents.CLICK,[e,this])},destroy:function(){this.initialized&&(this.initialized=!1,this.buttonEl.removeEventListener("click",this.boundClickHandler),n.remove(this.buttonEl),this.buttonEl=null)},init:function(e,t){this._super(e,t),this.buttonEl=n.create("button",{"class":["button",this.config["class"]||""].join(" "),id:this.config.id||null},this.parentNode),this.buttonEl.setAttribute("type","button"),this.buttonEl.appendChild(this.config.contentsEl),this.boundClickHandler||(this.boundClickHandler=this.clickHandler.bind(this)),this.buttonEl.addEventListener("click",this.boundClickHandler)}}),Object.defineProperty(t.ui.Button.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=!!e,this.buttonEl.classList[this._enabled?"remove":"add"]("disabled");
}})}(),function(){"use strict";var t=e.cadmium,n=t.element;t.ui.LoaderProgress=t.ui.Component.extend({_loader:null,rootEl:null,_onLoadStart:function(){this._loader.removeEventListener(this._loader.knownEvents.START_LOAD,this._onLoadStart),this.parentNode.appendChild(this.rootEl),setTimeout(function(){this.initialized&&this._spinnerEl.classList.add(n.classNames.visible)}.bind(this),100)},init:function(e){this._super(e.rootEl,{}),this._loader=e,this.rootEl=n.create("div"),this._spinnerEl=n.create("div",{"class":"player-progress-loading"},this.rootEl),this._onLoadStart=this._onLoadStart.bind(this),this._loader.addEventListener(this._loader.knownEvents.START_LOAD,this._onLoadStart)},destroy:function(){this.initialized&&(this.initialized=!1,n.remove(this.rootEl),this._loader&&this._loader.removeEventListener(this._loader.knownEvents.START_LOAD,this._onLoadStart),this._loader=null,this._spinnerEl=null,this.rootEl=null,this.parentNode=null)}}),t.ui.LoaderProgress.create=function(e){return new t.ui.LoaderProgress(e)}}(),function(){"use strict";var t=e.cadmium,n=t.element,i=t.browser,o=t.metadata,r=n.classNames.visible,s="with-logo",a=3,l=2,u=2,c=t.ui.LoaderMetadata=t.ui.Component.extend({_backgroundImageEl:null,_backgroundGradientEl:null,_headerEl:null,_descriptionEl:null,_loader:null,rootEl:null,_metadataReadyHandler:function(){this._loader.removeEventListener(this._loader.knownEvents.METADATA_READY,this._metadataReadyHandler),this._attemptPopulateDescription()},_attemptPopulateDescription:function(){var e=o.getActiveVideo(),t=e&&o.getLargestImage(e.stills);t?(this._backgroundImageEl.addEventListener("load",this._populateDescription),this._backgroundImageEl.addEventListener("error",this._populateDescription),this._backgroundImageEl.src=t.url):this._populateDescription()},_populateDescription:function(){var t,s,c=this,d=o.getMetadata(),m=o.getActiveVideo(),p=o.isShowData(d),h=n.create("h1",{},this._descriptionEl);h.innerHTML=d.video.title,this._backgroundImageEl&&(this._backgroundImageEl.removeEventListener("load",this._populateDescription),this._backgroundImageEl.removeEventListener("error",this._populateDescription),this._backgroundGradientEl.style.backgroundImage=i.prefix().css+"linear-gradient(top, rgba(0,0,0,.2), rgba(0,0,0,.65)), url("+this._backgroundImageEl.src+")"),p&&(t=o.getActiveSeason(),t&&(s=n.create("h2",{},this._descriptionEl),s.innerHTML=e.I18n.getWithParams("ce-loading-show-title",["SEASON","EPISODE","TITLE"],[t.seq,m.seq,m.title]))),this.parentNode.appendChild(this.rootEl),requestAnimationFrame(function(){c.initialized&&(c._headerEl.classList.add(r),c._backgroundGradientEl.classList.add(r),p?(n.limitLinesOfText(h,{maxLines:l}),n.limitLinesOfText(s,{maxLines:u})):n.limitLinesOfText(h,{maxLines:a}))})},init:function(e,t){t=t||{},this._super(e.rootEl,t),this._loader=e;var i=t.initParams||{};this._populateDescription=this._populateDescription.bind(this),this._metadataReadyHandler=this._metadataReadyHandler.bind(this),this.rootEl=n.create("div"),this._backgroundImageEl=n.create("img"),this._headerEl=n.create("div",{"class":"header-container"},this.rootEl),i.referrerIsNetflix||(n.create("div",{"class":"logo"},this._headerEl),this._headerEl.classList.add(s)),this._backgroundGradientEl=n.create("div",{"class":"player-loading-background"},this.rootEl),this._descriptionEl=n.create("div",{"class":"description"},this._headerEl),this._loader.addEventListener(this._loader.knownEvents.METADATA_READY,this._metadataReadyHandler)},destroy:function(){this.initialized&&(n.remove(this.rootEl),this.rootEl=null,this._backgroundImageEl&&(this._backgroundImageEl.removeEventListener("load",this._populateDescription),this._backgroundImageEl.removeEventListener("error",this._populateDescription)),this._backgroundImageEl=null,this.parentNode=null,this._backgroundGradientEl=null,this._headerEl=null,this._descriptionEl=null,this._loader&&this._loader.removeEventListener(this._loader.knownEvents.METADATA_READY,this._metadataReadyHandler),this._loader=null,t.ui.Component.prototype.destroy.call(this))}});c.create=function(e,t){return new c(e,t)}}(),function(){"use strict";var t=e.cadmium,n=t.element,i=t.ui.LoaderProgress,o=n.classNames.visible;t.ui.LoaderProgressPrePlay=i.extend({_logoEl:null,_lightingEl:null,_shadowEl:null,_onLoadStart:function(){this._loader.removeEventListener(this._loader.knownEvents.START_LOAD,this._onLoadStart),this.parentNode.appendChild(this.rootEl),setTimeout(function(){this.rootEl.classList.add(o)}.bind(this),1)},init:function(e){this._super(e),this.rootEl.classList.add("preplay-loader-container"),this._logoEl=n.create("div",{id:"logo"},this.rootEl),this._lightingEl=n.create("div",{id:"light"},this.rootEl),this._shadowEl=n.create("div",{id:"shadow"},this.rootEl)},destroy:function(){i.prototype.destroy.call(this),this._logoEl=null,this._lightingEl=null,this._shadowEl=null}}),t.ui.LoaderProgressPrePlay.create=function(e){return new t.ui.LoaderProgressPrePlay(e)}}(),function(){var t,n,i,o,r,s,a,l,u,c=e.cadmium,d=c.UiEvents,m=c.element,p=c.objects,h=c.xhr,v=c.Logger.create("component.incognito"),E=0,f=c.util.NOOP,g=function(){s={"private":{menuTitle:e.I18n.get("ce-incognito-private-menu"),menuOptions:[{text:e.I18n.get("ce-incognito-private-on"),incognito:!0},{text:e.I18n.get("ce-incognito-private-off"),incognito:!1}]},anonymous:{menuTitle:e.I18n.get("ce-incognito-anonymous-menu"),menuOptions:[{text:e.I18n.get("ce-incognito-anonymous-on"),incognito:!0},{text:e.I18n.get("ce-incognito-anonymous-off"),incognito:!1}]},history:{menuTitle:e.I18n.get("ce-incognito-history-menu"),menuOptions:[{text:e.I18n.get("ce-incognito-history-save"),incognito:!1},{text:e.I18n.get("ce-incognito-history-hide"),incognito:!0}]},sauron:{menuTitle:e.I18n.get("ce-incognito-private-menu"),menuOptions:[{text:e.I18n.get("ce-incognito-private-on"),incognito:!0},{text:e.I18n.get("ce-incognito-private-off"),incognito:!1}]}}},_={DATA_IS_INCOGNITO:"data-is-incognito",SELECTED_CLASS:"incognito-mode-selected",INCOGNITO_API_URL:"/incognito",MAX_ERROR_COUNT:2,RETRY_BACKOFF:500,API_TIMEOUT:3e3},b=function(t){var i={method:t.method,xid:p.videoPlayer().getXid(),videoId:p.videoId()};"test"===e.cadmium.objects.initParams().environment&&(i.revision="latest"),void 0!=t.isIncognito&&(i.on=t.isIncognito,i.seq=E++),u=!0,r.classList.add("loading"),h.get(n,{data:i}).takeUntil(a).timeout(_.API_TIMEOUT).retryWithBackoff(_.MAX_ERROR_COUNT,_.RETRY_BACKOFF).flatMap(function(e){return"success"===e.result?Rx.Observable["return"](e):Rx.Observable["throw"](new Error)}).doAction(y).subscribe(f,w)},y=function(e){l=e.isIncognito,d.fireEvent(d.knownEvents.INCOGNITO_CHANGED,[e]),u=!1,r.classList.remove("loading"),T()},w=function(){u=!1,r.classList.remove("loading"),v.getErrorHandler("request error"),c.ui.popup.showGenericError(e.I18n.get("ce-incognito-api-error-title"),e.I18n.get("ce-incognito-api-error-text"))},k=function(e){var n=e.target;if(t.contains(n))for(;t.contains(n);n=n.parentNode)n.classList.contains("incognito-option")&&String(l)!==n.getAttribute(_.DATA_IS_INCOGNITO)&&b({method:"toggle",isIncognito:!l})},T=function(){for(var e=t.getElementsByClassName("incognito-option"),n=0;n<e.length;n++){var i=e[n];String(l)===i.getAttribute("data-is-incognito")?i.classList.add(_.SELECTED_CLASS):i.classList.remove(_.SELECTED_CLASS)}};c.ui.IncognitoMenuComponent=c.ui.MenuComponent.extend({createContents:function(){var e=p.initParams().incognitoConfig.mode;t=m.create("ul",{"class":"incognito-options"});var o=m.create("lh",{"class":"incognito-title"},t);o.appendChild(document.createTextNode(s[e].menuTitle));for(var l=s[e].menuOptions,c=0;c<l.length;c++){var d=m.create("li",{"class":"incognito-option"});d.appendChild(document.createTextNode(l[c].text)),d.setAttribute(_.DATA_IS_INCOGNITO,l[c].incognito),l[c].incognito===!1&&d.classList.add(_.SELECTED_CLASS),t.appendChild(d)}this.menuEl.appendChild(t),r=this.menuEl,Rx.Observable.fromEvent(this.menuEl,"click").takeUntil(a).filter(function(){return!u}).doAction(k).subscribe(f,function(){v.getErrorHandler("request error")}),n=p.initParams().apiUrl+_.INCOGNITO_API_URL,i=p.videoPlayer().getXid()},destroy:function(){a.onNext(),this._super()},init:function(e,t,n){this._super(e,t,n),d=c.UiEvents,o=e,a=new Rx.Subject,l=!1,u=!1,g(),this.createContents()},sendIncognitoReq:b,toggleIncognito:function(){b({method:"toggle",isIncognito:!l})},isLoading:function(){return u}})}(),function(){var t=e.cadmium,n=t.element,i=t.logging,o=t.util.NOOP,r="&#9679",s=13;t.ui.PIN=t.ui.Component.extend({knownEvents:Object.freeze({COMPLETE:"complete",INPUT:"input",ENTER:"enter"}),containerEl:null,pinEl:null,caretEl:null,pinCells:null,_type:null,_caretOffset:null,_fontSize:null,_caretIncrement:null,_initElements:function(){this.containerEl=n.create("div",{"class":"pin-container",id:this.config.id||null}),this.pinEl=n.create("input",{"class":["pin-input",this.config.inputClass||"","type-"+this._type].join(" ")},this.containerEl),this.pinEl.setAttribute("maxlength",this._pinLength),this.caretEl=n.create("div",{"class":"pin-caret"},this.containerEl);for(var e,t,i=0;i<this._pinLength;i++)e=n.create("div",{"class":"pin-ui"},this.containerEl),t=n.create("span",{},e),this.pinCells.push(t)},_initHandlers:function(){var e=Rx.Observable.fromEvent(this.pinEl,"keyup"),t=Rx.Observable.fromEvent(this.pinEl,"change"),n=Rx.Observable.fromEvent(this.pinEl,"focus"),i=Rx.Observable.fromEvent(this.containerEl,"click");e.merge(t).takeUntil(this._disposed).map(function(e){return e.preventDefault(),e.stopPropagation(),e.keyCode===s&&this.fireEvent(this.knownEvents.ENTER),this.getValue()}.bind(this)).distinctUntilChanged().doAction(this._inputChangeHandler).subscribe(o,this._rxErrorHandler,o),n.merge(i).takeUntil(this._disposed).doAction(this._clickAndFocusHandler).subscribe(o,this._rxErrorHandler,o)},_updateComputedValues:function(){this._caretOffset=this._caretOffset||parseInt(getComputedStyle(this.caretEl).left),this._fontSize=this._fontSize||parseInt(getComputedStyle(this.pinEl).fontSize),this._caretIncrement=this._caretIncrement||parseInt(getComputedStyle(this.containerEl.querySelector(".pin-ui")).width)},_inputChangeHandler:function(){var e,t=this.pinEl.value,n=t.length,i="password"===this._type;e=n===this._pinLength?this._caretOffset+(n-1)*this._caretIncrement+this._fontSize:this._caretOffset+n*this._caretIncrement,this.caretEl.style.cssText="left: "+e+"px;",this.pinCells.forEach(function(e,n){var o=t.charAt(n);o?e.innerHTML=i?r:o:e.innerHTML=""}),t&&n===this._pinLength?(this.caretEl.classList.add("hide"),this.fireEvent(this.knownEvents.COMPLETE,[t])):(this.caretEl.classList.remove("hide"),this.fireEvent(this.knownEvents.INPUT,[t]))},_clickAndFocusHandler:function(e){e.preventDefault(),this._updateComputedValues(),this.focus(),this.pinEl.value=this.pinEl.value},_rxErrorHandler:function(e){i.log("component.pin.input",e&&e.stack||e)},focus:function(){return this.pinEl.focus(),this},blur:function(){return this.pinEl&&this.pinEl.blur(),this},clear:function(){return this.pinEl.value="",this._inputChangeHandler(),this},getValue:function(){return this.pinEl&&this.pinEl.value},destroy:function(){this.initialized&&(this.initialized=!1,this._disposed.onNext(),n.remove(this.containerEl),this.containerEl=null,this.pinCells=null,this.events=null,this._disposed=null)},init:function(e,t){t=t||{},this._super(e,t),this._disposed=new Rx.Subject,this._pinLength=t.pinLength||4,this._type=t.type||"password",this.pinCells=[],this._inputChangeHandler=this._inputChangeHandler.bind(this),this._clickAndFocusHandler=this._clickAndFocusHandler.bind(this),this._initElements(),this._initHandlers(),e.appendChild(this.containerEl)}})}(),function(){"use strict";var t,n,i,o=e.cadmium,r=e.I18n,s=o.metadata,a=o.dom,l=o.xhr,u=o.logging,c=Rx.Observable,d=a.DIV,m=function(){},p=function(e){u.error("error:"+e.stack)},h=function(){this.menuEl.removeChild(t),t=null,this.menuEl.appendChild(d({"class":"completed"},r.get("ce-dontshare-unshared"))),s.setMetadataField("video.social.facebook.do_not_share.enabled",!1)},v=function(e){var t=s.getMetadata().social.netflix.user.id,o=n.replace("TITLE_ID",s.getActiveVideo().id).replace("USER_ID",t),r={withCredentials:!0};l.post(o,r).takeUntil(i).doAction(h.bind(this)).retryWithBackoff(5,1e3).subscribe(m,p,m)},E=function(){t=d({"class":"dont-share-button"},r.get("ce-dontshare-prompt")),i=new Rx.Subject,c.fromEvent(t,"click").takeUntil(i).take(1).doAction(v.bind(this)).subscribe(m,p,m),this.menuEl.appendChild(t)};o.ui.DontShareMenuComponent=o.ui.MenuComponent.extend({init:function(e,t,i){this._super(e,t,i),n=o.objects.initParams().apiUrl+"users/USER_ID/social/titles/TITLE_ID?output=json",E.bind(this)()},destroy:function(){i.onNext(),this._super()}})}(),function(){var t,n,i,o,r=e.cadmium,s=17,a=r.ui.ExitPlaybackComponent=r.ui.Component.extend({_backToBrowsingEl:null,_rootEl:null,_render:function(){null===this._backToBrowsingEl&&(this._backToBrowsingEl=o({"class":"player-exit-playback icon-player-cancel no-select"}))},destroy:function(){this.initialized&&this._backToBrowsingEl&&(this._backToBrowsingEl.removeEventListener("click",r.ui.master.goBackToBrowsing,!1),t.remove(this._backToBrowsingEl),this._backToBrowsingEl=null),this._super()},init:function(e){this._super(e.rootEl),this._rootEl=e.rootEl,this._initialized=!0,t=r.element,n=r.objects,i=r.dom,o=i.A;var a=this;n.initParams().inPagePlayer||(this._render(),setTimeout(function(){a.initialized&&(a._rootEl.appendChild(a._backToBrowsingEl),a._backToBrowsingEl.addEventListener("click",r.ui.master.goBackToBrowsing,!1))},s))},getBackToBrowsingEl:function(){return this._backToBrowsingEl}});a.create=function(e,t){return new a(e,t)}}(),function(){"use strict";var t=e.cadmium,n=t.util,i=t.objects,o=t.dom.DIV,r=t.dom.get("H2"),s=t.element,a=t.Logger.create("cadmium.ui.VideoInterstitialComponent"),l="webkit"===t.browser.prefix().lowercase,u=500,c=t.util.NOOP,d=Rx.Observable,m=t.ui.VideoInterstitialComponent=t.ui.Component.extend({_rootEl:null,_videoPlayerWrapperEl:null,_videoTitleEl:null,_videoPlayer:null,_videoDuration:null,_videoCurrentTime:null,_autoPlayTimer:null,_disposed:new Rx.Subject,videoEvents:{INTERSTITIAL_VIDEO_END:"interstitialVideoEnd",INTERSTITIAL_VIDEO_START:"interstitialVideoStart"},_render:function(){null===this._rootEl&&(this._rootEl=o({"class":"player-video-interstitial",style:"background-image: url("+this.config.background+");"},this._videoPlayerWrapperEl=o({"class":"player-video-interstitial-wrapper"}),this._videoTitleEl=this.config.title&&r({"class":"player-video-interstitial-title"},this.config.title)))},_createEventSubscriptions:function(){this.initialized&&(d.fromEvent(this._videoPlayer,"loaded").takeUntil(this._disposed).doAction(function(){this.fireEvent(this.videoEvents.INTERSTITIAL_VIDEO_START),this._videoPlayerWrapperEl.style.display="",this._videoDuration=this._videoPlayer.getDuration(),this._addChangeListeners()}.bind(this)).subscribe(c,a.getErrorHandler("event|loaded"),c),this._onTransitionEnd=this._onTransitionEnd.bind(this),this.getElement().addEventListener("transitionend",this._onTransitionEnd))},_onTransitionEnd:function(){var e=this.getElement();e.removeEventListener("transitionend",this._onTransitionEnd),e.style.display="none"},_addChangeListeners:function(){var e;e=l?d.fromEvent(this._videoPlayer,"currenttimechanged").takeUntil(this._disposed).throttle(u).filter(function(){return this._videoCurrentTime=this._videoPlayer.getCurrentTime(),this._videoCurrentTime>=this._videoDuration-1500}.bind(this)).take(1):d.fromEvent(this._videoPlayer,"endedchanged").takeUntil(this._disposed).filter(function(){return this._videoPlayer.getEnded()}.bind(this)),e.doAction(function(){this._videoPlayerWrapperEl.classList.add("interstitial-video-ended"),this.fireEvent(this.videoEvents.INTERSTITIAL_VIDEO_END)}.bind(this)).subscribe(c,a.getErrorHandler("event|currenttimechanged"),c)},destroy:function(){this._disposed.onNext(),s.remove(this._rootEl),this._videoPlayer&&this._videoPlayer.close(),this._super()},init:function(e,t){var o,r=i.videoSession();this._super(e,t),this._initialized=!0,o=n.tryCatch(r.createPlayer,r,[t.videoId,t.trackId||0]),o instanceof Error?a.error(o):(this._render(),this._videoPlayer=o,this._videoPlayerWrapperEl.appendChild(this._videoPlayer.getElement()),this._videoPlayerWrapperEl.style.display="none",this._createEventSubscriptions())},_prepareForVideoPlayback:function(){this._videoTitleEl&&(this._videoTitleEl.style.display="none"),this._rootEl.style.backgroundImage=""},getElement:function(){return this._rootEl},startAutoPlay:function(){var e=this.config.autoPlayTimer||5;this._autoPlayTimer=setTimeout(function(){this._prepareForVideoPlayback(),this._videoPlayer.seek(0),this._videoPlayer.load()}.bind(this),1e3*e)},cancelAutoPlay:function(){clearTimeout(this._autoPlayTimer)},hasVideoPlayer:function(){return!!this._videoPlayer}});m.create=function(e,t){return new m(e,t)}}(),function(){"use strict";var t,n=e.cadmium,i=n.dom,o=i.DIV,r=i.SPAN,s=function(){var e=o({"class":"report-problem-button"},r(t.get("ce-report-problem-menu")));return e};n.ui.ReportProblemMenuComponent=n.ui.MenuComponent.extend({init:function(n,i,o){t=e.I18n,this._super(n,i,o),this.menuEl.appendChild(s())},destroy:function(){this._super()}})}(),function(){"use strict";var t=e.cadmium,n=t.ui.Component,i=t.element,o=t.Logger.create("component.postplay.background"),r=n.extend({init:function(e){this.initialized||(this._super(e),this._rootEl=i.create("div",{"class":"player-postplay-background-image"}),i.create("div",{"class":"player-postplay-background-gradient"},this._rootEl))},destroy:function(){this.initialized&&(o.log("destroy"),i.remove(this._rootEl),this._super())}});Object.defineProperties(r.prototype,{source:{enumerable:!0,get:function(){return this._source},set:function(e){this._source=e,this._rootEl.style.cssText="background-image: url("+e+");",this.parentNode.contains(this._rootEl)||this.parentNode.appendChild(this._rootEl)}}}),r.createFromUrl=function(e,t){var n=new r(e);return n.source=t,n},r.create=function(e){return new r(e)},t.ui.PostPlayBackground=r}(),function(){"use strict";var t,n=e.cadmium,i=n.ui.Component,o=n.element,r=n.dom,s=r.get("DIV"),a=r.get("SPAN"),l=r.get("UL"),u=r.get("LI"),c=n.time,d=n.Logger.create("component.postplay.bob"),m=i.extend({init:function(n,i){d.log("init"),t=e.I18n,this._super(n),this._metadata=i,this._createElements()},destroy:function(){d.log("destroy"),o.remove(this._rootEl),this._super()},show:function(){this._rootEl.classList.add(o.classNames.active)},hide:function(){this._rootEl.classList.remove(o.classNames.active)},_createElements:function(){function e(e,i,o){if(e&&o){var r=i&&e.length>0,s=!i&&""!==e;(r||s)&&n.appendChild(u({},a({"class":"label"},t.get("ce-post-bob-"+o)+": "),document.createTextNode(r?e.slice(0,2).join(", "):e)))}}var n,i,o=this._metadata,r=o.duration||{};i="seconds"===r.unit?c.convertUsingKey(r.value,!1,!0,"ce-time"):r.unit&&r.value?t.getWithParams("ce-post-bob-duration-"+r.unit+(r.value>1?"-plural":""),["VALUE"],[r.value]):"",this._rootEl=s({"class":"player-postplay-recommendation-bob"},this._headerEl=s({"class":"bob-movie-header"},a({"class":"title"},o.title||""),a({"class":"year"},o.year||""),o.rating?a({"class":"mpaa-rating mpaa-"+o.rating},o.rating):null,a({"class":"duration"},i)),s({"class":"bob-movie-content"},o.synopsis||"",s({"class":"info"},n=l({})))),e(o.actors,!0,"actors"),e(o.directors,!0,"director"),e(o.primaryGenre,!1,"genre"),this.parentNode.appendChild(this._rootEl)}});m.create=function(e,t){return new m(e,t)},n.ui.PostPlayBob=m}(),function(){"use strict";var t=e.cadmium,n=t.ui.Component,i=t.element,o=t.ui.PostPlayBob,r=Rx.Observable,s=t.Logger.create("component.postplay.boxshot"),a=i.classNames.active,l=n.extend({init:function(e,t,n){this.initialized||(this._super(e,n),this._metadata=t,this._templateBuilder=n.template,this._index=n.index,this._eventsObservable=r.empty(),this._createElements(),this._createEventSubscriptions(),e.appendChild(this._rootEl))},destroy:function(){this.initialized&&(s.log("destroy"),i.remove(this._rootEl),this._super())},getData:function(){return this._metadata},onAction:function(){return this._eventsObservable},setHighlighted:function(e){this._rootEl.classList[e?"add":"remove"](a)},setBobVisibility:function(e){this._bob[e?"show":"hide"]()},_createElements:function(){this._rootEl=this._templateBuilder(this._metadata,this._index),this._bob=o.create(this._rootEl,this._metadata)},_createEventSubscriptions:function(){this.config.events&&this.config.events.forEach(function(e){var t=r.fromEvent(this._rootEl,e).map(function(e){return{instance:this,el:this._rootEl,type:e.type,data:this._metadata,id:this._metadata.id,event:e}}.bind(this));this._eventsObservable=this._eventsObservable.merge(t)},this)}});l.create=function(e,t,n){return new l(e,t,n)},t.ui.BoxShot=l}(),function(){"use strict";var t,n=e.cadmium,i=n.ui.Component,o=n.dom.DIV,r=n.element,s=n.ui.Button,a=n.fullscreen,l=n.UiEvents,u=Rx.Observable,c=n.util.NOOP,d=n.Logger.create("component.postplay.buttons"),m="exitFSBtn",p="b2bBtn",h=i.extend({init:function(n,i){this.initialized||(t=e.I18n,this._super(n),i=i||"action-buttons",this._rootEl=o({"class":i}),this._buttons={},this._eventsObservable=u.empty(),this._disposed=new Rx.Subject,n.appendChild(this._rootEl))},destroy:function(){if(this.initialized){d.log("destroy"),this._disposed.onNext();for(var e in this._buttons)this._buttons[e].destroy();this._super()}},addButton:function(e,t){var n=this.getButton(e.id);return n?n:(n=new s(t||this._rootEl,{"class":e["class"],contentsEl:e.contentsEl}),n.type=e.type,n.id=e.id,this._buttons[n.id]=n,e.events&&e.events.forEach(function(e){var t=u.fromEvent(n,e).map(function(e){return{id:n.id,type:e.type,event:e,component:n}}).takeUntil(this._disposed);this._eventsObservable=this._eventsObservable.merge(t)},this),n)},getButton:function(e){return this._buttons&&this._buttons[e]},hideButton:function(e){return this._showHideButton(e,!1)},showButton:function(e){return this._showHideButton(e,!0)},onAction:function(){return this._eventsObservable},_showHideButton:function(e,t){var n=this.getButton(e);return n&&n.buttonEl.classList[t?"remove":"add"]("display-none"),n}});h.create=function(e,t,n){var i=new h(e,n);return t.forEach(function(e){i.addButton(e)}),i},h.createBasic=function(i,o){t=e.I18n;var s=[{id:p,contentsEl:document.createTextNode(t.get("ce-back-to-browse")),"class":"back-to-browsing",events:["click"]}];a.isFullscreen()&&s.push({id:m,contentsEl:document.createTextNode(t.get("ce-post-exit-fullscreen")),"class":"exit-fullscreen",events:["click"]});var v,E=h.create(i,s,o);return E.onAction().takeUntil(E._disposed).doAction(function(e){switch(e.id){case p:v=n.objects&&n.objects.videoPlayer(),n.ui.master.goBackToBrowsing(),v&&r.remove(v.getElement());break;case m:n.fullscreen.exit()}}).subscribe(c,d.getErrorHandler("onAction handler"),c),u.fromEvent(l,l.knownEvents.FULLSCREEN_CHANGE).takeUntil(E._disposed).filter(function(e){return!e}).doAction(function(){E.hideButton(m)}).subscribe(c,d.getErrorHandler("fullscreen change handler"),c),E},n.ui.PostPlayActionButtons=h}(),function(){"use strict";var t=e.cadmium,n=t.ui.Component,i=Rx.Observable,o=t.ui.BoxShot,r=t.util.NOOP,s=t.Logger.create("component.postplay.sims"),a=Object.freeze({hoverover:["mouseover","MSPointerEnter"],hoverout:["mouseout","MSPointerLeave"],click:["click","MSPointerDown"],all:["click","MSPointerDown","mouseover","mouseout","MSPointerEnter","MSPointerLeave"]}),l=n.extend({init:function(e,t,n){this.initialized||(this._super(e),this._simList=t,this._template=n,this._sims=[],this._eventsObservable=i.empty(),this._disposed=new Rx.Subject,this._onHighlightSim=new Rx.Subject,this._activeSim=null,this._createElements(),this._initSubscriptions())},destroy:function(){s.log("destroy"),this._disposed.onNext(),this._sims.forEach(function(e){e.destroy()}),this._super()},getAt:function(e){return this._sims[e]},onHoverOver:function(){return this._getEventObservable("hoverover")},onHoverOut:function(){return this._getEventObservable("hoverout")},onHighlight:function(){return this._onHighlightSim},onClick:function(){return this._getEventObservable("click")},highlightSimAtIndex:function(e,t){var n=this._sims[e];this._highlightSim(n),t&&this._setBobVisibilityForSim(n,!0)},_highlightSim:function(e){this._activeSim&&this._activeSim.setHighlighted(!1),this._activeSim&&this._setBobVisibilityForSim(this._activeSim,!1),this._activeSim=e,e.setHighlighted(!0),this._onHighlightSim.onNext(e)},_setBobVisibilityForSim:function(e,t){e.setBobVisibility(t)},_getEventObservable:function(e){return function(e){return this._eventsObservable.filter(function(t){return e.some(function(e){return e===t.type})})}.bind(this)(a[e]||[])},_createElements:function(){this._simList.forEach(function(e,t){var n=o.create(this.parentNode,e,{events:a.all,template:this._template,index:t});this._sims.push(n),this._eventsObservable=this._eventsObservable.merge(n.onAction())},this)},_initSubscriptions:function(){this.onHoverOver().takeUntil(this._disposed).doAction(function(e){this._highlightSim(e.instance),this._setBobVisibilityForSim(e.instance,!0)}.bind(this)).subscribe(r,s.getErrorHandler("hover over handler"),r),this.onHoverOut().takeUntil(this._disposed).doAction(function(e){this._setBobVisibilityForSim(e.instance,!1)}.bind(this)).subscribe(r,s.getErrorHandler("hover out handler"),r)}});l.create=function(e,t,n){return new l(e,t,n)},t.ui.PostPlaySimsCollection=l}(),function(){"use strict";var t,n=e.cadmium,i=n.ui.Component,o=n.element,r=n.Logger.create("component.postplay.timer"),s=Rx.Observable,a=n.util.NOOP,l=15,u=i.extend({init:function(n,i){i=i||{},t=e.I18n,this._super(n),this._disposed=new Rx.Subject,this._stopped=new Rx.Subject,this._startTime=null,this._timer=null,this._maxTime=i.maxTime||l,this._pluralTemplate=i.pluralTemplate||function(e){return t.getWithParams("ce-post-autoplay",["SECONDS"],[e])},this._singularTemplate=i.singularTemplate||function(){return t.get("ce-post-autoplay-singular")},this._stoppedTemplate=i.stoppedTemplate||function(){return""}},destroy:function(){r.log("destroy"),this._disposed.onNext(),o.remove(this._rootEl),this._super()},start:function(e){return this._createElements(),this._createTimerObservable(),this._timer.subscribe(a,r.getErrorHandler("timer error"),a),this.onTimerEnd().doAction(e||a).subscribe(a,r.getErrorHandler("timer end"),a),this},stop:function(){this._stopped.onNext(),this.parentNode&&(void 0!=this._stoppedTemplate()?this.parentNode.innerHTML=this._stoppedTemplate():this.parentNode.parentNode&&this.parentNode.parentNode.removeChild(this.parentNode))},onTimerEnd:function(){return this._timer.map(function(e){return 1>=e}).filter(function(e){return e}).delay(1e3).map(function(){return!0})},_createElements:function(){this.parentNode.innerHTML=this._pluralTemplate(this._maxTime)},_createTimerObservable:function(){this._timer=s.interval(1e3).takeUntil(this._disposed).takeUntil(this._stopped).timeInterval().map(function(e){return this._maxTime-e.value}.bind(this)).doAction(this._updateTimer.bind(this)).share()},_updateTimer:function(e){e>1?this.parentNode.innerHTML=this._pluralTemplate(e):1===e?this.parentNode.innerHTML=this._singularTemplate():this.stop()}});u.create=function(e,t){return new u(e,t)},n.ui.PostPlayTimer=u}(),function(){"use strict";var t,n=e.cadmium,i=n.ui.Component,o=n.element,r=n.fullscreen,s=n.UiEvents,a=n.dom,l=a.get("DIV"),u=a.get("SPAN"),c=n.Logger.create("component.postplay.exit.fullscreen"),d=n.util.NOOP,m=i.extend({init:function(n){c.log("init"),t=e.I18n,this._disposed=new Rx.Subject,this._super(n),this._createElements(),this._setupSubscriptions()},destroy:function(){c.log("destroy"),o.remove(this._rootEl),this._super()},hide:function(){this._rootEl.classList.add("display-none")},show:function(){this._rootEl.classList.remove("display-none")},_createElements:function(){this._rootEl=l({"class":"exit-fullscreen-button"},u({"class":"exit-fullscreen-text"},t.get("ce-post-exit-fullscreen")),u({"class":"exit-fullscreen-icon"})),this.parentNode.appendChild(this._rootEl)},_setupSubscriptions:function(){Rx.Observable.fromEvent(this._rootEl,"click").takeUntil(this._disposed).take(1).doAction(function(){r.exit(),this.hide()}.bind(this)).subscribe(d,c.getErrorHandler("event|click"),d),Rx.Observable.fromEvent(s,s.knownEvents.FULLSCREEN_CHANGE).takeUntil(this._disposed).take(1).doAction(function(e){e?this.show():this.hide()}.bind(this)).subscribe(d,c.getErrorHandler("event|FULLSCREEN_CHANGE"),d)}});m.create=function(e){var t=new m(e);return r.isFullscreen()?t.show():t.hide(),t},n.ui.PostPlayExitFullscreen=m}(),function(){"use strict";var t,n,i,o,r=e.cadmium,s=e.cadmium.metadata,a=r.dom,l=a.get("DIV"),u=a.get("SPAN"),c=r.Logger.create("component.postplay.akira.userrating"),d=1100,m=function(){return{videoId:r.objects.videoId(),trackId:r.objects.trackId()}},p=function(r,s){var a=e.cadmium.objects.initParams(),l=a.useStarRatings,u=a.useThumbRatings;t=e.I18n,s=s||{},this._parentEl=r,this._config=s,n||(n=Requireify.require("react")),!i&&l?i=Requireify.require("js/akira/components/title/basicStarBar.jsx"):!o&&u&&(o=Requireify.require("js/akira/components/title/thumbs.jsx")),n.stub||l&&i&&i.stub||u&&o&&o.stub||!l&&!u||(l?this._renderStars():u&&this._renderThumbs())};p.prototype._renderStars=function(){var e,o=this,r={};this._starBarNode=l({"class":"starbar-container"},u({"class":"ratings-text postplay-star-text"},t.get("ce-post-rate")),this._starBarHolder=l({"class":"starbar-holder"})),r.videoId=this._config.id,r.onRating=function(e){o._starBar.setProps({userRating:e},function(){o._starBar.context=m()})},this._config.value&&(r.userRating=this._config.value,r.predictedRating=this._config.predicted),e=n.createElement(i,r),this._starBar=n.render(e,this._starBarHolder),this._starBar.context=m(),this._parentEl.appendChild(this._starBarNode)},p.prototype._renderThumbs=function(){var e,t=this,i={extraClass:"player-thumbs thumbs-animated"},r=s.getMetadata(),a=r&&r.video&&r.video.title||"";this._thumbsNode=l({"class":"thumbs-container"},u({"class":"ratings-text current-video-title"},a),this._thumbsHolder=l({"class":"thumbs-holder"})),i.videoId=this._config.id,i.onRating=function(e){t._thumbs.setProps({userRating:e},function(){t._thumbs.context=m()})},this._config.value&&(i.userRating=this._config.value,i.matchScore=this._config.matchScore),e=n.createElement(o,i),this._thumbs=n.render(e,this._thumbsHolder),this._thumbs.context=m(),this._parentEl.appendChild(this._thumbsNode),this._animationTimeout=setTimeout(function(){t._thumbsNode.classList.add("dropped")},d)},p.prototype.destroy=function(){c.log("destroy"),this._starBar?(n.unmountComponentAtNode(this._starBarHolder),this._parentEl.removeChild(this._starBarNode),this._starBar=null,this._starBarNode=null,this._starBarHolder=null):this._thumbs&&(window.clearTimeout(this._animationTimeout),n.unmountComponentAtNode(this._thumbsHolder),this._parentEl.removeChild(this._thumbsNode),this._thumbs=null,this._thumbsNode=null,this._thumbsHolder=null),this._parentEl=null,this._config=null},r.ui.AkiraPostPlayUserRating={create:function(e,t){return new p(e,t)}}}(),function(){"use strict";var t,n,i,o=e.cadmium,r=o.ui.Component,s=o.ui.AkiraPostPlayUserRating,a=o.ui.Button,l=o.UiEvents,u=o.dom,c=u.get("DIV"),d=u.get("IMG"),m=u.get("P"),p=o.Logger.create("component.postplay.horizontal"),h=2e3,v=2.2,E="modal:close:feedbackModal",f="originalsFeedbackButton:show",g="originalsFeedbackButton:click",_="originalsFeedbackForm:submit",b="click",y=r.extend({init:function(i,r,s){r=r||{},n=e.I18n,t=o.metadata,this._super(i),this._hideForm=this._hideForm.bind(this),this._onFormClosed=this._onFormClosed.bind(this),this._metadata=r,this._type=s,this._starBar=null,this._feedbackButton=null,this._feedbackForm=null,this._modalTimeout=null,this._createElements()},destroy:function(){p.log("destroy"),this._feedbackButton&&this._feedbackButton.destroy(),this._feedbackForm&&this._feedbackForm.destroy(),this._userRating&&this._userRating.destroy(),
clearTimeout(this._modalTimeout),i&&!i.stub&&(i.removeListener(_,this._hideForm),i.removeListener(E,this._onFormClosed)),this._super()},_createElements:function(){var e,r,u=this._metadata||{},p=this,h=t.getActiveVideo(),y=h&&h.showFeedback;this._rootEl=c({"class":"trailer-horizontal trailer-merch"},this._wrapperEl=c({"class":"trailer-horizontal-wrapper"},this._imageEl=d({"class":"trailer-horizontal-image"}),c({"class":"trailer-replay"},m({"class":"trailer-replay-icon"}),m({"class":"trailer-replay-text"},n.get("ce-post-replay-trailer"))))),u.horizontal?this._imageEl.setAttribute("src",u.horizontal):this._imageEl.style.minHeight="22.5em",u.userRating&&o.ui.master.isAkira()&&(this._userRating=s.create(this._rootEl,u.userRating)),!y||"watchNext"!==this._type&&"recommendations"!==this._type||(i||(i=Requireify.require("js/reactMixins/eventBus.js")),e=t.getMetadata().video.title,r=n.getWithParams("what-did-you-think",["title"],[e]),this._feedbackButton=new a(this._rootEl,{"class":"feedback-button",contentsEl:document.createTextNode(r)}),requestAnimationFrame(function(){if(p._feedbackButton){var e=p._feedbackButton.buttonEl,t=e.getBoundingClientRect(),n=parseFloat(getComputedStyle(e).getPropertyValue("font-size")),i=-1*(t.height/n+v);e.style.bottom=i+"em"}}),i.stub||(i.emit(f),i.on(_,this._hideForm),i.on(E,this._onFormClosed)),this._feedbackButton.addEventListener(b,function(){i.stub||i.emit(g),l.fireEvent(l.knownEvents.STOP_AUTOPLAY_TIMER),p._feedbackForm=o.ui.AkiraOriginalsFeedbackModal.create(document.getElementById("playerContainer"),{id:h.id,title:e,maxChars:1e3,onSubmit:function(){p._feedbackButton&&p._feedbackButton.destroy()}})})),this.parentNode.appendChild(this._rootEl)},_hideForm:function(){var e=this;this._feedbackForm&&(clearTimeout(this._modalTimeout),this._modalTimeout=setTimeout(function(){e._feedbackForm.close()},h))},_onFormClosed:function(){var t=e.cadmium.UiEvents;t.fireEvent(t.knownEvents.START_AUTOPLAY_TIMER)}});y.create=function(e,t,n){return new y(e,t,n)},o.ui.PostPlayHorizontal=y}(),function(){"use strict";var t,n=e.cadmium,i=n.ui.Component,o=n.objects,r=n.element,s=n.url,a=n.Logger.create("component.postplay.mylist"),l=Rx.Observable,u=n.xhr,c=n.util.NOOP,d=1e4,m=3,p=1e3,h="save",v="add",E="remove",f=i.extend({init:function(n,i){i=i||{},t=e.I18n,this._myList=i.myList,this._trackId=i.trackId,this._element=i.element,this._disposed=new Rx.Subject,this._myListAction=null,this._myListRequest=null,this._super(n)},destroy:function(){a.log("destroy"),this._disposed.onNext(),r.remove(this._rootEl),this._super()},toggleMyList:function(){if(this._myListRequest)return this._myListRequest;var e=this._myList;return e&&e.endpoint?(this._myListRequest=l.defer(function(){return this._myListAction||(this._myListAction=e.action===h?v:e.action),l["return"](this._myListAction)}.bind(this)).map(function(e){return{action:e,xaction:this._getXAction(e)}}.bind(this)).doAction(function(e){a.log("My List action",e),this._updateUI(e.xaction)}.bind(this)).flatMap(this._makeXhr.bind(this)).doAction(function(e){this._myList.action=this._myListAction=e.xaction,this._myListRequest=null}.bind(this))["catch"](function(){this._myListRequest=null}.bind(this)),this._myListRequest.subscribe(c,a.getErrorHandler("xhr|mylist"),c),this._myListRequest):l["throw"]("Nothing to add; my list is not defined.")},_getXAction:function(e){var t;return t=e===h||e==v?E:this._myList.addAction},_makeXhr:function(e){var t={withCredentials:!0,urlEncoded:!1,data:{action:e.action,videoId:this._myList.id,trackId:this._trackId}};return u.post(this._myList.endpoint,t).takeUntil(this._disposed).timeout(d).retryWithBackoff(m,p).map(function(t){if(a.log("My list response",t),t=t||{},!t.status||"success"!==t.status.toLowerCase())throw new Error(t);return t.xaction=e.xaction,t}.bind(this))},_updateUI:function(e){this._element&&("add"===e||"remove"===e||"save"===e)&&(this._element.textContent=t.get("ce-post-"+e+"-to-my-list"))}});f.create=function(e,t){return new f(e,t)},f.getCurrentState=function(e){e=e||{};var t=o&&o.initParams()||{},n={withCredentials:!0,urlEncoded:!0,data:{action:"get",videoId:e.id}};return"prod"!==t.environment&&(n.data.forcepromo=s.urlContains(/forcepromo=true/)),u.get(e.endpoint,n)},n.ui.PostPlayMyList=f}(),function(){"use strict";var t=e.cadmium,n=t.mixins,i="save-to-list",o="more-info";n.ui.buttons={MY_LIST_BUTTON:i,MORE_INFO_BUTTON:o,getMyListButton:function(t){var n=e.I18n;return{id:i,contentsEl:document.createTextNode(n.get("ce-post-"+t+"-to-my-list")),"class":"my-list",events:["click"]}},getMoreInfoButton:function(){var t=e.I18n;return{id:o,contentsEl:document.createTextNode(t.get("ce-post-more-info")),"class":"more-info",events:["click"]}}}}(),function(){"use strict";var t=e.cadmium,n=t.mixins;n.ui.videoInterstitial={addVideoInterstitialComponent:function(e){this._interstitial=this._addComponent(t.ui.VideoInterstitialComponent.create(this._parentEl,e)),this._interstitial.hasVideoPlayer()?(this._rootEl.style.display="none",this._parentEl.appendChild(this._interstitial.getElement()),this._interstitial.startAutoPlay()):(this._interstitial.destroy(),this._interstitial=null)},_handleInterstitialReturnToPlayback:function(){this._interstitial&&this._interstitial.cancelAutoPlay()},_onInterstitialTransitionEnd:function(){var e=this._interstitial.getElement();e.removeEventListener("transitionend",this._onInterstitialTransitionEnd),this._interstitial.removeEventListener(this._interstitial.videoEvents.INTERSTITIAL_VIDEO_START,this._onInterstitialVideoStart),this._interstitial.removeEventListener(this._interstitial.videoEvents.INTERSTITIAL_VIDEO_END,this._onInterstitialVideoEnd),this._interstitial.destroy()},_onInterstitialVideoStart:function(){this._videoPlayer&&this._videoPlayer.close(),t.UiEvents.fireEvent(t.UiEvents.knownEvents.VIDEO_ENDED),t.ui.exitPlayback.init(this._parentEl)},_onInterstitialVideoEnd:function(){var e=this._interstitial.getElement();this._rootEl.style.display="",e.addEventListener("transitionend",this._onInterstitialTransitionEnd),t.ui.exitPlayback.deinit()},createVideoInterstitialEvents:function(){this._interstitial&&(this._onInterstitialTransitionEnd=this._onInterstitialTransitionEnd.bind(this),this._onInterstitialVideoStart=this._onInterstitialVideoStart.bind(this),this._onInterstitialVideoEnd=this._onInterstitialVideoEnd.bind(this),this._interstitial.addEventListener(this._interstitial.videoEvents.INTERSTITIAL_VIDEO_START,this._onInterstitialVideoStart),this._interstitial.addEventListener(this._interstitial.videoEvents.INTERSTITIAL_VIDEO_END,this._onInterstitialVideoEnd))}}}(),e.cadmium.ui.exitPlayback=function(){function t(){return null===p&&(r=u.create("p"),r.appendChild(document.createTextNode(a.get("ce-back-to-browse"))),p=u.create("a",{"class":"player-back-to-browsing no-select icon-player-back-to-browse"}),p.appendChild(r)),p}function n(){m&&(m=!1,p&&(p.removeEventListener("click",s.ui.master.goBackToBrowsing,!1),u.remove(p),p=null),c.removeEventListener(c.knownEvents.CINEMA_MODE_ENTER,h),c.removeEventListener(c.knownEvents.CINEMA_MODE_EXIT,v),c.removeEventListener(c.knownEvents.SHOW_AUTOPLAY_INTERRUPTER,h),c.removeEventListener(c.knownEvents.HIDE_AUTOPLAY_INTERRUPTER,v),o=null,p=null,r=null,s=null,a=null,l=null,u=null,c=null,d=null)}function i(i){m&&n(),m=!0,o=i,s=e.cadmium,a=e.I18n,l=s.metadata,u=s.element,c=s.UiEvents,d=s.objects,d.initParams().inPagePlayer||(o.appendChild(t()),p.addEventListener("click",s.ui.master.goBackToBrowsing,!1)),c.addEventListener(c.knownEvents.CINEMA_MODE_ENTER,h),c.addEventListener(c.knownEvents.CINEMA_MODE_EXIT,v),c.addEventListener(c.knownEvents.SHOW_AUTOPLAY_INTERRUPTER,h),c.addEventListener(c.knownEvents.HIDE_AUTOPLAY_INTERRUPTER,v)}var o,r,s,a,l,u,c,d,m=!1,p=null,h=function(){p&&s.animate.fadeOut(p)},v=function(){p&&s.animate.fadeIn(p)};return{init:i,deinit:n,getBackToBrowsingEl:function(){return p}}}(),e.cadmium.ui.master=function(){"use strict";function t(){if(I){v&&v.views&&v.views.show(v.ui.shutdown,[S]);var e=w&&w.initParams()&&w.initParams().referrerIsNetflix;n()&&e?window.history.back():window.location.replace(w.initParams().backToBrowsingUrl)}}function n(){try{return"akira"===w.initParams().uimode}catch(e){return!1}}function i(){if(!R){var e,t=document.getElementsByTagName("head")[0],n=0;if(R=document.createElement("style"),R.appendChild(document.createTextNode("")),t.appendChild(R),e=R.sheet,"webkit"===T.prefix().lowercase&&window.navigator.userAgent.indexOf("Edge/")<0)try{e.insertRule("::-webkit-scrollbar { background-color: #262626; border-left: 1px solid black; width: 1.5em; }",n++),e.insertRule("::-webkit-scrollbar-thumb { background: -webkit-linear-gradient(top, #ccc 0%, #aaa 100%); border-left: 1px solid black; border-radius: .3em; }",n++)}catch(i){E.info(i)}try{e.insertRule("body { background-color: #000; }",n++)}catch(i){E.info(i)}}}function o(){R&&(f.remove(R),R=null)}function r(){return H=!1,e.cadmium.fullscreen&&e.cadmium.fullscreen.isFullscreen()&&(window.location=window.location),Rx.Observable.create(function(t){function n(){t.onNext(!0),t.onCompleted(),b&&b.fireEvent(b.knownEvents.SHUTDOWN),d(!1,!0)}function i(){v&&v.views.deinit(),n()}return e.mdx.bootstrap.deinitMdx(),o(),k?k.close(i):i(),U})}function s(){if(null===S){var e=T.prefix();C=f.create("section",{id:"netflix-player-font-wrapper"}),S=f.create("section",{id:"netflix-player","class":e&&e.css?"ua"+e.css:""},C),N=f.create("div",{"class":"player-video-wrapper player-hidden"},S),O.appendChild(C),w.setPlayerWrapper(S),S.addEventListener("contextmenu",u)}}function a(){I&&(k=w.videoPlayer(),b.removeEventListener(y.NEW_PLAYER_CREATED,a),E.log("new player created, appending element to dom"),N.appendChild(k.getElement()),b.fireEvent(y.NEW_PLAYER_DOM_CREATED))}function l(){I&&H&&(v.views.show(v.ui.shutdown,[S]),r().doAction(d).subscribe(U,E.getErrorHandler("beforeUnload"),U))}function u(e){return/debug=true/.test(window.location.search)?void 0:(e.preventDefault(),!1)}function c(n){E.log("postplayEnterHandler, ev:",n);var i=w.playerWrapper();e.cadmium.PostPlayData.getData().doAction(function(e){var n=e&&e.type&&e.type.toLowerCase&&e.type.toLowerCase()||"";_.isSupplementalVideo()&&n.indexOf("trailer")<0?(b.removeEventListener(y.VIDEO_POSTPLAY_ENTER,c),t()):v.ui.PostPlay.preinit(i)}).subscribe()}function d(t,n){if(I){I=!1,E.log("deinit"),v.ui.playback.deinit(),f.remove(N.childNodes),x.deinit(),v.playbackEvents.deinit(),P.deinit(),v.removeBeforeUnloadHandler(l),b.removeEventListener(y.VIDEO_POSTPLAY_ENTER,c),t||(f.remove(S),S=null,N=null,_.clear(),b.destroy(),L.deinit(),e.cadmium.PostPlayData.deinit(),e.cadmium.playbackShutdown&&e.cadmium.playbackShutdown.onNext());try{window.netflix.player.diag.togglePanel("log",!1)}catch(i){}w.drain(t,n),O=null,C=null,R=null,E=null,f=null,g=null,_=null,b=null,y=null,w=null,k=null,T=null,x=null,L=null,A=null,D=!1,M=!1,H=!1}}function m(t,o,r){I&&d(!0),I=!0;var u,m;if(e.I18n=e.I18n||window.netflix.I18n,v=e.cadmium,_=v.metadata,E=v.Logger.create("view.master"),f=v.element,b=v.UiEvents,y=b.knownEvents,w=v.objects,T=v.browser,g=v.url,x=v.sizing,O=t||document.body,M=!1,L=v.session,A=v.ui.errors,P=v.fullscreen,E.log("init"),v.unloadActions.init(),v.ui.fatal.listenForFatalErrors(),o){o.preserveLastFrame=!0,o.breakOnError=!1,void 0==o.enableTrickPlay&&(o.enableTrickPlay=!0),v.playbackEvents.init(),P.init(),L.init();try{u=e.clientNotifications.getCurrentSession("appSession").sessionId,m=e.clientNotifications.getCurrentSession("userSession").sessionId,o.appId=u,o.sessionId=m,o.nccpAppId=u,o.nccpSessionId=m}catch(p){}o.disableVideoRightClickMenu=!1;var h=g.getNextVideo();(h.episodeId||h.videoId)&&(delete o.videoId,delete o.movieId,delete o.episodeId,r=h.videoId?null:r,v.util.mix(h,o));var k=o.episodeId||o.movieId||o.videoId||-1;o.recap&&o.recap.hasPlayed&&delete o.recap;var C=g.getQueryString().ad;C&&(o.assistiveAudioPreferred="true"===C),w.setInitParams(o);var N=parseInt(g.getQueryString()[g.CONSTANTS.BOOKMARK],10);if(isNaN(N)||w.overrideBookmark(k,1e3*N),w.createVideoSession(),i(),s(),x.init(S),o.movieId<=1||o.videoId<=1)return void A.throwUIError(A.type.UI_TITLE_UNAVAILABLE);r?_.setMetadata(k,r):_.retrieveData(k);var R=_.getActiveVideo()||{};v.ui.preplay.preplayNeeded()||v.clips.getClipValues(R.id)||b.addEventListener(y.VIDEO_POSTPLAY_ENTER,c),H=!0,b.addEventListener(y.NEW_PLAYER_CREATED,a),e.cadmium.addBeforeUnloadHandler(l),n()&&(document.cookie="profilesNewSession=0; domain=.netflix.com; path=/;max-age=100000000;"),v.views.show(v.ui.loader.create(o),[S,o])}}function p(t,n){if(t&&!D){D=!0,k.close(),S.classList.add("player-mdx-mode");var i=w.videoId();e.mdx.ui.master.init(i),e.mdx.ui.master.showState(n,"loading",i)}else!t&&D&&(D=!1,e.mdx.ui.master.hide(),m(O,w.initParams(),v.metadata.getMetadata()),S.classList.remove("player-mdx-mode"))}function h(e,t){w&&w.setPlayContext(t),m(O,e)}var v,E,f,g,_,b,y,w,k,T,x,L,A,P,I=!1,O=null,C=null,S=null,N=null,R=null,D=!1,M=!1,U=e.cadmium.util.NOOP,H=!1,B=window.netflix.cadmium.ui;return B.master={},B.master.init=m,B.master.shutdown=r,{init:m,deinit:d,updateInitParams:h,goBackToBrowsing:t,toggleMdxMode:p,isAkira:n,shutdown:r}}(),e.cadmium.ui.fatal=function(){"use strict";function t(e,t){var n,i=!1;return e&&e.length>0&&e.some(function(e){return n=t+e+"-phone",i=c.getWithParams(n,m,p),(""===i||i.indexOf(n)>=0)&&(i=c.getWithParams(t+e,m,p)),""!==i&&!/---.*---/.test(i)&&!/{.*}/.test(i)}),i=i.indexOf("MISSINGRESOURCE")>-1?"":i,i||c.get(t+"default")}function n(e){var t=v.initParams(),n=t.errorSupportUrls||{};return n[e]?"https://help.netflix.com/support/"+n[e]:""}function i(e){if(null===d){d=f.create("section",{"class":"player-fatal-message"});var i,o=t(e.messageIdList,"ce-head-"),r=c.get("ce-support-text"),s="",a="-1",l=v.initParams().hideSupportUrl;e.display&&(a=c.getWithParams("ce-head-code",["CODE"],[e.display.code||a]),s=n(e.display.code||a),i=e.display.text?e.display.text:t(e.messageIdList,"ce-text-"));var u="";l||""===s||""===r||(u="<p class='player-help-center'>"+r+"<a href='"+s+"'>"+s+"</a></p>"),d.innerHTML="<h1>"+c.get("ce-header")+"</h1><h2>"+o+"</h2><p>"+i+"</p>"+u+"<h3>"+a+"</h3>"}return d}function o(){function e(e,t){t&&(m.push(e),p.push(t))}var t=v.initParams(),n=t.supportPhoneNumber,i=t.signoutUrl,o=t.chromeVersion,r=v&&v.getCountry().toUpperCase();e("PHONE",n),e("SIGNOUT_URL",i),e("CHROME_VERSION",o),e("ISO",r)}function r(e){var t=window.netflix.clientNotifications;if(t){var n=g.getHash(g.CONSTANTS.EPISODE_ID),i=g.getHash(g.CONSTANTS.VIDEO_ID),o=v.videoId(),r=g.getQueryString(),s=parseInt(r.movieid),a={category:"uiQOE",modalView:"errorDialog",data:{playable:o||-1,requested:isNaN(s)?-1:s,h_episode:n||-1,h_video:i||-1,code:e&&e.display&&e.display.code||-1,core:v.videoPlayer()&&v.videoPlayer().getAdditionalLogInfo()||"na"}};t.notify("uiModalViewChanged",a),t.flushBuffer&&t.flushBuffer()}}function s(t){u=v.playerWrapper(),c=e.I18n,o(),u.appendChild(i(t)),h.ui.exitPlayback.init(u)}function a(){var e=v.videoPlayer().getError()||{};r(e),e.display&&e.display.code&&e.display.code.indexOf&&(e.display.code.indexOf(_)>=0||e.display.code.indexOf(b)>=0)?h.views.show(h.ui.playTimeout):h.views.show(h.ui.fatal,[e])}function l(){E.addEventListener(E.knownEvents.NEW_PLAYER_CREATED,function e(){v.videoPlayer().addEventListener("error",a),E.removeEventListener(E.knownEvents.NEW_PLAYER_CREATED,e)}),E.addEventListener(E.knownEvents.ERROR,function t(e){h.views.show(h.ui.fatal,[e]),E.removeEventListener(E.knownEvents.ERROR,t)})}var u,c,d=null,m=[],p=[],h=e.cadmium,v=h.objects,E=h.UiEvents,f=h.element,g=h.url,_="7500",b="7502";return{init:s,listenForFatalErrors:l}}(),e.cadmium.views.register(e.cadmium.ui.fatal,e.cadmium.views.types.fatal),e.cadmium.ui.playTimeout=function(){"use strict";function t(){f&&n(),f=!0,a=e.cadmium.objects,l=e.cadmium.UiEvents,u=a.playerWrapper(),c=E({"class":"timeout-wrapper"},d=E({"class":"playRing"},E({"class":"icon-play"}))),p=e.cadmium.ui.exitPlayback,p.init(u),u.appendChild(c),m=a.videoPlayer().getElement(),m.style.position="absolute",m.style.left="0",m.parentNode.removeChild(m),u.appendChild(m),e.cadmium.addBeforeUnloadHandler(s,!0),l.addEventListener(l.knownEvents.VIDEO_FIRST_PLAY,function t(){e.cadmium.UiEvents.removeEventListener(e.cadmium.UiEvents.knownEvents.VIDEO_FIRST_PLAY,t),s()}),d.addEventListener("click",o),document.addEventListener("keyup",i),h=requestAnimationFrame(function(){f&&c.classList.add("player-active")})}function n(){f&&(d.removeEventListener("click",o),document.removeEventListener("keyup",i),cancelAnimationFrame(h),u.removeChild(c),p.deinit(),u=null,c=null,p=null,a=null,l=null,f=!1)}function i(e){(e.keyCode===g||e.keyCode===_)&&(document.removeEventListener("keyup",i),r())}function o(){d.removeEventListener("click",o),r()}function r(){var t=a.initParams(),n=a.videoPlayer(),i=a.videoId(),o=n&&n.getCurrentTime();i&&o&&a.overrideBookmark(i,o),t.isStartingFromTimeout=!0,e.cadmium.ui.master.updateInitParams(t,a.playContext())}function s(){var t;n(),e.cadmium.removeBeforeUnloadHandler(s),m&&(t=m.querySelector("video"),t&&(t.removeAttribute("src"),t.load(),t=null),e.cadmium.objects.playerWrapper().removeChild(m)),m=null}var a,l,u,c,d,m,p,h,v=e.cadmium.dom,E=v.get("DIV"),f=!1,g=32,_=13;return{init:t,deinit:n}}(),e.cadmium.views.register(e.cadmium.ui.playTimeout,e.cadmium.views.types.standard),function(){"use strict";var t=e.cadmium,n=t.element,i=t.ui.Component.extend({_rootClassName:"player-shutdown",_initDOM:function(){this.rootEl=n.create("div",{"class":this._rootClassName},this.parentNode),this._logoEl=n.create("div",{id:"logo"},this.rootEl),this._lightingEl=n.create("div",{id:"light"},this.rootEl),this._shadowEl=n.create("div",{id:"shadow"},this.rootEl)},_show:function(){this.parentNode.appendChild(this.rootEl),setTimeout(function(){this.rootEl.classList.add(n.classNames.visible)}.bind(this),1)},init:function(e){e&&(this._super(e,{}),this._initDOM(),this._show())}});t.ui.shutdown=function(){var e=new i;return{init:e.init.bind(e)}}(),t.views.register(t.ui.shutdown,t.views.types.fatal)}(),e.cadmium.ui.mdx.playback=function(){function t(){}function n(n){m&&t(),m=!0,i=n,o=e.cadmium,a=o.metadata,l=o.UiEvents,s=o.element,u=o.objects,r=o.ui,c=o.logging,d=s.classNames.active,c.log("view.mdx.playback.init",n,m);var p=u.videoPlayer();p.getPaused()?p.play():p.pause()}var i,o,r,s,a,l,u,c,d,m=!1;return{init:n,deinit:t}}(),e.cadmium.views.register(e.cadmium.ui.mdx.playback,e.cadmium.views.types.standard),e.cadmium.ui.autoplayInterrupter=function(){"use strict";function t(e){D.log("setNextVideoIsAutoplay for id",e),S=S||{},e&&(S[e]=!0),R=!0}function n(){return Object.keys(S||{}).length}function i(){return n()>=v}function o(){D.info("Reset count."),S={}}function r(){R?(R=!1,i()&&(C=e.cadmium.objects.videoPlayer(),C&&C.addEventListener("currenttimechanged",s))):o(),D.log("Autoplay count "+n())}function s(){N&&(h=C.getCurrentTime(),h>=E&&p())}function a(){D.log("Continue playing."),u(),d()}function l(){D.log("Play from beginning."),C.seek(0),u(),d()}function u(){C.removeEventListener("currenttimechanged",s),C.play(),o()}function c(){if(null===g){g=x.create("div",{"class":"player-autoplay-interrupter no-select"});var e=O(O({"class":"nf-icons icon-player-play"}),L.get("ce-post-break-continue"));_=new T.ui.Button(g,{"class":"continue-playing",contentsEl:e}),_.addEventListener(_.knownEvents.CLICK,a);var t=O(O({"class":"nf-icons icon-player-prev-episode"}),L.get("ce-post-break-restart"));b=new T.ui.Button(g,{"class":"continue-playing",contentsEl:t}),b.addEventListener(b.knownEvents.CLICK,l);var n=O(O({"class":"nf-icons icon-player-cancel"}),L.get("ce-post-break-back-to-browse"));y=new T.ui.Button(g,{"class":"continue-playing",contentsEl:n}),y.addEventListener(y.knownEvents.CLICK,T.ui.master.goBackToBrowsing)}return g}function d(){N&&(D.log("deinit"),N=!1,g&&(_&&(_.removeEventListener(_.knownEvents.CLICK,a),_.destroy()),b&&(b.removeEventListener(b.knownEvents.CLICK,l),b.destroy()),y&&(y.removeEventListener(y.knownEvents.CLICK,T.ui.master.goBackToBrowsing),y.destroy()),f.classList.remove(w),x.remove(g),C&&C.removeEventListener("currenttimechanged",s),P.fireEvent(P.knownEvents.HIDE_AUTOPLAY_INTERRUPTER)),R=null,h=null,f=null,g=null,_=null,b=null,y=null,w=null,k=null,T=null,x=null,L=null,A=null,P=null,I=null,O=null,C=null)}function m(t){N&&d(),R=!1,w="player-autoplay-interrupter-mode",k="show-autoplay-interrupter",T=e.cadmium,x=T.element,L=e.I18n,A=T.objects,P=T.UiEvents,I=T.dom,O=I.SPAN,D.log("init"),v=A.initParams().maxConsecutiveAutoplays||2,E=A.initParams().autoplayInterrupterTimestamp||12e4,N=!0,f=t}function p(){C.pause(),f.classList.add(w),f.appendChild(c()),requestAnimationFrame(function(){g.classList.add(k),P.fireEvent(P.knownEvents.SHOW_AUTOPLAY_INTERRUPTER)})}var h,v,E,f,g,_,b,y,w,k,T,x,L,A,P,I,O,C,S,N=!1,R=!1,D=e.cadmium.Logger.create("subview.autoplay.interrupter");return e.cadmium.UiEvents.addEventListener(e.cadmium.UiEvents.knownEvents.AUTOPLAY_NEXT_EPISODE,t),e.cadmium.UiEvents.addEventListener(e.cadmium.UiEvents.knownEvents.VIDEO_FIRST_PLAY,r),{init:m,deinit:d}}(),e.cadmium.ui.trickplayPreview=function(){"use strict";function t(){function e(e){if(z){var t=b.classList.contains(o);e&&t&&(b.classList.remove(o),G=null),e||t||(b.classList.add(o),G=null),n()}}if(z){var t=q+X.value,i=1e3*A.getFloored(t),o="no-preview";w.nodeValue=A.convert(t),L.setImageTagSourceAtTime(k,i,e)}}function n(){var e=X.relativePosition-1,t=G||P.getDimensions(b).w;b.style.left=Math.floor(e-t/2)+"px",T.style.left=Math.floor(e)+"px"}function i(e){var n=e?"add":"remove";b.classList[n](j),T.classList[n](j),window.requestAnimationFrame(t)}function o(){G=P.getDimensions(b).w}function r(e){b.contains(e.target)||(X=e.component.pointerEventData.drag.current,i(!1))}function s(e){e.dragging&&(X=e.pointerEventData.drag.current,i(X.animate))}function a(e){X=e.pointerEventData.drag.current,i(X.animate),T.classList.add(F),b.classList.add(F),window.requestAnimationFrame(function(){z&&(T.classList.add(W),b.classList.add(W),C.fireEvent(C.knownEvents.SHOWN_TRICKPLAY_PREVIEW))})}function l(e){var t=e.component;b.contains(e.target)?u(e):(X=t.pointerEventData.drag.current,i(!1))}function u(e){window.clearTimeout(Q),G=null,Q=window.setTimeout(p,J)}function c(e){window.clearTimeout(Q),X=e.component.pointerEventData.drag.current,G=P.getDimensions(b).w,Q=window.setTimeout(m,J)}function d(e){var t=S.getPaused();(T.classList.contains(W)||e.pointerType===R.touch)&&(X=e.component.pointerEventData.drag.current,S.seek(1e3*X.value),t||S.play(),c(e))}function m(){if(z){var e="add";window.clearTimeout(Q),i(!1),T.classList[e](F),b.classList[e](F),window.requestAnimationFrame(function(){z&&(T.classList[e](W),b.classList[e](W),C.fireEvent(C.knownEvents.SHOWN_TRICKPLAY_PREVIEW))})}}function p(){z&&(window.clearTimeout(Q),T.classList.remove(W),b.classList.remove(W),Y.fromEvent(b,"transitionend").takeUntil(H).filter(function(e){return"opacity"===e.propertyName}).take(1).doAction(function(){b.classList.contains(W)||(T.classList.remove(F),b.classList.remove(F),C.fireEvent(C.knownEvents.HIDDEN_TRICKPLAY_PREVIEW))}).subscribe(B,D.getErrorHandler("event|transitionend"),B))}function h(){V=O.getActiveVideo();var e=N.getClipValues(V.id);q=e&&e.start/1e3||0}function v(){k=null,y=P.create("time"),w=y.appendChild(document.createTextNode("0")),b=P.create("section",{"class":"trickplay-preview no-preview"}),b.appendChild(y),M.wrapperEl.appendChild(b),T=P.create("div",{"class":"trickplay-position"},M.progressEl),null!==k&&P.remove(k),k=P.create("img",{"class":"trickplay-image"},b)}function E(){function e(e,t,n){return Y.fromEvent(e,t).takeUntil(H).doAction(n)}var t=M.knownEvents,n=Y.merge(e(M,t.MOUSE_ENTER,c),e(M,t.MOUSE_MOVE,l),e(M,t.MOUSE_LEAVE,u),e(M,t.DRAG_START,o),e(M,t.NEW_VALUE,s),e(M,t.DRAG_END,r),e(M,t.CLICK,d)),i=Y.fromEvent(M,t.NEW_VALUE),m=Y.fromEvent(C,C.knownEvents.DRAG_MODE_ENTER),p=Y.fromEvent(C,C.knownEvents.KEYBOARD_SEEK_ENTER);m.startWith(null).takeUntil(H).flatMap(function(){return n.takeUntil(p)}).subscribe(B,D.getErrorHandler("uievent|DRAG_MODE_ENTER"),B),p.takeUntil(H).flatMap(function(){return i.takeUntil(m).throttle(10)}).doAction(a).subscribe(B,D.getErrorHandler("uievent|KEYBOARD_SEEK_ENTER"),B),Y.fromEvent(C,C.knownEvents.CINEMA_MODE_ENTER).takeUntil(H).doAction(u).subscribe(B,D.getErrorHandler("uievent|CINEMA_MODE_ENTER"),B),Y.fromEvent(C,C.knownEvents.METADATA_LOADED).merge(Y["return"](V&&V.id===I.videoId())).takeUntil(H).filter(function(e){return!!e}).doAction(h).subscribe(B,D.getErrorHandler("uievent|METADATA_LOADED"),B)}function f(){z&&(z=!1,H.onNext(),window.clearTimeout(Q),P.remove([T,b]),_=null,b=null,y=null,w=null,k=null,T=null,G=null,x=null,L=null,A=null,P=null,I=null,O=null,C=null,S=null,N=null,R=null,D=null,M=null,U=null,H=null,B=null,V=null,X=null,K=null,Q=null,j=null,F=null,W=null)}function g(t){z&&f(),z=!0,_=t,x=e.cadmium,L=x.trickplay,A=x.time,P=x.element,I=x.objects,C=x.UiEvents,O=x.metadata,N=x.clips,S=I.videoPlayer(),R=x.browser.pointerTypes,D=x.Logger.create("subview.trickplay.preview"),j=P.classNames.animate,F=P.classNames.visible,W=P.classNames.active,B=x.util.NOOP,X={value:null,relativePosition:null,absolutePosition:null,wrapperDimensions:null},H=new Rx.Subject,q=0,M=x.ui.scrubber.getScrubberComponent(),V=O.getActiveVideo(),U=x.ui.scrubber.getLabelEl(),v(),E()}var _,b,y,w,k,T,x,L,A,P,I,O,C,S,N,R,D,M,U,H,B,V,j,F,W,z=!1,G=null,Y=Rx.Observable,q=0,K=null,X={value:null,relativePosition:null,absolutePosition:null,wrapperDimensions:null},Q=null,J=300;return{init:g,deinit:f,hideTrickplayPreview:p}}(),e.cadmium.ui.scrubber=function(){"use strict";function t(e,t){I&&O&&t&&_.update(D,e.duration,e.buffer)}function n(e){if(I&&(S.firstChild.nodeValue=y.convert(e.duration-D),!M||M!==e.duration)){M=e.duration;var t=M>U?"add":"remove",n="player-long-title";S.classList[t](n)}}function i(){if(I){var e=x.getCurrentTime()/1e3,i=x.getBufferedTime()/1e3;if(!_.dragging&&R&&e!==D){D=e;var o={currentTime:e,duration:x.getDuration()/1e3,buffer:i};t(o,!0),n(o)}}}function o(e){t({currentTime:e.value,duration:e.max},!1)}function r(){_.snapbackDragEl.classList.add(w.classNames.active),R||(R=!0,k.fireEvent(k.knownEvents.DRAG_MODE_ENTER)),k.fireEvent(k.knownEvents.DRAG_START_SCRUBBER)}function s(e,t){x.seek(1e3*t.value),t.pointerEventData.playing&&x.play(),_.snapbackDragEl.classList.remove(w.classNames.active),k.fireEvent(k.knownEvents.DRAG_FINISH_SCRUBBER)}function a(){C.classList.add(A)}function l(){C.classList.remove(A)}function u(){O=!1}function c(){O=!0,i()}function d(e){x.getPaused()||x.pause(),setTimeout(function(){_.incrementScrubberPosition(e),R&&(k.fireEvent(k.knownEvents.KEYBOARD_SEEK_ENTER),R=!1),_.fireEvent(_.knownEvents.NEW_VALUE,[_])},1)}function m(){d(N)}function p(){d(-1*N)}function h(){x.getPaused()||R||(x.seek(1e3*_.value),R=!0,k.fireEvent(k.knownEvents.DRAG_MODE_ENTER),P.hideTrickplayPreview())}function v(){_.incrementScrubberPosition(0),_.fireEvent(_.knownEvents.NEW_VALUE,[_])}function E(){S=w.create("label",{},C),S.appendChild(document.createTextNode(0))}function f(){I&&(P.deinit(),_.destroy(),_.removeEventListener(_.knownEvents.NEW_VALUE,o),_.removeEventListener(_.knownEvents.DRAG_END,s),_.removeEventListener(_.knownEvents.DRAG_START,r),k.removeEventListener(k.knownEvents.SHOW_MENU,a),k.removeEventListener(k.knownEvents.HIDE_MENU,l),k.removeEventListener(k.knownEvents.CINEMA_MODE_ENTER,u),k.removeEventListener(k.knownEvents.CINEMA_MODE_EXIT,c),k.removeEventListener(k.knownEvents.WINDOW_RESIZE,v),x.removeEventListener("currenttimechanged",i),x.removeEventListener("durationchanged",i),x.removeEventListener("bufferedtimechanged",i),L.removeEventListener(L.knownEvents.SEEK_FORWARD,m),L.removeEventListener(L.knownEvents.SEEK_BACKWARD,p),x.removeEventListener("pausedchanged",h),w.remove(S),C=null,S=null,_=null,b=null,y=null,w=null,k=null,T=null,x=null,L=null,A=null,D=0,P=null,I=!1,M=!1)}function g(n){I&&f(),I=!0,C=n,b=e.cadmium,k=b.UiEvents,w=b.element,y=b.time,T=b.objects,L=b.keyboard,x=T.videoPlayer(),A=w.classNames.hidden,E(),_=new b.ui.ScrubberComponent(C),P=b.ui.trickplayPreview,P.init(C),_.addEventListener(_.knownEvents.NEW_VALUE,o),_.addEventListener(_.knownEvents.DRAG_START,r),_.addEventListener(_.knownEvents.DRAG_END,s),k.addEventListener(k.knownEvents.SHOW_MENU,a),k.addEventListener(k.knownEvents.HIDE_MENU,l),k.addEventListener(k.knownEvents.CINEMA_MODE_ENTER,u),k.addEventListener(k.knownEvents.CINEMA_MODE_EXIT,c),k.addEventListener(k.knownEvents.WINDOW_RESIZE,v),L.addEventListener(L.knownEvents.SEEK_FORWARD,m),L.addEventListener(L.knownEvents.SEEK_BACKWARD,p),x.addEventListener("pausedchanged",h),x.addEventListener("currenttimechanged",i),x.addEventListener("durationchanged",i),x.addEventListener("bufferedtimechanged",i),requestAnimationFrame(function(){I&&(t({currentTime:x.getCurrentTime()/1e3,buffer:x.getBufferedTime()/1e3,duration:x.getDuration()/1e3},!0),c())})}var _,b,y,w,k,T,x,L,A,P,I=!1,O=!0,C=null,S=null,N=10,R=!0,D=0,M=!1,U=36e5;return{init:g,deinit:f,getLabelEl:function(){return S},getScrubberComponent:function(){return _}}}(),e.cadmium.ui.longpause=function(){"use strict";function t(t){A&&i(),d=e.cadmium,m=Rx.Observable,p=d.metadata,h=d.objects,v=d.element,E=d.time,f=d.animate,g=e.I18n,_=d.UiEvents,b=d.Logger.create("subview.longpause"),y=v.create,w=d.util.NOOP,k=v.classNames.hidden,T=t,P=new Rx.Subject,p.getMetadata()?n():m.fromEvent(_,_.knownEvents.METADATA_LOADED).takeUntil(P).take(1).doAction(n).subscribe(w,b.getErrorHandler("event|METADATA_LOADED"),w)}function n(){o(),a(),A=!0}function i(){A&&(A=!1,P.onNext(),v.remove(x),T=null,x=null,L=null,P=null,d=null,m=null,p=null,h=null,v=null,E=null,f=null,g=null,_=null,b=null,y=null,w=null,k=null)}function o(){var e=p.getMetadata();x=y("div",{"class":"playback-longpause-container opacity-transparent display-none player-hidden"}),L=y("div",{"class":"content"},x),y("p",{id:"p-label"},x).textContent=g.get("ce-long-pause-paused"),y("p",{id:"yw-label"},L).textContent=g.get("ce-long-pause-youre-watching"),p.isShowData(e)?s(e):r(e),T.appendChild(x)}function r(e){var t=y("h2",{},L),n=y("h3",{},L),i=y("span",{},n),o=y("span",{},n),r=y("span",{},n),s=y("p",{},L),a=e.video;a.title&&(t.textContent=a.title),a.year&&(i.textContent=a.year),a.rating&&(o.textContent=a.rating),a.runtime&&(r.textContent=E.convertUsingKey(a.runtime,!1,!0,"ce-time")),a.synopsis&&(s.textContent=a.synopsis)}function s(e){var t=y("h2",{},L),n=y("h3",{},L),i=y("h3",{},L),o=y("p",{},L),r=e.video,s=p.getActiveSeason(),a=p.getActiveVideo();r.title&&(t.textContent=r.title),s&&a&&(n.innerHTML=s.title+": "+g.get("ce-episode-abbreviation")+" "+a.seq,a.title&&(i.textContent=a.title),a.synopsis&&(o.textContent=a.synopsis))}function a(){var e=m.fromEvent(_,_.knownEvents.CINEMA_MODE_ENTER),t=m.fromEvent(_,_.knownEvents.CINEMA_MODE_EXIT),n=m.fromEvent(_,_.knownEvents.PAUSE_TOGGLED).filter(function(e){return e}),i=m.fromEvent(_,_.knownEvents.PAUSE_TOGGLED).filter(function(e){return!e});n.takeUntil(P).flatMap(function(){b.log("User initiated pause.");var n=e.filter(function(){return c()}).takeUntil(i).flatMap(function(){return m.timer(I).takeUntil(t).doAction(l)}),o=m.merge(i,t).doAction(u);return m.merge(n,o)}).subscribe(w,b.getErrorHandler("event|PAUSE_TOGGLED"),w)}function l(){return A?c()?void requestAnimationFrame(function(){f.fadeIn(x),requestAnimationFrame(function(){x.classList.remove(k)})}):void b.error("Show pause screen called but player is not in a paused state."):void 0}function u(){A&&(x.classList.add(k),f.fadeOut(x))}function c(){return h.videoPlayer().getPaused()}var d,m,p,h,v,E,f,g,_,b,y,w,k,T,x,L,A,P,I=1e4;return{init:t,deinit:i}}(),e.cadmium.ui.mdx=function(){function t(){return null===E&&(E=u.create("div",{"class":["player-mdx","player-control-button icon-player-mdx",p].join(" ")})),E}function n(){h.hasCastTargets=!1,E.classList.add(p)}function i(){h.hasCastTargets=!0,E.classList.remove(p)}function o(){m.isFullscreen()&&m.exit(),h.showCastDialog()}function r(){d.removeEventListener(d.knownEvents.MDX_LOADED,r),h=c.mdxManager(),
E.addEventListener("click",o),h.addEventListener(h.EVENTS.castDevicesAvailable,i),h.addEventListener(h.EVENTS.castDevicesUnavailable,n),h.hasCastTargets&&i()}function s(n){return v&&a(),e.cadmium.objects.initParams().mdxEnabled?(v=!0,l=e.cadmium,c=l.objects,d=e.cadmium.UiEvents,m=e.cadmium.fullscreen,u=l.element,p=u.classNames.hidden,n.appendChild(t()),h=c.mdxManager(),h&&h.mdxEnabled?r():(d.addEventListener(d.knownEvents.MDX_LOADED,r),e.mdx.bootstrap.readyToInit()&&e.mdx.bootstrap.tryInitMdx()),E):void 0}function a(){v&&(d.removeEventListener(d.knownEvents.MDX_LOADED,this._mdxLoadedHandler,this),u.remove(E),h&&(E.removeEventListener("click",o),h.removeEventListener(h.EVENTS.castDevicesAvailable,i),h.removeEventListener(h.EVENTS.castDevicesUnavailable,n)),E=null,h=null,l=null,u=null,c=null,d=null,m=null,p=null,v=!1)}var l,u,c,d,m,p,h,v,E=null;return{init:s,deinit:a}}(),e.cadmium.ui.pauser=function(){"use strict";function t(){return null===b&&(b=h.create("div",{"class":"player-control-button player-play-pause pause "+L})),b}function n(){_&&(E.getPaused()?(b.classList.remove(T),b.classList.remove(L),b.classList.add(k),b.classList.add(x)):(b.classList.remove(k),b.classList.remove(x),b.classList.add(T),b.classList.add(L)))}function i(){E.getPaused()?E.play():E.pause(),f.fireEvent(f.knownEvents.PAUSE_TOGGLED,[E.getPaused()])}function o(){w=!1}function r(){w=!0}function s(e){(e.target===b||e.target===m)&&i()}function a(e){!y&&w&&e.target===document.body&&(e.preventDefault(),i())}function l(e){y="focus"===e.type}function u(){_&&(_=!1,E.removeEventListener("pausedchanged",n),b.removeEventListener("click",s),b.removeEventListener("focus",l),b.removeEventListener("blur",l),f.removeEventListener(f.knownEvents.SHOW_AUTOPLAY_INTERRUPTER,o),f.removeEventListener(f.knownEvents.HIDE_AUTOPLAY_INTERRUPTER,r),g.removeEventListener(g.knownEvents.TOGGLE_PLAY,a),h.remove(b),d=null,b=null,m=null,p=null,h=null,v=null,E=null,f=null,g=null)}function c(i){return _&&u(),_=!0,d=i,y=!1,p=e.cadmium,h=p.element,v=p.objects,E=v.videoPlayer(),f=p.UiEvents,g=p.keyboard,d.appendChild(t()),n(),E.addEventListener("pausedchanged",n),b.addEventListener("click",s),b.addEventListener("focus",l),b.addEventListener("blur",l),g.addEventListener(g.knownEvents.TOGGLE_PLAY,a),f.addEventListener(f.knownEvents.SHOW_AUTOPLAY_INTERRUPTER,o),f.addEventListener(f.knownEvents.HIDE_AUTOPLAY_INTERRUPTER,r),b}var d,m,p,h,v,E,f,g,_=!1,b=null,y=!1,w=!0,k="play",T="pause",x="icon-player-play",L="icon-player-pause";return{init:c,deinit:u}}(),e.cadmium.ui.volume=function(){function t(e){m.menuEl.contains(e.target)||m.toggleMute()}function n(){return null===u&&(u=s.create("div",{"class":"player-control-button volume icon-player-volume-full"}),m=new r.ui.VolumeMenuComponent(u,u,{id:"player-menu-volume",volumeTextNode:d})),u}function i(){u.removeEventListener("click",t),m&&m.destroy(),a=!1,l=null,u=null,c=null,d=null,m=null,r=null,s=null}function o(o){return a&&i(),a=!0,l=o,r=e.cadmium,s=r.element,l.appendChild(n()),u.addEventListener("click",t),u}var r,s,a=!1,l=null,u=null,c=null,d=null,m=null;return{init:o,deinit:i}}(),e.cadmium.ui.status=function(){"use strict";function t(){var t,n,i,o=a.getMetadata();if(o)i="<span class='player-status-main-title'>"+o.video.title+"</span>",a.videoIsKnown(c.videoId())&&(t=a.getActiveVideo(),n=a.isShowData(o),n&&t&&(i+=e.I18n.getWithParams("ce-status-episodic-title",["SEASON_TITLE","EPISODE","EPISODE_TITLE"],[a.getActiveSeason().title,t.seq,t.title]))),m.innerHTML=i;else if(s.ui.preplay.preplayNeeded()){var r=c.initParams().preplay,l=r?r.movieTitle:"";l=decodeURIComponent(l.replace(/\+/g,"%20")),m.innerHTML="<span class='player-status-main-title'>"+l+"</span>"}}function n(){return null===m&&(m=l.create("div",{"class":"player-status"})),m}function i(){d&&(d=!1,u.removeEventListener(u.knownEvents.METADATA_LOADED,t),l.remove(m),r=null,m=null,s=null,a=null,l=null,u=null,c=null)}function o(o){return d&&i(),d=!0,r=o,s=e.cadmium,a=s.metadata,l=s.element,u=s.UiEvents,c=s.objects,u.addEventListener(u.knownEvents.METADATA_LOADED,t),r.appendChild(n()),t(),m}var r,s,a,l,u,c,d=!1,m=null;return{init:o,deinit:i}}(),e.cadmium.ui.nextEpisode=function(){function t(){return null===f&&(f=c.create("div",{"class":["player-control-button","player-next-episode icon-player-next-episode",v].join(" ")})),f}function n(e){if(f.contains(e.target)){var t=p.initParams()||{},n=u.getNextEpisode().id;d.setNextVideo(d.CONSTANTS.EPISODE_ID,n,t.trackIdNextEpisode||0),l.ui.master.updateInitParams(t,null)}}function i(){var e=p.videoId(),t=u.videoIsKnown(e),n=t&&null!==u.getNextEpisode();n&&!h.getClipValues(e)?(f.classList.remove(v),g=new l.ui.NextEpisodeMenuComponent(f,f,{id:"player-menu-next-episode"})):f.classList.add(v)}function o(){E&&(E=!1,null!==g&&g.destroy(),m.removeEventListener(m.knownEvents.METADATA_LOADED,i),f.removeEventListener("click",n),c.remove(f),s=null,f=null,a=null,g=null,l=null,u=null,c=null,d=null,m=null,p=null,h=null,v=null)}function r(r){return E&&o(),E=!0,s=r,l=e.cadmium,u=l.metadata,c=l.element,d=l.url,m=l.UiEvents,p=l.objects,h=l.clips,v=c.classNames.hidden,s.appendChild(t()),m.addEventListener(m.knownEvents.METADATA_LOADED,i),f.addEventListener("click",n),i(),f}var s,a,l,u,c,d,m,p,h,v,E=!1,f=null,g=null;return{init:r,deinit:o}}(),e.cadmium.ui.episodeSelector=function(){"use strict";function t(e){var t=m.initParams()||{};h.setNextVideo(h.CONSTANTS.EPISODE_ID,e.videoId,t.trackIdEpisodeSelector),l.ui.master.updateInitParams(m.initParams(),null)}function n(){return null===f&&(f=c.create("div",{"class":["player-control-button","player-episode-selector icon-player-episode-selector",v].join(" ")})),f}function i(){var e=m.videoId(),n=u.videoIsKnown(e),i=n&&u.getTotalEpisodeCount(e)>1;i&&!p.getClipValues(e)?(f.classList.remove(v),g=g||new l.ui.EpisodeSelectorMenuComponent(f,f,{id:"player-menu-episode-selector"}),g.addEventListener(g.CHANGE_VIDEO_EVENT,t)):f.classList.add(v)}function o(){E&&(E=!1,null!==g&&(g.removeEventListener(g.CHANGE_VIDEO_EVENT,t),g.destroy()),g=null,d.removeEventListener(d.knownEvents.METADATA_LOADED,i),c.remove(f),s=null,f=null,a=null,l=null,u=null,c=null,d=null,m=null,p=null,h=null,v=null)}function r(t){return l=e.cadmium,m=l.objects,E&&o(),E=!0,s=t,u=l.metadata,c=l.element,d=l.UiEvents,p=l.clips,h=l.url,v=c.classNames.hidden,s.appendChild(n()),d.addEventListener(d.knownEvents.METADATA_LOADED,i),i(),f}var s,a,l,u,c,d,m,p,h,v,E=!1,f=null,g=null;return{init:r,deinit:o}}(),e.cadmium.ui.audio=function(){"use strict";function t(){return null===g&&(g=c.create("div",{"class":["player-control-button","player-audio-select icon-player-subtitle-selector",E].join(" ")})),g}function n(){(h.getAudioTrackList().length>1||h.getTimedTextTrackList().length>1)&&g.classList.remove(E)}function i(){f&&(f=!1,a.destroy(),d.removeEventListener(m.METADATA_LOADED,n),c.remove(g),r=null,g=null,s=null,a=null,l=null,u=null,c=null,d=null,m=null,p=null,h=null,v=null,E=null)}function o(o){return f&&i(),f=!0,r=o,l=e.cadmium,u=l.metadata,c=l.element,d=l.UiEvents,m=d.knownEvents,p=l.objects,h=p.videoPlayer(),v=l.session,E=c.classNames.hidden,r.appendChild(t()),a=new l.ui.AudioSubtitleMenuComponent(g,g,{id:"player-menu-track-settings"}),d.addEventListener(m.METADATA_LOADED,n),n(),g}var r,s,a,l,u,c,d,m,p,h,v,E,f=!1,g=null;return{init:o,deinit:i}}(),e.cadmium.ui.fullscreen=function(){"use strict";function t(e){e?(g.classList.add(b),g.classList.remove(_)):(g.classList.add(_),g.classList.remove(b))}function n(){return null===g&&(g=m.create("div",{"class":"player-control-button player-fill-screen"})),t(h.isFullscreen()),g}function i(e){var t=e.target;g.contains(t)&&h.toggle()}function o(e){var t=e.target,n=l.parentNode;n.contains(t)||h.toggle()}function r(){g.addEventListener("click",i),u.addEventListener("dblclick",o,!1),p.addEventListener(p.knownEvents.FULLSCREEN_CHANGE,t)}function s(){f&&(f=!1,g.removeEventListener("click",i),u.removeEventListener("dblclick",o,!1),p.removeEventListener(p.knownEvents.FULLSCREEN_CHANGE,t),m.remove(g),l=null,g=null,u=null,c=null,d=null,m=null,p=null,h=null,v=null,E=null)}function a(t){return f&&s(),c=e.cadmium,m=c.element,d=c.objects,p=c.UiEvents,h=c.fullscreen,v=c.Logger.create("subview.fullscreen"),E=c.util,v.log("init"),u=d.playerWrapper(),l=t,g=n(),r(),l.appendChild(g),f=!0,g}var l,u,c,d,m,p,h,v,E,f=!1,g=null,_="icon-player-full-screen",b="icon-player-windowed-screen";return{init:a,deinit:s}}(),e.cadmium.ui.preplay=function(){"use strict";function t(){var t=e.cadmium&&e.cadmium.objects&&"function"==typeof e.cadmium.objects.initParams&&e.cadmium.objects.initParams().recap;return t&&t.movieId&&!t.hasPlayed}function n(){u.removeAttribute("style");var e=A.initParams();e.recap.hasPlayed=!0,L.ui.master.updateInitParams(e)}function i(){n()}function o(){n()}function r(n){if(T&&s(),t()){L=e.cadmium,A=L.objects,_=L.metadata,b=L.element,y=L.UiEvents,w=A.videoPlayer(),k=e.I18n,g=A.initParams().recap,T=!0,f=new Rx.Subject,u=document.getElementsByClassName("player-video-wrapper")[0],l=n,n.classList.add(x),d=b.create("div",{id:"preplay-bg"},n),d.style.cssText="background-image: url("+g.backgroundImage+");",c=b.create("div",{id:"video-bg"},u),m=b.create("div",{"class":"preplay-header"},u),p=b.create("div",{id:"preplay-logo"},m),h=b.create("span",{id:"preplay-text-recap"},m);var r=g.seasonNumber;p.style.cssText="background-image: url("+g.logoImage+");",h.textContent=k.getWithParams("ce-season-recap-text",["SEASON"],[r]),v=b.create("div",{},u),E=new L.ui.Button(v,{id:"preplay-skip-button",contentsEl:document.createTextNode(k.getWithParams("ce-start-next-season-button",["SEASON"],[r+1]))}),P.fromEvent(E,E.knownEvents.CLICK).takeUntil(f).take(1).subscribe(i);var O=w.getVideoSize();I=O.width/O.height,a(),P.fromEvent(y,y.knownEvents.WINDOW_RESIZE).takeUntil(f).subscribe(a),P.fromEvent(y,y.knownEvents.VIDEO_ENDED).takeUntil(f).take(1).subscribe(o)}}function s(){T&&(f.onNext(),l.classList.remove(x),E&&E.destroy(),b.remove(d),b.remove(m),b.remove(c),b.remove(v),A.clearTrackId(),T=!1,l=null,u=null,c=null,d=null,m=null,p=null,h=null,v=null,E=null,f=null,g=null,L=null,A=null,_=null,b=null,y=null,w=null,k=null,I=null)}function a(){window.requestAnimationFrame(function(){var e,t,n=b.getDimensions(l);n.w/n.h>I?(t=.7*n.h,e=t*I):(e=.7*n.w,t=e/I),u.style.width=e+"px",u.style.height=t+"px"})}var l,u,c,d,m,p,h,v,E,f,g,_,b,y,w,k,T=!1,x="player-preplay",L=e.cadmium,A=L.objects,P=Rx.Observable,I=null;return{init:r,deinit:s,preplayNeeded:t}}(),e.cadmium.ui.incognito=function(){function t(){return null===g&&(g=u.create("div",{"class":["player-control-button","player-incognito",p].join(" ")})),g}function n(){if(m&&m.enabled===!0){g.classList.remove(p),g.classList.add("player-incognito--"+m.mode);var e=b[m.mode];e?(h=u.create("span"),h.appendChild(document.createTextNode(b[m.mode])),g.appendChild(h)):(v=document.createElement("div"),v.innerHTML=y.SHARED,g.appendChild(v),Rx.Observable.fromEvent(d,d.knownEvents.INCOGNITO_CHANGED).takeUntil(E).subscribe(i)),_=_||new a.ui.IncognitoMenuComponent(g,g,{id:"player-menu--incognito"}),m.autoshow&&(_.showTickler(),_.sendIncognitoReq({method:"auto"})),Rx.Observable.fromEvent(g,"click").takeUntil(E).filter(function(e){return!_.isLoading()&&!_.menuEl.contains(e.target)}).subscribe(_.toggleIncognito)}}function i(e){v.innerHTML=e.isIncognito?y.PRIVATE:y.SHARED}function o(){f&&(f=!1,_&&_.destroy(),_=null,u.remove(g),d.removeEventListener(d.knownEvents.INCOGNITO_CHANGED,i),E.onNext(),g=null,s=null,a=null,l=null,u=null,c=null,d=null,m=null,p=null,h=null)}function r(i){f&&o(),a=e.cadmium,c=a.objects;var r=c.videoPlayer();return r&&r.getXid&&r.getXid()?(f=!0,s=i,l=a.metadata,u=a.element,d=a.UiEvents,p=u.classNames.hidden,m=c.initParams().incognitoConfig,E=new Rx.Subject,s.appendChild(t()),n(),g):void 0}var s,a,l,u,c,d,m,p,h,v,E,f=!1,g=null,_=null,b={history:"a",anonymous:"b","private":"c"},y={SHARED:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 144 144" enable-background="new 0 0 144 144" xml:space="preserve"><g class="sauron" id="sauron-open"><path d="M114.1,66.4c-7.5-8.5-23.6-24-42.3-24S37,57.8,29.6,66.4c-2.7,3.1-2.7,7.8,0,10.9c7.5,8.5,23.6,24,42.3,24s34.8-15.5,42.3-24C116.8,74.2,116.8,69.5,114.1,66.4zM105.5,76.2C99.5,83,86.7,95.3,71.8,95.3c-14.9,0-27.7-12.3-33.7-19.1c-2.2-2.5-2.2-6.2,0-8.7c5.9-6.8,18.8-19.1,33.7-19.1c14.9,0,27.7,12.3,33.7,19.1C107.7,70,107.7,73.7,105.5,76.2z"/><path d="M71.8,58C64.2,58,58,64.2,58,71.8s6.2,13.8,13.8,13.8s13.8-6.2,13.8-13.8S79.5,58,71.8,58zM71.8,82c-5.6,0-10.2-4.6-10.2-10.2c0-5.6,4.6-10.2,10.2-10.2c5.6,0,10.2,4.6,10.2,10.2C82,77.5,77.4,82,71.8,82z"/></g></svg>',PRIVATE:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 144 144" enable-background="new 0 0 144 144" xml:space="preserve"><g class="sauron" id="sauron-closed"><path fill="none" d="M72.5,83.1c5.6,0,10.2-4.6,10.2-10.2c0-2.4-0.8-4.5-2.2-6.3L66.2,80.9C68,82.3,70.1,83.1,72.5,83.1z"/><path fill="none" d="M91.5,55.7L83.1,64c2,2.4,3.3,5.5,3.3,8.9c0,7.6-6.2,13.8-13.8,13.8c-3.4,0-6.5-1.2-8.9-3.3l-8,8c5.1,2.9,10.8,5,16.8,5c14.9,0,27.7-12.3,33.7-19.1c2.2-2.5,2.2-6.2,0-8.7C103,64.9,97.8,59.7,91.5,55.7z"/><path d="M45,83.6l33.5-33.5l4.9-4.9c-3.5-1.1-7.2-1.7-11-1.7c-18.7,0-34.8,15.5-42.3,24c-2.7,3.1-2.7,7.8,0,10.9c2.5,2.8,5.9,6.4,10,9.9L45,83.6z"/><path d="M114.8,67.4c-4-4.6-10.6-11.2-18.7-16.4l9.1-9.1c0.6-0.6,0.6-1.7,0-2.4l-0.4-0.4c-0.6-0.6-1.7-0.6-2.4,0l-64.2,64.2c-0.6,0.6-0.6,1.7,0,2.4l0.4,0.4c0.6,0.6,1.7,0.6,2.4,0L51.1,96c6.4,3.7,13.7,6.4,21.4,6.4c18.7,0,34.8-15.5,42.3-24C117.5,75.3,117.5,70.6,114.8,67.4zM82.7,72.9c0,5.6-4.6,10.2-10.2,10.2c-2.4,0-4.5-0.8-6.3-2.2l14.2-14.2C81.8,68.4,82.7,70.5,82.7,72.9zM106.2,77.3c-5.9,6.8-18.8,19.1-33.7,19.1c-6.1,0-11.8-2.1-16.8-5l8-8c2.4,2,5.5,3.3,8.9,3.3c7.6,0,13.8-6.2,13.8-13.8c0-3.4-1.2-6.5-3.3-8.9l8.4-8.4c6.4,4.1,11.5,9.3,14.7,12.9C108.3,71.1,108.3,74.8,106.2,77.3z"/></g></svg>'};return{init:r,deinit:o}}(),e.cadmium.ui.popup=function(){"use strict";var t,n=e.cadmium,i=n.element,o=null,r=[],s=!1,a=!1,l={CONTAINER_CLASS:"popup-dialog-container",MESSAGE_CLASS:"popup-dialog-message",BUTTON_CONTAINER_CLASS:"popup-buttons-container"},u=function(){var e=r.pop();s=!0,o=i.create("div",{"class":l.CONTAINER_CLASS}),i.create("h2",{"class":l.MESSAGE_CLASS},o).appendChild(document.createTextNode(e.title)),i.create("p",{"class":l.MESSAGE_CLASS},o).appendChild(document.createTextNode(e.message));for(var n=i.create("div",{"class":l.BUTTON_CONTAINER_CLASS}),a=0;a<e.choices.length;a++){var u=e.choices[a],c=i.create("button",{},n);c.appendChild(document.createTextNode(u.text)),u.onClick&&c.addEventListener("click",u.onClick)}o.appendChild(n),t.appendChild(o)},c=function(){i.remove(o),o=null,s=!1,r.length>0&&u()},d=function(t,n){m(t,n,[{text:e.I18n.get("ce-error-dialog-button-ok"),onClick:c}])},m=function(e,t,n){r.push({title:e,message:t,choices:n}),s||u()},p=function(){i.remove(o),o=null,r=null,t=null,s=!1,a=!1},h=function(e){a||p(),a=!0,t=e,r=[]};return{init:h,deinit:p,queueDialog:m,showGenericError:d,closeDialog:c}}(),e.cadmium.ui.pinentry=function(){"use strict";function t(){q=_.create("div",{"class":"pin-entry"});var e=_.create("div",{id:"pin-buttons"},q),t=_.create("div",{"class":"play-button-content"}),n=_.create("span",{},t),i=_.create("p",{},t);n.textContent="",i.textContent=T.get("ce-pin-play"),J=new g.ui.PIN(q),X=new g.ui.Button(e,{"class":"pin-play-button disabled",contentsEl:t}),Q=new g.ui.Button(e,{"class":"pin-cancel-button",contentsEl:document.createTextNode(T.get("ce-pin-cancel"))}),ee=[J,X,Q],K=_.create("h2",{"class":"pin-title"},q),K.textContent=T.get("ce-enter-pin"),Z=_.create("p",{"class":"pin-forgot"},q),Z.textContent=T.get("ce-forgot-pin"),J.pinEl.tabIndex=1,Z.tabIndex=2,X.buttonEl.tabIndex=3,Q.buttonEl.tabIndex=4,$=document.querySelector(".player-progress-loading")}function n(){var t;q=A({"class":"pin-entry"},P({},T.get("ce-adult-verification-message")),t=A({id:"pin-buttons"}));var n=new g.ui.Button(t,{"class":"pin-play-button",contentsEl:document.createTextNode(T.get("ce-verify-age"))}),i=new g.ui.Button(t,{"class":"pin-cancel-button",contentsEl:document.createTextNode(T.get("ce-pin-cancel"))});Y.appendChild(q),w.fromEvent(n,"click").take(1).doAction(function(){window.location.replace(C)}).subscribe(),w.fromEvent(i,"click").take(1).doAction(function(){e.cadmium.ui.master.goBackToBrowsing(),f()}).subscribe(),requestAnimationFrame(function(){G&&q.classList.add(U)}),$=document.querySelector(".player-progress-loading"),$&&$.classList.add(B)}function i(){var e=function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return{valid:e.success}},t=function(e){return 401===e.status?w["return"](e.responseText||{success:!1}):w["throw"](e)},n=function(e){return w["return"]({error:e.status})},i=function(){return X.enabled},a=function(){X.enabled=!1},l=w.fromEvent(Q,"click"),c=function(){var i={withCredentials:!0,urlEncoded:!0,data:{pin:d()}};return y.post(I,i).takeUntil(ne).takeUntil(l).timeout(S)["catch"](t).retryWithBackoff(N,R).map(e)["catch"](n)},m=w.fromEvent(Z,"keyup").filter(function(e){return e.keyCode===W||e.keyCode===z});l.takeUntil(ne).take(1).doAction(s).subscribe(L,o,L),w.fromEvent(X,"click").takeUntil(ne).filter(i).doAction(a).flatMap(c).doAction(r).subscribe(L,o,L),w.merge(w.fromEvent(Z,"click"),m).takeUntil(ne).doAction(u).subscribe(L,o,L),w.fromEvent(J,"complete").takeUntil(ne).doAction(function(){X.enabled=!0}).subscribe(L,o,L),w.fromEvent(J,"enter").takeUntil(ne).doAction(function(){X.focus(),J.blur()}).doAction(a).flatMap(c).doAction(r).subscribe(L,o,L),w.fromEvent(J,"input").takeUntil(ne).doAction(function(){X.enabled=!1}).subscribe(L,o,L)}function o(e){x.log("subview.pin.entry",e&&e.stack||e)}function r(e){e=e||{},e.valid===!0?m():e.valid===!1?(l(T.get("ce-invalid-pin")),c(),J.clear().focus()):(l(T.get("ce-pin-network-error")),X.enabled=!0)}function s(){p()}function a(e){var t=e.data||{};"pinReset"===t.state&&"success"===t.status&&m()}function l(e){K.innerHTML=e}function u(){var t="";try{t=e.constants.page.xsrf}catch(n){}te=b.open({url:O+"?authurl="+t,name:j,features:F}),te.doAction(a).subscribe(L,o,L)}function c(){w.fromEvent(q,"webkitAnimationEnd").merge(w.fromEvent(q,"animationend")).take(1).doAction(function(){q.classList.remove(V)}).subscribe(L,o,L),q.classList.add(V)}function d(){return J.getValue()}function m(){ie.onNext(D)}function p(){ie.onNext(M)}function h(e,t){return E(e),ie.flatMap(function(e){return v().map(function(){return{pinStatus:e}}).doAction(function(){t&&f()})})}function v(){return q.classList.remove(U),q.classList.add(H),Rx.Observable.fromEvent(q,"transitionend").take(1).map(function(){return oe})}function E(o){G&&f(),G=!0,g=e.cadmium,_=g.element,b=g.popup,y=g.xhr,w=Rx.Observable,k=g.objects,T=e.I18n,x=g.logging,L=g.util.NOOP,A=g.dom.DIV,P=g.dom.H2,ne=new Rx.Subject,ie=new Rx.Subject,Y=o;var r=k.initParams().pinConfig||{},s=g.metadata.getActiveVideo()||{},a=!!s.requiresAdultVerification,l=!!r.isAdultVerified,u=!!r.adultVerificationEnabled;return C=r.adultVerificationURL||"/verifypin",a&&u&&!l?void n():(e.cadmium&&e.cadmium.ui&&e.cadmium.ui.master&&e.cadmium.ui.master.isAkira()?(I=r.pinApiEndpoint||"https://"+location.hostname+"/api/desktop/pin/service",O=r.resetURL||"https://"+location.hostname+"/player/pinreset"):(I=r.pinApiEndpoint||"https://api.netflix.com/desktop/pin/service",O=r.resetURL||"/player/pinreset"),t(),i(),Y.appendChild(q),requestAnimationFrame(function(){G&&(q.classList.add(U),J.focus())}),$&&$.classList.add(B),oe)}function f(){G&&($&&$.classList.remove(B),ne.onNext(),ee&&ee.forEach(function(e){e&&e.destroy()}),_.remove(q),G=!1,Y=null,q=null,K=null,X=null,Q=null,J=null,Z=null,$=null,ee=null,ne=null,ie=null,g=null,_=null,b=null,y=null,w=null,k=null,T=null,x=null,L=null)}var g,_,b,y,w,k,T,x,L,A,P,I,O,C,S=1e4,N=4,R=1e3,D="valid",M="canceled",U=e.cadmium.element.classNames.visible,H=e.cadmium.element.classNames.hidden,B="pin-active",V="shake",j="nf-pin-reset-popup",F={menubar:!1,resizable:!1,location:!0,width:440,height:330,scrollBars:!1,chrome:!0,centered:!0},W=13,z=32,G=!1,Y=null,q=null,K=null,X=null,Q=null,J=null,Z=null,$=null,ee=null,te=null,ne=null,ie=null,oe={init:E,deinit:f,show:h,hide:v,VALID:D,CANCELED:M};return oe}(),e.cadmium.ui.dontShare=function(){"use strict";function t(){return null===g&&(g=p({"class":["player-control-button","player-dont-share icon-player-dont-share",E].join(" ")})),g}function n(){var e=a.getMetadata(),t=e&&e.video&&e.video.social&&e.video.social.facebook&&e.video.social.facebook.do_not_share&&e.video.social.facebook.do_not_share.enabled,n=v.get("ce-dontshare-prompt"),i=n&&n.indexOf("MISSINGRESOURCE")<0,o=c.initParams().incognitoConfig;!t||!i||o&&o.enabled?g.classList.add(E):(g.classList.remove(E),_=new s.ui.DontShareMenuComponent(g,g,{id:"player-menu-dont-share"}),_.showTickler(b))}function i(){f&&(f=!1,null!==_&&_.destroy(),_=null,u.removeEventListener(u.knownEvents.METADATA_LOADED,n),l.remove(g),g=null),s=r=a=v=l=u=c=d=E=m=p=h=null}function o(o){return f&&i(),f=!0,r=o,s=e.cadmium,a=s.metadata,l=s.element,u=s.UiEvents,c=s.objects,d=s.clips,E=l.classNames.hidden,v=e.I18n,m=s.dom,p=m.get("DIV"),h=m.get("SPAN"),r.appendChild(t()),u.addEventListener(u.knownEvents.METADATA_LOADED,n),n(),g}var r,s,a,l,u,c,d,m,p,h,v,E,f=!1,g=null,_=null,b=2e3;return{init:o,deinit:i}}(),function(){"use strict";function t(){!f&&E&&(f=!0,u.fireEvent(u.knownEvents.CINEMA_MODE_EXIT),d.deinit(),a.queueDialog(e.I18n.get("ce-head-internet_connection_problem"),e.I18n.get("ce-text-internet_connection_problem"),[{text:e.I18n.get("ce-error-dialog-button-ok"),onClick:function(){n(),v.onNext("closed")}}]))}function n(){E&&f&&(a.closeDialog(),d.init(),f=!1)}function i(){var e=l.fromEvent(m,"busychanged").throttle(100).map(function(){return m&&m.getBusy()}),i=e.filter(function(e){return e&&e.progress>=0&&!e.networkStalled}).map(function(e){return e&&e.progress}).distinctUntilChanged(),o=e.filter(function(e){return e&&e.networkStalled}).map(function(e){return e&&e.networkStalled}).distinctUntilChanged(),r=l.fromEvent(m,"currenttimechanged").sample(300).distinctUntilChanged().take(3).takeLast(),s=l.merge(r,i,e.filter(function(e){return!e}));o.takeUntil(h).flatMap(function(){return l.merge(l["return"](),v).takeUntil(s).delay(g).doAction(t)}).subscribe(p,c.getErrorHandler("progressStalled"),p),s.takeUntil(h).doAction(n).subscribe(p,c.getErrorHandler("hideErrorDialog"),p)}function o(){E&&r(),E=!0,s=e&&e.cadmium||{},c=s.Logger&&s.Logger.create("view.network.error"),a=s.ui&&s.ui.popup,l=Rx.Observable,u=s.UiEvents,m=s.objects&&s.objects.videoPlayer&&s.objects.videoPlayer(),p=s.util&&s.util.NOOP,d=s.cinemamode,h=new Rx.Subject,v=new Rx.Subject,i()}function r(){E&&(E=!1,h&&h.onNext(),h=null,s=null,a=null,l=null,m=null,f=!1,p=null,u=null,d=null,v=null)}var s,a,l,u,c,d,m,p,h,v,E=!1,f=!1,g=3e3;e.cadmium.ui.NetworkError={init:o,deinit:r}}(),e.cadmium.ui.expiryNotice=function(){"use strict";function t(e){d.log("subview.expiry.notice",e&&e.stack||e)}function n(){a({method:A.NEVER_SHOW}).takeUntil(k).subscribe(g,t)}function i(){Rx.Observable.fromEvent(T,"click").doAction(n).merge(Rx.Observable.timer(A.NOTICE_DURATION)).take(1).takeUntil(k).doAction(r).subscribe(g,t,g)}function o(e){if(P[e.type]){var n=P[e.type].replace("{DATE}",e.localizedDate);x=_({"class":"expiration-notice-container hidden"},_({"class":"expiration-notice-box"},b(n),T=_({"class":"icon-player-cancel"}))),w.appendChild(x),i(),requestAnimationFrame(function(){x.classList.remove("hidden"),a({method:A.NOTICE_SHOWN}).subscribe(g,t)})}}function r(){x&&!x.classList.contains("hidden")&&(x.classList.add("hidden"),setTimeout(function(){x.parentElement.removeChild(x),x=null},200))}function s(){c=null,_=null,b=null,d=null,g=null,m=null,h=null,p=null,v=null,f=null,E=null,L&&(r(),k.onNext())}function a(t){var n={method:t.method,videoId:p.videoId()};return"test"===e.cadmium.objects.initParams().environment&&(n.revision="latest"),m.get(y,{data:n}).takeUntil(k).timeout(A.API_TIMEOUT).retryWithBackoff(A.MAX_ERROR_COUNT,A.RETRY_BACKOFF)}function l(){var e=f.getMetadata().contentExpiry;e&&e.willExpire&&o(e)}function u(n){c=e.cadmium,_=c.dom.DIV,b=c.dom.SPAN,d=c.logging,g=c.util.NOOP,m=c.xhr,h=e.I18n,p=c.objects,v=c.UiEvents,f=c.metadata,E=Rx.Observable,p.initParams().expiryNoticeEnabled&&(w=n,k=new Rx.Subject,y=p.initParams().apiUrl+A.API_ENDPOINT,P.show=h.get("ce-expiry-notice-showMessage"),P.season=h.get("ce-expiry-notice-seasonMessage"),P.series=h.get("ce-expiry-notice-seriesMessage"),E.fromEvent(v,v.knownEvents.METADATA_LOADED).takeUntil(k).doAction(l).subscribe(g,t),l(),L=!0)}var c,d,m,p,h,v,E,f,g,_,b,y,w,k,T,x,L,A={API_ENDPOINT:"/expirynotice",MAX_ERROR_COUNT:2,NOTICE_DURATION:5e3,RETRY_BACKOFF:500,API_TIMEOUT:3e3,INITIAL_DELAY:5e3,SHOULD_SHOW:"shouldShow",NOTICE_SHOWN:"noticeShown",NEVER_SHOW:"neverShow"},P={};return{init:u,deinit:s}}(),e.cadmium.ui.reportProblem=function(){function t(){return l({"class":"player-control-button player-report-problem"},l({"class":"border"},"?"))}function n(){p&&(p=!1,h&&h.destroy(),h=null,o=null,r=null,d=null,c=null,s=null,m.onNext())}function i(i){return p&&n(),r=e.cadmium,s=r.fullscreen,E()?(p=!0,o=i,a=r.dom,l=a.get("div"),u=a.get("span"),c=t(),m=new Rx.Subject,Rx.Observable.fromEvent(c,"click").takeUntil(m).doAction(v).subscribe(),h=new r.ui.ReportProblemMenuComponent(c,c,{id:"player-menu-report-problem"}),o.appendChild(c),c):void 0}var o,r,s,a,l,u,c,d,m,p=!1,h=null,v=function(){s.isFullscreen()&&s.exit(),r.objects.videoPlayer().pause(),r.cinemamode.disableCinemaMode(),r.keyboard.disableShortcut(),r.ui.reportProblemPopup.showPopup()},E=function(){var e=r.objects.initParams();return e&&e.reportProblemEnabled?!0:!1};return{init:i,deinit:n,showPopup:v}}(),e.cadmium.ui.reportProblemPopup=function(){"use strict";var t,n,i,o,r,s,a,l,u,c,d,m,p,h,v,E,f,g,_,b,y,w,k,T,x,L="/reportproblem",A=null,P=null,I=!1,O=!1,C=!1,S=function(){O&&(i.remove(P),t=null,n=null,i=null,o=null,r=null,s=null,a=null,l=null,u=null,c=null,d=null,m=null,p=null,h=null,v=null,E=null,f=null,g=null,_=null,A=null,P=null,b=null,I=!1,O=!1)},N=function(){A=null,k.onNext(),t.cinemamode.enableCinemaMode(),t.keyboard.enableShortcut(),P.classList.add("hidden"),setTimeout(function(){b.removeChild(P)},350)},R=function(e){var t,i,o,s,a;e.connection&&(a=r.get("ce-report-buffering-confirmation-subtext"),i=E({"class":"report-problem-subtitle"},r.get("ce-report-buffering-confirmation-subtext")),o=d({"class":"report-problem-help-center-link",target:"_blank",href:"https://help.netflix.com/help"},r.get("ce-report-buffering-confirmation-link"))),t=v({"class":"report-problem-title"},r.get("ce-report-confirmation-title")),s=c({"class":"report-problem-confirmation-container opacity-transparent"},t,i,c({"class":"report-problem-confirmation-button-row"},p({"class":"report-problem-button report-problem-finish"},r.get("ce-report-confirmation-finish")),o)),A.appendChild(s),requestAnimationFrame(function(){n.fadeOut(y),n.fadeIn(s)})},D=function(t){var i=c({"class":"report-problem-confirmation-container opacity-transparent"},E({"class":"report-problem-subtitle"},r.get("ce-social-error")),c({"class":"report-problem-confirmation-button-row"},p({"class":"report-problem-button report-problem-finish"},r.get("ce-report-confirmation-finish"))));A.appendChild(i),requestAnimationFrame(function(){n.fadeOut(y),n.fadeIn(i)});var o=e.clientNotifications;if(o){var s={category:"uiQOE",modalView:"reportProblem",data:t};o.notify("reportProblemError",s),o.flushBuffer&&o.flushBuffer()}},M=function(){var t;t=e.cadmium&&e.cadmium.ui&&e.cadmium.ui.master&&e.cadmium.ui.master.isAkira()?s.getSecureApiPath()+L:s.getSecureApiPath()+"/desktop/playback"+L,"test"===e.cadmium.objects.initParams().environment&&(t+="?revision=latest");for(var i=document.getElementsByClassName("checkbox selected"),o={movieID:e.cadmium.objects.videoId(),authURL:e.constants.page.xsrf},r=0;r<i.length;r++){var l=i[r].getAttribute("data-category");o[l]="true"}var d=document.getElementsByClassName("report-problem-details-text")[0].value;d.length>0&&(o.comments=d),o.isPlayer="true",o.contentTime=_.getCurrentTime();var m={withCredentials:!0,data:o},p=document.getElementsByClassName("report-problem-dialog-container",A)[0];n.fadeOut(p),y=c({"class":"loading display-none opacity-transparent"}),A.appendChild(y),n.fadeIn(y),a.post(t,m).takeUntil(k).doAction(function(){R(o)},function(){D(o)},T).subscribe(T,u.getErrorHandler("submit post request"))},U=function(e){var t=e.getElementsByClassName("checkbox")[0];if(t.classList.toggle("selected"),t.classList.contains("selected")){if(t.appendChild(c({"class":"icon-player-checked"})),w.classList.remove("hidden"),!C){var n=10,i=0,o=setInterval(function(){++i<n?w.scrollIntoView():clearInterval(o)},30);C=!0}}else{t.innerHTML="";var r=document.getElementsByClassName("checkbox selected");0==r.length&&w.classList.add("hidden")}},H=function(e){for(var t=e.target;!t.classList.contains("report-problem-popup-bg");){if(t.classList.contains("checkbox-row-container")){U(t);break}if(t.classList.contains("report-problem-close")||t.classList.contains("report-problem-finish")){N();break}if(t.classList.contains("report-problem-submit")){M();break}t=t.parentNode}e.stopPropagation()},B=function(e){e.stopPropagation()},V=function(e){return c({"class":"checkbox-row-container"},c({"class":"checkbox","data-category":e.category}),c({"class":"text-container"},v({"class":"title-text"},e.text),E({"class":"subtext-text"},e.subtext)))},j=function(){P=c({"class":"report-problem-popup-bg hidden"},A=c({"class":"report-problem-popup"},c({"class":"report-problem-close"},m({"class":"icon-player-thin-cancel"})),c({"class":"report-problem-dialog-container"},h({"class":"report-problem-title"},r.get("ce-report-problem-title")),v({"class":"report-problem-subtitle"},r.get("ce-report-problem-subtext")),c({"class":"report-problem-rows-container"},x.map(V)),w=c({"class":"report-problem-details-container hidden"},c({"class":"report-problem-details-title-container"},m({"class":"report-problem-details-title"},r.get("ce-report-problem-details-text")),m({"class":"report-problem-details-subtext"},"("+r.get("ce-report-problem-details-optional")+")")),f({"class":"report-problem-details-text",rows:5,cols:30}),p({"class":"report-problem-button report-problem-submit"},r.get("ce-report-problem-submit")))))),k=new Rx.Subject,Rx.Observable.fromEvent(P,"click").takeUntil(k).doAction(H).subscribe(T,u.getErrorHandler("clickhandler")),Rx.Observable.fromEvent(P,"dblclick").takeUntil(k).doAction(B).subscribe(T,u.getErrorHandler("dblclick handler"),T),b.appendChild(P),setTimeout(function(){P.classList.remove("hidden")},30)},F=function(y){O&&S(),O=!0,b=y,t=e.cadmium,n=t.animate,i=t.element,o=t.util,r=e.I18n,s=t.url,a=t.xhr,l=t.dom,u=t.Logger.create("reportProblem.popup"),c=l.DIV,d=l.A,m=l.SPAN,p=l.BUTTON,h=l.H1,v=l.H2,E=l.H3,f=l.get("textarea"),T=o.NOOP,g=t.objects,_=g.videoPlayer(),x=[{text:r.get("ce-report-problem-label-problem-title"),subtext:r.get("ce-report-problem-label-problem-subtext"),category:"mislabel"},{text:r.get("ce-report-problem-video-problem-title"),subtext:r.get("ce-report-problem-video-problem-subtext"),category:"video"},{text:r.get("ce-report-problem-sound-problem-title"),subtext:r.get("ce-report-problem-sound-problem-subtext"),category:"sound"},{text:r.get("ce-report-problem-subtitle-problem-title"),subtext:r.get("ce-report-problem-subtitle-problem-subtext"),category:"subtitle"},{text:r.get("ce-report-problem-buffering-problem-title"),subtext:r.get("ce-report-problem-buffering-problem-subtext"),category:"connection"}]};return{init:F,deinit:S,showPopup:j}}(),e.cadmium.ui.controlDivider=function(){function t(){i=o=r=null}function n(t){return i=e.cadmium,o=i.dom,r=o.get("div"),s=r({"class":"player-control-divider"}),t.appendChild(s),s}var i,o,r,s;return{init:n,deinit:t}}(),e.cadmium.ui.playback=function(){"use strict";function t(){return null===C&&(C=b.create("div",{
"class":["player-controls-wrapper",P,"no-select"].join(" ")})),C.innerHTML="<section class='player-slider' role='slider'></section><section class='player-control-bar no-select' role='control-bar'></section>",C}function n(){N.update(100)}function i(e){N.update((100*e).toFixed(0))}function o(e){p||(p=b.create("div",{id:"fademask"},document.body)),L.fromEvent(p,"transitionend").take(1).takeUntil(A).doAction(function(){b.remove(p),p=null}).subscribe(I,T.getErrorHandler("fadeEl|transitionend"),I),L.timer(e).doAction(function(){m.classList.remove(b.classNames.hidden),p.style.opacity=0}).subscribe(I,T.getErrorHandler("timer|hidden"),I)}function r(){s()}function s(e){if(O){var t=x.ui&&x.ui.timedText&&x.ui.timedText.setBounds&&x.ui.timedText.setBounds.bind(x.ui.timedText)||I;if(void 0!==e&&null!==e)return void t({bottom:e});var n=document.querySelector(".player-controls-wrapper"),i=n&&n.classList.contains("display-none");if(n&&i===!1){var o=k.playerWrapper(),r=o&&o.getBoundingClientRect().height,s=n.getBoundingClientRect().top,a=Math.floor(r-s);!isNaN(a)&&x?t({bottom:a}):T.log("view.playback: could not set timed text bounds.")}else t({bottom:0})}}function a(){var e=L.fromEvent(w,w.knownEvents.CINEMA_MODE_ENTER),t=L.fromEvent(w,w.knownEvents.CINEMA_MODE_EXIT),o=L.fromEvent(x,"busychanged").throttle(100).map(function(){return x&&x.getBusy()});o.takeUntil(A).filter(function(e){return e&&e.progress>=0&&!e.networkStalled}).map(function(e){return e&&e.progress}).distinctUntilChanged().doAction(i).subscribe(I,T.getErrorHandler("VideoPlayer|progressChanged"),I),o.takeUntil(A).filter(function(e){return!e}).doAction(n).subscribe(I,T.getErrorHandler("VideoPlayer|progressCompleted"),I),L.fromEvent(w,w.knownEvents.SHOW_AUTOPLAY_INTERRUPTER).merge(e).takeUntil(A).doAction(B).subscribe(I,T.getErrorHandler("UiEvents|autoplay_interrupt"),I),L.fromEvent(w,w.knownEvents.HIDE_AUTOPLAY_INTERRUPTER).merge(t).takeUntil(A).doAction(H).subscribe(I,T.getErrorHandler("UiEvents|hide_interrupt"),I),L.fromEvent(w,w.knownEvents.WINDOW_RESIZE).takeUntil(A).doAction(r).subscribe(I,T.getErrorHandler("UiEvents|window_resize"),I),L.fromEvent(m,"transitionend").merge(L.fromEvent(m,"webkitTransitionEnd")).merge(L.fromEvent(m,"msTransitionEnd")).filter(function(e){return"width"===e.propertyName}).takeUntil(L.fromEvent(w,w.knownEvents.VIDEO_FIRST_PLAY)).doAction(r).subscribe(I,T.getErrorHandler("UiEvents|first_play"),I),Rx.Observable.fromEvent(x,"timedtexttrackchanged").takeUntil(A).doAction(s.bind(null,null)).subscribe(I,T.getErrorHandler("timedtexttrackchanged"),I),e.takeUntil(A).delay(M).doAction(s.bind(null,0)).subscribe(I,T.getErrorHandler("cinemaModeEnter"),I),r(),g.MutationUtils.observeAndRemoveUnsafeNodes(h,f).takeUntil(A).subscribe(I,T.getErrorHandler("mutationObserver"),I)}function l(){O&&(T.log("deinit"),clearTimeout(R),d.classList.remove(U),d.style.cursor="auto",O=!1,A.onNext(),N.destroy(),E.forEach(function(e){e.deinit()}),e.cadmium.cinemamode.deinit(),b.remove(C),p&&b.remove(p),c=null,C=null,d=null,m=null,p=null,h=null,v=null,E=null,f=null,S=null,N=null,R=null,g=null,_=null,b=null,y=null,w=null,k=null,T=null,x=null,L=null,A=null,P=null,D=null,I=null)}function u(n){O&&l(),O=!0,c=n,g=e.cadmium,y=g.metadata,w=g.UiEvents,b=g.element,k=g.objects,_=g.ui,T=g.Logger.create("view.playback"),L=Rx.Observable,I=g.util.NOOP,P=b.classNames.active,D="webkit"===g.browser.prefix().lowercase,T.log("init",{masterView:!!n,initialized:O}),S=[],A=new Rx.Subject,x=k.videoPlayer(),d=k.playerWrapper(),N=new g.ui.RadialProgressComponent(c,{hideWhenEmpty:!0,hideWhenFull:!0,id:"player-playback-buffering"}),t(),S.push(C),m=document.getElementsByClassName("player-video-wrapper")[0],_.preplay.preplayNeeded()?(m.appendChild(C),o(500)):(c.appendChild(C),m.classList.remove(b.classNames.hidden)),h=C.getElementsByClassName("player-control-bar")[0],v=C.getElementsByClassName("player-slider")[0],g.cinemamode.init(),f=[],E=[_.pauser,_.volume,_.status,_.incognito,_.nextEpisode,_.episodeSelector,_.mdx,_.controlDivider,_.audio,_.dontShare,_.fullscreen,_.reportProblem],E.forEach(function(e){try{f.push(e.init(h))}catch(t){T.error(t)}}),E.push(_.exitPlayback),_.exitPlayback.init(n),E.push(_.expiryNotice),_.expiryNotice.init(n),S.push(_.exitPlayback.getBackToBrowsingEl()),E.push(_.autoplayInterrupter),_.autoplayInterrupter.init(n),E.push(_.preplay),_.preplay.init(n),E.push(_.popup),_.popup.init(n),E.push(_.reportProblemPopup),_.reportProblemPopup.init(n),E.push(_.scrubber),_.scrubber.init(v),E.push(_.longpause),_.longpause.init(n),E.push(_.NetworkError),_.NetworkError.init(),g.cinemamode.addExclusionEls(S),a()}var c,d,m,p,h,v,E,f,g,_,b,y,w,k,T,x,L,A,P,I,O=!1,C=null,S=[],N=null,R=null,D=!1,M=100,U="player-cinema-mode",H=function(){d.classList.remove(U),e.cadmium.animate.fadeIn(C),requestAnimationFrame(s.bind(null,null))},B=function(){d.classList.add(U),e.cadmium.animate.fadeOut(C)};return{init:u,deinit:l}}(),e.cadmium.views.register(e.cadmium.ui.playback,e.cadmium.views.types.standard),function(){"use strict";var t=e.cadmium,n=t.objects,i=t.UiEvents,o=t.PostPlayData,r=t.element,s=t.dom.get("DIV"),a=t.Class,l=t.UITracking,u=Rx.Observable,c=t.util.NOOP,d=t.Logger.create("subview.postplay.base"),m=t.url,p=2e3,h="postplay",v=2e3,E=a.extend({_initialized:!1,_disposed:null,_metadata:null,_rootEl:null,_playerWrapperEl:null,_videoPlayer:null,_components:null,_uiTrackingEnabled:!1,_videoCloseDelayTime:p,init:function(e,t){this._initialized||(this._initialized=!0,this._disposed=new Rx.Subject,this._parentEl=e,this._metadata=t,this._rootEl=s({"class":"player-postplay"}),this._videoPlayer=n.videoPlayer(),this._components=[],this._playerWrapperEl=e.querySelector(".player-video-wrapper"),this._uiTrackingEnabled=!!(n&&n.initParams()&&n.initParams().uiTrackingEnabled),d.log("init",t),this._createElements(),this._createEventSubscriptions())},destroy:function(){this._initialized&&(d.log("destroy"),l.deinit(),this._parentEl&&this._parentEl.classList.remove("video-ended"),this._disposed.onNext(),this._components.forEach(function(e){e&&(e.destroy&&e.destroy(),e.deinit&&e.deinit())}),r.remove(this._rootEl),this._disposed=null,this._parentEl=null,this._metadata=null,this._rootEl=null,this._playerWrapperEl=null,this._videoPlayer=null,this._components=null,this._initialized=!1)},show:function(){return this._parentEl.contains(this._rootEl)||this._parentEl.appendChild(this._rootEl),this._uiTrackingEnabled&&setTimeout(function(){d.log("start tracking UI."),this._trackUI()}.bind(this),v),this},hide:function(){},fallback:function(){d.error("Postplay unavailable. Metadata:",this._metadata)},_createElements:function(){},_addComponent:function(e){return this._components.push(e),e},_createEventSubscriptions:function(){var e=u.fromEvent(i,i.knownEvents.VIDEO_ENDED);u.fromEvent(this._videoPlayer.getElement(),"click").takeUntil(this._disposed).takeUntil(e).doAction(this._returnToPlayback.bind(this)).subscribe(c,d.getErrorHandler("video click"),c),e.takeUntil(this._disposed).delay(this._videoCloseDelayTime).doAction(function(){this._parentEl&&this._parentEl.classList.add("video-ended"),this._rootEl&&this._rootEl.classList.add("video-ended")}.bind(this)).flatMap(function(){return this._parentEl?u.fromEvent(this._parentEl,"transitionend").takeUntil(this._disposed).merge(u.timer(2e3).doAction(function(){d.log("transitionend did not fire for postplay parent.")})).take(1):u.empty()}.bind(this)).doAction(this._closeVideoPlayer.bind(this)).subscribe(c,d.getErrorHandler("video ended"),c)},_returnToPlayback:function(){t.views.show(t.ui.playback,[this._parentEl])},_closeVideoPlayer:function(){d.log("closing video player"),this._videoPlayer&&this._videoPlayer.close()},_startPlayback:function(e){d.log("Requesting playback with uicontext",e),e=e||{row:0,rank:-99,request_id:o.getRequestId(),location:h},t.ui.master.updateInitParams(n.initParams(),e)},_trackUI:function(){var e=n.initParams()||{};l.init({requestId:o.getRequestId(),location:h,enabled:this._uiTrackingEnabled,maxRecords:e.uiTrackingMaxRecords,localStorageKey:e.uiTrackinglocalStorageKey,endpoint:e.uiTrackingEndpoint,debug:m.urlContains(/ptdebug=true/)}),l.scan()},_getUiContextForEl:function(e){return e?(e=e.hasAttribute(l.TRACKING_ATTRIBUTE)?e:e.querySelector("["+l.TRACKING_ATTRIBUTE+"]"),l.getTrackingContext(e)):null},_setUiContextForEl:function(e,t){return this._uiTrackingEnabled&&l.trackElement(e,t),t},_navToMoreInfo:function(){var e=this._metadata.experience.moreInfoLink;d.info("Navigate to info:"+e),window.location.replace(e)}});E.create=function(e,t){return new E(e,t)},t.ui.PostPlayBase=E}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.url,r=n.UiEvents,s=n.dom,a=s.get("DIV"),l=s.get("SECTION"),u=s.get("H1"),c=s.get("H2"),d=s.get("P"),m=s.get("IMG"),p=n.time,h=Rx.Observable,v=i.PostPlayBase,E=i.PostPlayBackground,f=i.PostPlayActionButtons,g=i.PostPlayHorizontal,_=n.util.NOOP,b=n.Logger.create("subview.postplay.continue"),y=v.extend({init:function(){t=e.I18n,this._onSelectEpisode=this._onSelectEpisode.bind(this),this._autoPlayNextEpisode=this._autoPlayNextEpisode.bind(this),this._super.apply(this,arguments),r.fireEvent(r.knownEvents.START_AUTOPLAY_TIMER)},_autoPlayNextEpisode:function(){r.fireEvent(r.knownEvents.AUTOPLAY_NEXT_EPISODE,[this._nextEpisode&&this._nextEpisode.id]),this._playNextEpisode(!0)},_createElements:function(){this._super();var i,o=this._nextEpisode=this._metadata.list,r="ce-show-member-type-"+(o.memberType||"season"),s=t.getWithParams(r,["SEQ"],[o.seasonNumber])+" "+e.I18n.get("ce-episode-abbreviation")+" "+o.episodeNumber+" – "+o.title,h=o.duration&&o.duration.value,v=o.year+" "+(o.rating?o.rating:"")+(h?" "+p.convertUsingKey(h,!1,!0,"ce-time"):""),_=o.boxart,b="https://assets.nflxext.com/en_us/buttons/play-button-114.png",y=this._metadata.list;this._horizontal=this._addComponent(g.create(this._rootEl,y,this._metadata.type)),this._background=o.background&&this._addComponent(E.createFromUrl(this._rootEl,o.background)),this._footerEl=a({"class":"player-postplay-footer"},l({"class":"player-postplay-show-metadata"},a({"class":"postplay-metadata-container"},u({"class":"player-postplay-show-title"},document.createTextNode(o.showTitle)),c({"class":"player-postplay-episode-title"},document.createTextNode(s)),d({"class":"player-postplay-episode-metadata"},document.createTextNode(v)),d({"class":"player-postplay-episode-synopsis"},document.createTextNode(o.synopsis)))),i=l({"class":"player-postplay-show-autoplay"},this._stillEl=a({"class":"postplay-still-container"},this._autoPlayHeaderEl=u({"class":"player-postplay-autoplay-header"}),m({"class":"player-postplay-autoplay-still",src:_}),a({"class":"player-postplay-still-hover-container"},m({"class":"player-postplay-still-hover",src:b}))))),o.autoplay?this._autoPlayTimer=this._addComponent(n.ui.PostPlayTimer.create(this._autoPlayHeaderEl)):(this._autoplayDisabledTextAdded=!0,this._autoPlayHeaderEl.appendChild(document.createTextNode(t.get("ce-post-no-autoplay")))),this._actionButtons=this._addComponent(f.createBasic(i,"action-buttons episodic-action-buttons"));var w=a({"class":"more-episodes-container"});this._moreEpisodesMenu=new n.ui.EpisodeSelectorMenuComponent(w,w,{id:"player-menu-episode-selector",showEvent:"click"}),this._actionButtons.addButton({id:"meBtn",contentsEl:document.createTextNode(t.get("ce-post-more-episodes")),"class":"more-episodes",events:["click"]},w),this._actionButtons._rootEl.appendChild(w),this._playContext=this._setUiContextForEl(this._stillEl,{video_id:y.id,track_id:y.trackId,row:0,rank:0,location:"postplay",request_id:n.PostPlayData.getRequestId()}),this._rootEl.appendChild(this._footerEl)},_createEventSubscriptions:function(){this._super(),h.fromEvent(this._stillEl,"click").takeUntil(this._disposed).doAction(this._playNextEpisode.bind(this,!1)).subscribe(_,b.getErrorHandler("still click"),_),h.fromEvent(this._moreEpisodesMenu,this._moreEpisodesMenu.CHANGE_VIDEO_EVENT).takeUntil(this._disposed).doAction(this._onSelectEpisode).subscribe(_,b.getErrorHandler("episode selector handler"),_);var e=this._actionButtons.onAction(),n=h.fromEvent(r,r.knownEvents.STOP_AUTOPLAY_TIMER);h.merge(e,n).takeUntil(this._disposed).doAction(function(){this._autoPlayTimer&&this._autoPlayTimer.stop(),this._autoplayDisabledTextAdded||(this._autoplayDisabledTextAdded=!0,this._autoPlayHeaderEl.appendChild(document.createTextNode(t.get("ce-post-no-autoplay"))))}.bind(this)).subscribe(_,b.getErrorHandler("action button handler"),_),h.fromEvent(r,r.knownEvents.START_AUTOPLAY_TIMER).takeUntil(this._disposed).doAction(function(){this._autoPlayTimer&&this._autoPlayTimer.start(this._autoPlayNextEpisode)}.bind(this)).subscribe(_,b.getErrorHandler("start autoplay handler"),_)},_onSelectEpisode:function(e){o.setNextVideo(o.CONSTANTS.EPISODE_ID,e.videoId,null),this._startPlayback()},_playNextEpisode:function(e){b.log("play next episode",this._nextEpisode.id);var t;t=e?this._nextEpisode.autoPlayId?this._nextEpisode.autoPlayId:this._nextEpisode.trackId:this._nextEpisode.userPlayId?this._nextEpisode.userPlayId:this._nextEpisode.trackId,o.setNextVideo(o.CONSTANTS.EPISODE_ID,this._nextEpisode.id,t);var i=1e3*this._nextEpisode.offsetStart;i>=0&&n.objects.overrideBookmark(this._nextEpisode.id,e?i:0),this._startPlayback(this._playContext)},_returnToPlayback:function(){this._autoPlayTimer&&this._autoPlayTimer.stop(),this._super()}});y.create=function(e,t){return new y(e,t)},n.ui.PostPlayContinueWatching=y}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.element,r=n.dom.DIV,s=i.PostPlayBase,a=i.PostPlayBackground,l=i.PostPlayActionButtons,u=i.PostPlaySimsCollection,c=i.PostPlayHorizontal,d=n.objects,m=n.url,p=n.util.NOOP,h=n.Logger.create("subview.postplay.sims"),v=s.extend({init:function(){t=e.I18n,this._super.apply(this,arguments),this._sims.highlightSimAtIndex(0)},_createElements:function(){this._super(),this._createSections(),this._background=this._addComponent(a.create(this._rootEl)),this._actionButtons=this._addComponent(l.createBasic(this._leftSection)),this._sims=this._addComponent(u.create(this._rightSection,this._getSims(),this._boxshotTemplate.bind(this))),this._horizontal=this._addComponent(c.create(this._rootEl,this._metadata.experience||{},this._metadata.type))},_createSections:function(){t=t||e.I18n,this._leftSection=o.create("section",{"class":"player-postplay-recommend-text"},this._rootEl),this._rightSection=o.create("div",{"class":"player-postplay-recommendations"},this._rootEl);var n=o.create("h1",{"class":"player-postplay-recommend-header"},this._leftSection),i=o.create("h2",{"class":"player-postplay-recommend-subheader"},this._leftSection);n.appendChild(document.createTextNode(t.get("ce-post-recommend-head"))),i.appendChild(document.createTextNode(t.get("ce-post-recommend-body")))},_boxshotTemplate:function(e,t){e=e||{};var i,o=r({"class":"player-postplay-recommendation","data-id":e.id},i=r({"class":"player-postplay-recommendation-boxshot"},r({"class":"player-postplay-recommendation-hover"})));return this._setUiContextForEl(i,{video_id:e.id,track_id:e.trackId,row:0,rank:t,location:"postplay",request_id:n.PostPlayData.getRequestId()}),i.style.cssText="background-image: url("+e.boxart+");",o},_createEventSubscriptions:function(){this._super(),this._sims.onHighlight().takeUntil(this._disposed).doAction(function(e){var t=e.getData();this._background.source=t&&t.background}.bind(this)).subscribe(p,h.getErrorHandler("Sims highlight error."),p),this._sims.onClick().takeUntil(this._disposed).doAction(this._playSim.bind(this)).subscribe(p,h.getErrorHandler("Sims click error."),p)},_getSims:function(){return this._metadata&&this._metadata.list||[]},_playSim:function(e){var t=e.data||{},n="show"===t.type?t.episodeId:t.id;m.setNextVideo(m.CONSTANTS.VIDEO_ID,n,t.trackId);var i=d.initParams()||{},o=this._getUiContextForEl(e.el);i.commentarySettings&&delete i.commentarySettings,this._startPlayback(o)}});v.create=function(e,t){return new v(e,t)},n.ui.PostPlaySims=v}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.dom.get("H2"),r=(n.element,n.dom.DIV),s=n.ui.PostPlaySims,a=(n.objects,n.url,n.util.NOOP),l=n.mixins.ui.buttons,u=n.Logger.create("subview.postplay.sims.dab"),c=i.PostPlayActionButtons,d=i.PostPlayMyList,m=s.extend({init:function(){t=e.I18n,u.log("init"),this._super.apply(this,arguments)},_createElements:function(){var e=this._metadata.experience;this._super(),this._dabEl=r({"class":"postplay-promo postplay-dab"},r({"class":"promo-postplay-metadata"},r({"class":"logo",style:"background-image: url("+e.horizontal+");"}),e.tagline&&o({"class":"tagline"},e.tagline))),this._actionButtons=this._addComponent(c.create(this._dabEl,[l.getMyListButton(e.myList.action),l.getMoreInfoButton()])),this._rootEl.appendChild(this._dabEl),this._myList=this._addComponent(d.create(this._rootEl,{myList:e.myList,trackId:e.trackId,element:this._rootEl.querySelector(".my-list")}))},_createEventSubscriptions:function(){this._super(),this._actionButtons.onAction().takeUntil(this._disposed).doAction(function(e){switch(e.id){case l.MY_LIST_BUTTON:this._myList.toggleMyList();break;case l.MORE_INFO_BUTTON:this._navToMoreInfo()}}.bind(this)).subscribe(a,u.getErrorHandler("actionButtons|onAction"),a)}});m.create=function(e,t){return new m(e,t)},i.PostPlaySimsDAB=m}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.mixins,r=(n.UiEvents,n.dom.DIV,n.ui.PostPlaySims,i.PostPlaySimsDAB),s=n.Logger.create("subview.postplay.sims.specialmessage"),a=r.extend({init:function(){t=e.I18n,s.log("init"),this._super.apply(this,arguments)},_createElements:function(){var e=this._metadata.experience;this._super(),e.specialMessageEnabled&&this.addVideoInterstitialComponent({videoId:e.trailer.id,trackId:e.trailer.trackId,title:e.trailer.title,background:e.trailer.background,autoPlayTimer:e.trailer.autoPlayTimerOverride})},_createEventSubscriptions:function(){this._super(),this.createVideoInterstitialEvents()},_returnToPlayback:function(){this._handleInterstitialReturnToPlayback(),this._super()}});a.create=function(e,t){return new a(e,t)},o.mixin(a.prototype,o.ui.videoInterstitial),i.PostPlaySimsSpecialMessage=a}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.dom,r=o.get("DIV"),s=o.get("SPAN"),a=n.PostPlayData,l=i.PostPlayBase,u=i.PostPlayBackground,c=i.PostPlayExitFullscreen,d=i.exitPlayback,m=n.Logger.create("subview.postplay.trailer.base"),p=n.url,h=n.animate,v="play-trailer",E="play-show",f=l.extend({_metadata:null,_background:null,_exitPlaybackButton:null,_exitFullScreenButton:null,_promoUiContext:null,init:function(n,i){m.log("init"),t=e.I18n,this._videoCloseDelayTime=0,this._super(n,i)},destroy:function(){this._playerWrapperEl&&h.fadeIn(this._playerWrapperEl),this._super()},show:function(){this._super();var e=this._metadata&&this._metadata.experience&&this._metadata.experience.impression;return e&&a.recordImpression(e),this},_createElements:function(){this._rootEl.classList.add("trailer-merch");var e=this._metadata.experience;this._exitPlaybackButton=this._addComponent(d).init(this._parentEl),this._background=this._addComponent(u.createFromUrl(this._rootEl,e.background)),this._exitFullScreenButton=this._addComponent(c.create(this._parentEl)),d.getBackToBrowsingEl().classList.add("trailer-merch")},_playPromotedVideo:function(){var e=this._metadata.experience.promotedVideo.id;m.log("play promoted title",e),n.PostPlayData.deinit(!0),this._playVideo(e)},_playTrailer:function(){var e=this._metadata.experience.trailerId;m.log("play trailer",e),this._playVideo(e)},_replayTrailer:function(){m.log("Replay trailer."),this._playerWrapperEl&&h.fadeIn(this._playerWrapperEl),n.PostPlayData.repeatCurrentPostPlayData(),this._playTrailer()},_playVideo:function(e){p.setNextVideo(p.CONSTANTS.VIDEO_ID,e,this._metadata.experience.trackId),this._startPlayback(this._promoUiContext)},_setPromoUiContextForEl:function(e,t){if(this._uiTrackingEnabled){t=t||{};var i={video_id:t.trailerId,track_id:t.trackId,row:0,rank:0,location:"postplay",request_id:a.getRequestId()};this._promoUiContext=i,n.UITracking.trackElement(e,i)}}});f.create=function(e,t){return new f(e,t)},f.getPlayPromotedVideoButton=function(e){return e=e||{},{id:E,contentsEl:r({"class":"play-button-content"},s({"class":"play-button-text"},null!=e.seasonNumber?t.getWithParams("ce-post-play-promo-episode",["SEASON","EPISODE"],[e.seasonNumber,e.episodeNumber]):t.get("ce-post-play-promo-title"))),"class":"play-button",events:["click"]}},f.getPlayTrailerButton=function(e){e=e||"play-button-trailer";var n=t.get("ce-post-play-trailer"),i="play-button"===e?r({"class":"play-button-content"},s({"class":"play-button-text"},n)):document.createTextNode(n);return{id:v,contentsEl:i,"class":e,events:["click"]}},i.PostPlayTrailerBase=f}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.dom,r=o.get("DIV"),s=o.get("IMG"),a=o.get("H1"),l=o.get("P"),u=o.get("A"),c=(o.get("SPAN"),i.PostPlayTrailerBase),d=i.PostPlayActionButtons,m=i.PostPlayHorizontal,p=i.PostPlayMyList,h=n.util.NOOP,v=n.Logger.create("subview.postplay.trailer.merch"),E=n.mixins.ui.buttons,f="play-trailer",g="play-show",_=c.extend({init:function(n,i){v.log("init"),t=e.I18n,this._super(n,i)},_createElements:function(){this._super();var e,n=this._metadata.experience,i=r({"class":"promo-postplay-metadata"},e=s({"class":"logo"}),a({"class":"tagline"},n.tagline||""),n.synopsis&&l({"class":"synopsis"},n.synopsis,u({"class":"more-info",href:n.moreInfoLink},t.get("ce-post-more-info"))));n.logo&&e.setAttribute("src",n.logo);var o=function(){this._setPromoUiContextForEl(e,n)}.bind(this);e.width&&o(),e.onload=o,this._horizontal=this._addComponent(m.create(this._rootEl,n)),this._rootEl.appendChild(i),this._actionButtons=this._createButtons(i),this._myList=this._addComponent(p.create(this._rootEl,{myList:n.myList,trackId:n.trackId,element:this._rootEl.querySelector(".my-list")}))},_createEventSubscriptions:function(){this._super(),this._actionButtons.onAction().takeUntil(this._disposed).doAction(function(e){switch(this._autoPlayTimer&&this._autoPlayTimer.stop(),e.id){case f:this._playTrailer();break;case g:this._playPromotedVideo();break;case E.MY_LIST_BUTTON:this._myList.toggleMyList();break;case E.MORE_INFO_BUTTON:this._navToMoreInfo()}}.bind(this)).subscribe(h,v.getErrorHandler("actionButtons|onAction"),h)},_createButtons:function(e){var t=this._metadata.experience||{},n=[c.getPlayPromotedVideoButton(t.promotedVideo),c.getPlayTrailerButton(),E.getMyListButton(t.myList.action)];return d.create(e,n)}});_.create=function(e,t){return new _(e,t)},i.PostPlayTrailerMerch=_}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.dom,r=o.get("H1"),s=n.dom.get("H2"),a=o.get("SECTION"),l=i.PostPlayTrailerBase,u=i.PostPlayActionButtons,c=i.PostPlayTrailerMerch,d=n.Logger.create("subview.postplay.trailer.merch.post"),m=n.util.NOOP,p=Rx.Observable,h=n.mixins.ui.buttons,v=c.extend({init:function(n,i){d.log("init"),t=e.I18n,this._super(n,i)},_createElements:function(){this._super(),this._horizontal._rootEl.classList.remove("trailer-merch"),this._rootEl.appendChild(a({"class":"trailer-recommend-text"},r({"class":"trailer-recommend-header"},t.get("ce-post-original-promote-header")),s({"class":"trailer-recommend-subheader"},t.get("ce-post-original-promote-text"))))},_createEventSubscriptions:function(){this._super(),p.fromEvent(this._horizontal._rootEl,"click").takeUntil(this._disposed).take(1).doAction(this._replayTrailer.bind(this)).subscribe(m,d.getErrorHandler("event|click"))},_createButtons:function(e){var t=this._metadata.experience,n=[l.getPlayPromotedVideoButton(t.promotedVideo),h.getMyListButton(t.myList.action)];return u.create(e,n)}});v.create=function(e,t){return new v(e,t)},i.PostPlayTrailerMerchPost=v}(),function(){"use strict";var t,n=e.cadmium,i=n.ui,o=n.dom.get("H2"),r=i.PostPlayTrailerBase,s=i.PostPlayActionButtons,a=i.PostPlayTimer,l=n.Logger.create("subview.postplay.trailer.promo"),u=(n.url,n.mixins.ui.buttons),c=i.PostPlayTrailerMerch.extend({init:function(n,i){l.log("init"),t=e.I18n,this._super(n,i),this._autoPlayTimer&&this._autoPlayTimer.start(this._playTrailer.bind(this))},_returnToPlayback:function(){this._autoPlayTimer&&this._autoPlayTimer.stop(),this._super()},_createElements:function(){this._super();var e=this._metadata.experience,n=this._rootEl.querySelector(".promo-postplay-metadata"),i=o({"class":"autoplay-timer"});n.insertBefore(i,n.lastChild),e.autoplay&&(this._autoPlayTimer=a.create(i,{maxTime:e.autoplayTime,singularTemplate:function(){return t.get("ce-post-autoplay-prepromo-trailer-singular")},pluralTemplate:function(e){return t.getWithParams("ce-post-autoplay-prepromo-trailer-plural",["SECONDS"],[e])},stoppedTemplate:function(){return null}}))},_createButtons:function(e){var t=this._metadata.experience.myList,n=[r.getPlayTrailerButton("play-button"),u.getMyListButton(t.action)];return s.create(e,n)}});c.create=function(e,t){return new c(e,t)},i.PostPlayTrailerPromo=c}(),function(){"use strict";var t=e.cadmium,n=t.ui,i=t.dom.get("DIV"),o=t.dom.get("H2"),r=n.PostPlayActionButtons,s=n.PostPlayBackground,a=n.PostPlaySimsCollection,l=n.PostPlayHorizontal,u=n.PostPlayTrailerMerch,c=n.PostPlaySims,d=n.PostPlayTrailerBase,m=n.PostPlayMyList,p=t.Logger.create("subview.postplay.trailer.promo.recs"),h=t.util.NOOP,v=Rx.Observable,E=t.mixins.ui.buttons,f=u.extend({init:function(e,t){p.log("init"),this._super(e,t),this._sims.highlightSimAtIndex(0)},_createElements:function(){var e,t,n,r=this._metadata.experience;d.prototype._createElements.call(this),c.prototype._createSections.call(this),this._background=this._addComponent(s.create(this._rootEl)),this._sims=this._addComponent(a.create(this._rightSection,this._getSims(),this._boxshotTemplate.bind(this))),this._promoEl=i({"class":"postplay-promo"},e=i({"class":"postplay-promo-horizontal-container"}),t=i({"class":"promo-postplay-metadata"},n=i({"class":"logo",style:"background-image: url("+r.logo+");"}),o({"class":"tagline"},r.tagline))),this._setPromoUiContextForEl(n,r),this._horizontal=this._addComponent(l.create(e,r)),this._actionButtons=this._addComponent(this._createButtons(t)),this._myList=this._addComponent(m.create(this._rootEl,{myList:r.myList,trackId:r.trackId,element:t.querySelector(".my-list")})),this._horizontal._rootEl.classList.remove("trailer-merch"),this._rootEl.appendChild(this._promoEl)},_boxshotTemplate:function(e,n){e=e||{};var i=c.prototype._boxshotTemplate.apply(this,arguments),o=i.querySelector(".player-postplay-recommendation-boxshot");return this._setUiContextForEl(o,{video_id:e.id,track_id:e.trackId,row:1,rank:n,request_id:t.PostPlayData.getRequestId(),location:"postplay"}),i},_getSims:function(){var e=this._metadata||{};return e.experience&&e.experience.recommendations||e.experience.recommendations||[]},_createEventSubscriptions:function(){this._super(),this._sims.onHighlight().takeUntil(this._disposed).doAction(function(e){var t=e.getData();this._background.source=t&&t.background}.bind(this)).subscribe(h,p.getErrorHandler("sims|onHighlight"),h),this._sims.onClick().takeUntil(this._disposed).doAction(function(e){t.PostPlayData.deinit(!0),c.prototype._playSim.call(this,e)}.bind(this)).subscribe(h,p.getErrorHandler("sims|onClick"),h),v.fromEvent(this._horizontal._rootEl,"click").takeUntil(this._disposed).take(1).doAction(this._replayTrailer.bind(this)).subscribe(h,p.getErrorHandler("event|click"))},_createButtons:function(e){return this._addComponent(r.create(e,[E.getMyListButton(this._metadata.experience.myList.action),E.getMoreInfoButton()]))}});f.create=function(e,t){return new f(e,t)},n.PostPlayTrailerPromoRecs=f}(),function(){"use strict";var t,n,i,o=e.cadmium,r=o.dom,s=(r.get("DIV"),r.get("SPAN"),o.Logger.create("component.postplay.akira.modal")),a="originalsFeedbackForm:show",l=function(e,r){r=r||{},this._parentEl=e,this._config=r,n||(n=Requireify.require("js/akira/components/modals/originalsFeedback.jsx")),t||(t=Requireify.require("js/akira/components/modals/modalManager.jsx")),i||(i=Requireify.require("js/reactMixins/eventBus.js")),n.stub||t.stub||(o.fullscreen.exit(),o.keyboard.disableShortcut(),t.open(n,{name:"feedbackModal",additionalClasses:["originals-feedback-modal"],contentProps:{id:r.id,title:r.title,maxChars:r.maxChars,onSubmit:r.onSubmit}}),i.stub||i.emit(a))};l.prototype.destroy=function(){s.log("destroy"),this._parentEl=null,this._config=null,n=null,t=null,i=null},l.prototype.close=function(){t&&t.closeOpenModal&&t.closeOpenModal()},o.ui.AkiraOriginalsFeedbackModal={create:function(e,t){return new l(e,t)}}}(),function(){"use strict";function t(e){f.log("createPostPlayExperience"),f.log("createPostPlayExperience.doAction",e.type);var t;switch(e.type){case T.WATCH_NEXT:t=l.ui.PostPlayContinueWatching;break;case T.TRAILER_MERCH:t=l.ui.PostPlayTrailerMerch;break;case T.POST_TRAILER_MERCH:t=l.ui.PostPlayTrailerMerchPost;break;case T.PROMO_PHASE:t=l.ui.PostPlayTrailerPromo;break;case T.POST_PROMO_PHASE:t=l.ui.PostPlayTrailerPromoRecs;break;case T.SIMILARS:t=l.ui.PostPlaySims;break;case T.SIMILARS_DAB:t=l.ui.PostPlaySimsDAB;break;case T.SIMILARS_SPECIAL_MESSAGE:t=l.ui.PostPlaySimsSpecialMessage;break;default:return f.error("Could not create a post play experience for "+e.type),void n()}b=t.create(_,e).show(),_.classList.add(k)}function n(){f.info("Failed to get post play data. Falling back...")}function i(){l=e.cadmium,u=l.views,c=l.objects,d=l.element,m=l.UiEvents,p=Rx.Observable,h=l.dom.DIV,v=l.PostPlayData,E=l.util.NOOP,f=f||l.Logger.create("view.postplay.factory")}function o(t){i(),f.log("preinit");p.fromEvent(m,m.knownEvents.VIDEO_ENDED).doAction(function(){f.log("postplay fallback. videoEnded; going back home."),n()});v.getData().flatMap(a).doAction(function(n){var i=n&&n.type&&n.type.toLowerCase&&n.type.toLowerCase()||"";e&&e.cadmium&&e.cadmium.metadata&&e.cadmium.metadata.isSupplementalVideo()&&i.indexOf("trailer")<0||u.show(l.ui.PostPlay,[t,n])}).subscribe(E,f.getErrorHandler("preinit.postplayexperience"),E)}function r(e,n){w&&s(),y=y||new Rx.Subject,i(),f.log("init"),g=h({"class":"player-postplay"}),_=e,t(n),w=!0}function s(){w&&(f.log("destroy"),y&&y.onNext(),y=null,_.classList.remove(k),_.classList.remove("player-postplay-video-ended"),b&&b.destroy(),d.remove(g),_=null,g=null,b=null,l=null,u=null,c=null,d=null,m=null,p=null,h=null,v=null,E=null,f=null,w=!1)}function a(e){return e&&e.experience&&e.experience.myList&&e.type===T.POST_TRAILER_MERCH||e.type===T.POST_PROMO_PHASE?(f.log("Getting my list status."),l.ui.PostPlayMyList.getCurrentState(e.experience.myList).map(function(t){return e.experience.myList.action=t.action,e})):p["return"](e)}var l,u,c,d,m,p,h,v,E,f,g,_,b,y,w=!1,k="player-postplay",T=Object.freeze({WATCH_NEXT:"watchNext",SIMILARS:"recommendations",SIMILARS_DAB:"recommendationsDAB",SIMILARS_SPECIAL_MESSAGE:"specialMessage",TRAILER_MERCH:"trailerMerch",POST_TRAILER_MERCH:"postTrailerMerch",PROMO_PHASE:"promoTrailerMerch",POST_PROMO_PHASE:"postPromoTrailer"});e.cadmium.ui.PostPlay={preinit:o,init:r,deinit:s},e.cadmium.views.register(e.cadmium.ui.PostPlay,e.cadmium.views.types.standard)}(),function(){"use strict";var t=e.cadmium,n=t.element,i=t.Logger.create("loader.manager"),o=t.metadata,r=t.UiEvents,s=t.objects,a=Rx.Observable,l=t.ui.pinentry,u=t.session,c=(t.url,t.PostPlayData),d=t.util.NOOP,m=t.Eventable.extend({parentNode:null,rootEl:null,knownEvents:Object.freeze({METADATA_READY:"metadataReady",START_LOAD:"startLoad",PROGRESS_CHANGED:"progressChanged"}),_initialized:!1,_components:[],_disposed:null,_videoPlayer:null,_videoDOMNodesAvailable:!1,_attemptedBuffering:!1,_bookmarkOverride:null,_loadingVideoId:null,_attemptLoadVideo:function(){this._initialized&&(i.log("attemptLoadVideo",{attemptedBuffering:this._attemptedBuffering,id:this._loadingVideoId}),this._attemptedBuffering||null===this._loadingVideoId||(this._attemptedBuffering=!0,i.log("attemptLoadVideo, create video player",{attemptedBuffering:this._attemptedBuffering,id:this._loadingVideoId}),s.createVideoPlayer(s.videoId(),s.trackId(),function(e,t){e||(this._videoPlayer=t,
a.fromEvent(this._videoPlayer,"busychanged").takeUntil(this._disposed).doAction(this._busyChangedHandler).subscribe(d,function(e){console.error(e)},d),a.fromEvent(this._videoPlayer,"loaded").take(1).takeUntil(this._disposed).doAction(this._loadedVideoHandler).subscribe(d,function(e){console.error(e)},d))}.bind(this))))},_loadedVideoHandler:function(){this._initialized&&(r.fireEvent(r.knownEvents.VIDEO_FIRST_PLAY),i.log("video start time: "+performance.now().toFixed(2)+"ms"),t.views.show(t.ui.playback,[this.parentNode]),c.init())},_busyChangedHandler:function(){if(this._initialized){var e=s.videoPlayer().getBusy()||{};this.fireEvent(this.knownEvents.PROGRESS_CHANGED,[{progress:e.progress,isStalled:e.networkStalled}])}},_metadataLoadedHandler:function(){this._initialized&&(null===this._loadingVideoId&&(this._loadingVideoId=o.getActiveVideo().id,s.setVideoId(this._loadingVideoId)),this.fireEvent(this.knownEvents.METADATA_READY))},_checkMetadataForId:function(e){if(this._initialized){var t=o.getActiveVideo();t&&t.id===e&&this._metadataLoadedHandler()}},_preparePlayableAndTrackId:function(e){if(this._initialized){var n,i,o=t.ui.preplay.preplayNeeded();o?(n=e.recap.movieId,i=e.preplay.trackId):(n=e.episodeId||e.movieId||e.videoId||null,i=e.trackingId),this._loadingVideoId=n,s.setVideoId(n),s.setTrackId(i||0),null!==this._loadingVideoId?o?this.fireEvent(this.knownEvents.METADATA_READY):this._checkMetadataForId(this._loadingVideoId):this._checkMetadataForId(e.videoId)}},_verifyPinThenStartPlayback:function(){var n=this,r=a.fromEvent(this,this.knownEvents.METADATA_READY).map(function(){return o.getActiveVideo()}),s=a["return"](o.getActiveVideo());a.merge(r,s).takeUntil(this._disposed).filter(function(e){return!!e}).take(1).flatMap(function(e){return e&&e.requiresPin?l.show(n.rootEl,!0).map(function(e){return!(e&&e.pinStatus&&e.pinStatus===l.CANCELED)}).doAction(function(e){e&&u.setSessionData(u.SESSION_TYPES.PIN,!0)}):a["return"](!0)}).doAction(function(e){e?n._attemptLoadVideo():t.ui.master.goBackToBrowsing()}).subscribe(d,function(t){var n=e&&e.cadmium&&e.cadmium.ui&&e.cadmium.ui.errors||{};n.throwUIError&&n.throwUIError(n.type.UI_UNKNOWN),i.error(t)},d)},init:function(e,t){if(e){t=t||{},this._disposed=new Rx.Subject,this._initialized&&this.destroy(),this._initialized=!0,this._super();var o=t.initParams||{},s=t.components,l=this;this.parentNode=e,this.rootEl=n.create("section",{"class":"loading-view-v2"},this.parentNode),s&&s.length>0&&(this._components=[],s.forEach(function(e){this._components.push(e.create(this,t))},this)),this.fireEvent(this.knownEvents.START_LOAD),this._loadedVideoHandler=this._loadedVideoHandler.bind(this),this._busyChangedHandler=this._busyChangedHandler.bind(this),this._metadataLoadedHandler=this._metadataLoadedHandler.bind(this),a.fromEvent(r,r.knownEvents.NEW_PLAYER_DOM_CREATED).takeUntil(this._disposed).doAction(function(){l._initialized&&(l._videoDOMNodesAvailable=!0)}).subscribe(d,i.getErrorHandler("event|NEW_PLAYER_DOM_CREATED"),d),a.fromEvent(r,r.knownEvents.METADATA_LOADED).takeUntil(this._disposed).doAction(this._metadataLoadedHandler).subscribe(d,i.getErrorHandler("event|METADATA_LOADED"),d),this._preparePlayableAndTrackId(o),o.pinConfig&&o.pinConfig.isEnabled?u.isExpired(u.SESSION_TYPES.PIN)?this._verifyPinThenStartPlayback():(u.setSessionData(u.SESSION_TYPES.PIN,!0),this._attemptLoadVideo()):this._attemptLoadVideo()}},destroy:function(){this._initialized&&(this._disposed.onNext(),n.remove(this.rootEl),this._components&&this._components.forEach(function(e){e&&e.destroy()}),this.rootEl=null,this.parentNode=null,this.events=null,this._components=null,this._videoDOMNodesAvailable=!1,this._attemptedBuffering=!1,this._bookmarkOverride=null,this._loadingVideoId=null,this._videoPlayer=null,this._disposed=null,this._initialized=!1)}}),p=function(){var n=new m;return{init:function(i,o){var r=[t.ui.LoaderMetadata,t.ui.LoaderProgress];e.cadmium&&e.cadmium.ui&&e.cadmium.ui.master&&e.cadmium.ui.master.isAkira()&&r.push(t.ui.ExitPlaybackComponent),n.init(i,{initParams:o,components:r})},deinit:n.destroy.bind(n)}}();e.cadmium.views.register(p,e.cadmium.views.types.standard);var h=function(){var e=new m;return{init:function(n,i){e.init(n,{initParams:i,components:[t.ui.LoaderProgressPrePlay]})},deinit:e.destroy.bind(e)}}();e.cadmium.views.register(h,e.cadmium.views.types.standard);var v=function(){var e=new m;return{init:function(n,i){var o=[t.ui.LoaderProgress],a=this;e.init(n,{initParams:i,components:o}),r.addEventListener(r.knownEvents.VIDEO_FIRST_PLAY,function l(){r.removeEventListener(r.knownEvents.VIDEO_FIRST_PLAY,l),delete s.initParams().isStartingFromTimeout,a.deinit()})},deinit:e.destroy.bind(e)}}();e.cadmium.views.register(v,e.cadmium.views.types.standard),t.ui.loader={create:function(){return t.ui.preplay.preplayNeeded()?h:s.initParams().isStartingFromTimeout?v:p}}}()}();